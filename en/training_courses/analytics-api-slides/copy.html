<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=1024, user-scalable=no">

    <title>Quick Start: Analytics API</title>

    <!-- Required stylesheet -->
    <link rel="stylesheet" media="screen" href="//docs.brightcove.com/en/scripts/slides/core/deck.core.css">

    <!-- Extension CSS files go here. Remove or add as needed. -->
    <link rel="stylesheet" media="screen" href="//docs.brightcove.com/en/scripts/slides/extensions/goto/deck.goto.css">
    <link rel="stylesheet" media="screen" href="//docs.brightcove.com/en/scripts/slides/extensions/menu/deck.menu.css">
    <link rel="stylesheet" media="screen" href="//docs.brightcove.com/en/scripts/slides/extensions/navigation/deck.navigation.css">
    <link rel="stylesheet" media="screen" href="//docs.brightcove.com/en/scripts/slides/extensions/status/deck.status.css">
    <link rel="stylesheet" media="screen" href="//docs.brightcove.com/en/scripts/slides/extensions/scale/deck.scale.css">

    <!-- Style theme. More available in /themes/style/ or create your own. -->
    <link rel="stylesheet" media="screen" href="//docs.brightcove.com/en/scripts/slides/themes/style/bcls-slides.css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

    <script type="text/javascript" src="//use.edgefonts.net/source-code-pro.js"></script>

    <!-- Transition theme. More available in /themes/transition/ or create your own. -->
    <link rel="stylesheet" media="screen" href="//docs.brightcove.com/en/scripts/slides/themes/transition/horizontal-slide.css">

    <!-- Basic black and white print styles -->
    <link rel="stylesheet" media="print" href="//docs.brightcove.com/en/scripts/slides/core/print.css">

    <!-- Required Modernizr file -->
    <script src="//docs.brightcove.com/en/scripts/slides/modernizr.custom.js"></script>

    <!-- syntax highlight styles -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css" />
</head>
<body>

    <!-- Begin slides. Just make elements with a class of slide. -->

    <div id="main" class="large-10 small-12 columns deck-container">
        <!-- title slide -->
        <div id="top" class="section title slide">
            <h1>Quick Start: Analytics API</h1>
            <p class="doc-only">The Analytics API allows you to retrieve various analytics reports for your Video Cloud videos. This tutorial will walk you through these operations.</p>
            <table class="slide-only bcls-float-right bcls-small">
                <caption>Navigation</caption>
                <tbody>
                    <tr>
                        <td>&darr; or &rarr; </td>
                        <td> forward</td>
                    </tr>
                    <tr>
                        <td>&uarr; or &larr; </td>
                        <td> back</td>
                    </tr>
                    <tr>
                        <td>cmd-m </td>
                        <td>all slides</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- section slide -->
        <div class="section slide" id="getStarted">
            <h2>Getting Started</h2>
        </div>
        <!-- regular content slide -->
        <div id="intro" class="slide">
            <h3>Introduction</h3>
            <p class="slide-only">The Analytics API allows you to retrieve various analytics reports for your Video Cloud videos. This tutorial will walk you through these operations.</p>
            <p>The Analytics API allows you to:</p>
            <ul>
                <li class="slide">
                    <p>Get reports on various data dimensions</p>
                </li>
                <li class="slide">
                    <p>Set the time span for reports</p>
                </li>
                <li class="slide">
                    <p>Determine which metrics are included in reports</p>
                </li>
                <li class="slide">
                    <p>Get reports in JSON, CSV, or XLSX format</p>
                </li>
                <li class="slide">
                    <p>Select videos to report on by tags and other video metadata fields</p>
                </li>
            </ul>
        </div>
        <div id="restful" class="slide">
            <h3>A Restful API</h3>
            <p>The Analytics API is a RESTful API. It accepts HTTPS requests and returns a JSON response.</p>
            <p>This means that you can use the API with any language you choose - Ruby, Java, PHP, Python, JavaScript (via AJAX or nodejs), etc. All you have to be able to do is make HTTPS requests and handle a JSON response.</p>
            <p class="BCL-aside slide">For the Analytics API, all requests are GET</p>
        </div>
        <div id="baseURL" class="slide">
            <h3>The base URL</h3>
            <p>The base URL for the Analytics API is:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1</code></pre>
        </div>
        <div id="authorization" class="slide">
            <h3>Authorization</h3>
            <p>API calls are authorized using OAuth2 access tokens. The token is passed with requests in an authorization header:</p>
<pre class="slide"><code>Authorization: Bearer {access_token}</code></pre>
            <p class="slide">Access tokens are short-lived (5 min), so you must get one each time you make a request</p>
            <p class="slide">In these exercises, we'll make requests via a <a href="//docs.brightcove.com/en/video-cloud/oauth-api/guides/get-token.html#php">proxy</a> that will fetch an access token and then make the request.</p>
        </div>
        <div id="setupSection" class="section slide">
            <h2>Setup for the Exercises</h2>
        </div>
        <div>
            <div id="setup" class="slide" style="padding-left: 1.5em;max-width: 100%">
                <h3>Setup</h3>
                <p class="slide"><button class="bcls-button" id="useSampleAccount">Use Sample Account (recommended)</button> <button class="bcls-button" id="useMyAccount">Use My Account</button></p>
                <div id="basicInfo" class="display-none" style="width:90%">
                    <table>
                        <tbody>
                            <tr>
                                <td>Video Cloud Account (Publisher ID):</td>
                                <td>
                                    <input id="account_id" type="text" size="30"></td>
                            </tr>
                            <tr>
                                <td class="align-top no-wrap">Client id:</td>
                                <td>
                                    <input id="client_id" type="text" size="40" value="" /><p>
                                </td>
                            </tr>
                            <tr>
                                <td>Client secret:</td>
                                <td>
                                    <input id="client_secret" type="text" size="40" value="" /><p>
                                </td>
                            </tr>
                            <tr>
                                <td>Video ID (for some video with recent views):</td>
                                <td>
                                    <input id="video_id" type="text" size="30" value="" /><p>
                                </td>
                            </tr>
                            <tr>
                                <td>Player ID (for some player with recent views):</td>
                                <td>
                                    <input id="player_id" type="text" size="30" value="" /><p>
                                </td>
                            </tr>
                            <tr>
                                <td>Tag (for some video with recent views):</td>
                                <td>
                                    <input id="tags" type="text" size="30" value="" /><p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <p><button class="bcls-button" id="setOptions">Set Account Options</button></p>
                    <p>See <a href="//docs.brightcove.com/en/video-cloud/analytics-api/guides/managing-api-credentials.html">Managing API Credentials</a> for information on getting client credentials.</p>
                </div>
            </div>
        </div>
        <!-- end slide - no content - for slides only -->
        <div class="slide endSlide slide-only"></div>
        <div id="basicDimensionReport" class="section slide">
            <h2>Dimension Report</h2>
        </div>
        <div id="dimensionReportSetup" class="slide">
            <h3>Getting a dimension report</h3>
            <p>To get all the profiles for an account, make a GET request to the endpoint:</p>
<pre class="slide"><code>/data?accounts={account_id(s)}&dimensions={dimension}</code></pre>
            <p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1/data?accounts=20318290001&dimensions=video</code></pre>
<p class="BCL-aside slide">See <a href="http://docs.brightcove.com/en/video-cloud/analytics-api/getting-started/api-overview.html#metrics">Dimensions and Fields</a> for a list of valid dimensions</p>
        </div>
        <div id="exercise1" class="slide">
            <h3>Exercise 1: Get a dimension report</h3>
            <p>Make the following GET request:</p>
            <textarea id="ex1request"></textarea>
            <p><button id="ex1button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex1resp" class="slide">
            <h3 class="slide-only">Exercise 1 response</h3>
            <textarea id="ex1response" style="height:12em;">Response will appear here</textarea>
        </div>
        </div>
        <!-- end slide - no content - for slides only -->
        <div class="slide endSlide slide-only"></div>
        <div id="multipleDimensionSection" class="section slide">
            <h2>Report on multiple dimensions</h2>
        </div>
        <div id="multipleDimensionSetup" class="slide">
            <h3>Reporting on multiple dimensions</h3>
            <p>You can also combine more than one dimension:</p>
<pre class="slide"><code>/data?accounts={account_id(s)}&dimensions={dimension1,dimension2}</code></pre>
            <p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1/data?accounts=20318290001&<strong>dimensions=video,country</strong></code></pre>
            <p class="BCL-aside slide">See <a href="http://docs.brightcove.com/en/video-cloud/analytics-api/getting-started/api-overview.html#reportDimensions">Multiple Dimensions</a> to see which dimensions can be combined</p>
        </div>
        <div id="exercise2" class="slide">
            <h3>Exercise 2: Report on multiple dimensions</h3>
            <p>Make the following GET request:</p>
            <textarea id="ex2request"></textarea>
            <p><button id="ex2button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex2resp" class="slide">
            <h3 class="slide-only">Exercise 2 Response</h3>
            <textarea id="ex2response" style="height:12em;">Response will appear here</textarea>
        </div>
        <!-- end slide - no content - for slides only -->
        <div class="slide endSlide slide-only"></div>
        <div id="setFields" class="section slide">
            <h2>Fields and Sorting</h2>
        </div>
        <div id="setFieldsSetup" class="slide">
            <h3>Setting the response fields</h3>
            <p>To specify the fields you want to return, use the URL param <code>fields</code>:</p>
<pre class="slide"><code>/data?accounts={account_id(s)}&dimensions={dimension}&<strong>fields={field1,field2,field3...}</strong></code></pre>
            <p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1//data?accounts=73734234876&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name</code></pre>
        <p class="BCL-aside slide">See <a href="http://docs.brightcove.com/en/video-cloud/analytics-api/getting-started/api-overview.html#metrics">Dimensions and Fields</a> for a list fields available for each dimension - and note that the request will fail if you specify an invalid field for the dimension.</p>
        </div>
        <div id="exercise3" class="slide">
            <h3>Exercise 3: Set item fields</h3>
            <p>This the same request as the previous exerise, but with <code>fields</code> added::</p>
            <textarea id="ex3request"></textarea>
            <p><button id="ex3button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex3resp" class="slide">
            <h3 class="slide-only">Exercise 3 response</h3>
            <textarea id="ex3response" style="height:12em;">Response will appear here</textarea>
        </div>
        </div>
        <div id="sortOrderSetup" class="slide">
            <h3>Set sort order</h3>
            <p>To sort response items, set the sort paramater equal to a valid field:</p>
<pre class="slide"><code>/data?accounts={account_id(s)}&dimensions={dimension}&fields={field1,field2,field3...}&<strong>sort={sort_field}</strong></code></pre>
            <p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1//data?accounts=73734234876&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&<strong>sort=country_name</strong>
</code></pre>
        <p class="BCL-aside slide">You can sort on any valid field for the dimension(s) even if you are not returning that field</p>
        </div>

        <div id="exercise4" class="slide">
            <h3>Exercise 4: Sort results</h3>
            <p>Make the following request to sort your results by country:</p>
            <textarea id="ex4request"></textarea>
            <p><button id="ex4button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex4resp" class="slide">
            <h3 class="slide-only">Exercise 4 Response</h3>
            <textarea id="ex4response" style="height:12em;">Response will appear here</textarea>
        </div>
        <!-- end slide - no content - for slides only -->
        <div class="slide endSlide slide-only"></div>
        <div id="limitOffsetSection" class="section slide">
            <h2>Limit and Offset</h2>
        </div>
        <div id="limitOffsetSetup" class="slide">
            <h3>Using limit and offset</h3>
            <p>Specify the number of items to return using <code>limit</code> (default: 10) and the number of items to skip using <code>offset</code> (default: 0):</p>
<pre class="slide"><code>/data?accounts={account_id(s)}&dimensions={dimension}&fields={field1,field2,field3...}&sort={sort_field}<strong>&limit={limit}&offset={offset}</strong></code></pre>
<p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1//data?accounts=73734234876&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name<strong>&limit=5&offset=10</strong>
</code></pre>
            <p class="BCL-aside slide">To return all items, use <code>offset=all</code></p>
        </div>
        <div id="exercise5" class="slide">
            <h3>Exercise 5: Limit and offset</h3>
            <p>Make the following request to limit the response items to 5, with an offset of 10:</p>
            <textarea id="ex5request"></textarea>
            <p><button id="ex5button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex5resp" class="slide">
            <h3 class="slide-only">Exercise 5 response</h3>
            <textarea id="ex5response" style="height:12em;">Response will appear here</textarea>
        </div>
        <!-- end slide - no content - for slides only -->
        <div class="slide endSlide slide-only"></div>
        <div id="dateRangeSection" class="section slide">
            <h2>Set Date Range</h2>
        </div>
        <div id="dateRangeSetup" class="slide">
            <h3>Set date range for a report</h3>
            <p>Set the date range using the <code>from</code> (default: 30 days before now) and <code>to</code> (default: now) parameters. Dates are specified in ISO 8601 format (without the time part):</p>
<pre class="slide"><code>/data?accounts={account_id(s)}&dimensions={dimension}&fields={field1,field2,field3...}&sort={sort_field}<strong>&from={date}&to={date}</strong></code></pre>
            <p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1//data?accounts=73734234876&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name<strong>&from=2015-01-01&to=2015-01-31</strong>
</code></pre>
<p class="BCL-aside slide">Note: you can also specify the date in Epoch time (milliseconds) - we'll see in a later exercise where this is useful.</p>
        </div>
        <div id="exercise6" class="slide">
            <h3>Exercise 6: Set the date range</h3>
            <p>This request modifies the previous exercise by requesting analytics for the month of January, 2015:</p>
            <textarea id="ex6request"></textarea>
            <p><button id="ex6button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex6resp" class="slide">
            <h3 class="slide-only">Exercise 6 response</h3>
            <textarea id="ex6response" style="height:12em;">Response will appear here</textarea>
        </div>
        <!-- end slide - no content - for slides only -->
        <div class="slide endSlide slide-only"></div>
        <div id="whereFilterSection" class="section slide">
            <h2>where Filters</h2>
        </div>
        <div id="whereFilterSetup" class="slide">
            <h3>Using where filters</h3>
            <p><code>where</code> filters are used to limit the results based on the value of some dimension:</p>
<pre class="slide"><code>/data?accounts={account_id(s)}&dimensions={dimension}&fields={field1,field2,field3...}&sort={sort_field}&from={date}&to={date}<strong>&where={dimension1}=={value1};{dimension2}=={value2}</strong></code></pre>
            <p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1//data?accounts=73734234876&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name&from=2015-01-01&to=2015-01-31<strong>&where=player==84783749347;country==us</strong>
</code></pre>
        </div>
        <div id="exercise7" class="slide">
            <h3>Exercise 7: Set a where filter</h3>
            <p>Now we will filter the results from the previous exercise, returning results for a specific player:</p>
            <textarea id="ex7request"></textarea>
            <p><button id="ex7button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex7resp" class="slide">
            <h3 class="slide-only">Exercise 7 Response</h3>
            <textarea id="ex7response" style="height:12em;">Response will appear here</textarea>
        </div>
        <div id="updateDefaultProfileSetup" class="slide">
            <h3>Filter on video properties</h3>
            <p>You can also use <code>where</code> filters to filter by queries on video properties such as tags or reference ids:</p>
<pre class="slide"><code>/data?accounts={account_id(s)}&dimensions={dimension}&fields={field1,field2,field3...}&sort={sort_field}&from={date}&to={date}<strong>&where=video.q=={field:value}</strong></code></pre>
            <p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1//data?accounts=73734234876&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name&from=2015-01-01&to=2015-01-31<strong>&where=video.q==tags:training</strong>
</code></pre>
<p class="BCL-aside slide">This filter is based on <a href="//docs.brightcove.com/en/video-cloud/cms-api/guides/search-videos.html">CMS API searches</a>. Search strings must be <a href="//docs.brightcove.com/en/video-cloud/utilities/URLencoder.html">URI-encoded</a>.</p>
        </div>
        <div id="exercise8" class="slide">
            <h3>Exercise 8: Filter on video tag</h3>
            <p>The following request includes videos based on a tag:</p>
            <textarea id="ex8request"></textarea>
            <p><button id="ex8button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex8resp" class="slide">
            <h3 class="slide-only">Exercise 7 Response</h3>
            <textarea id="ex8response" style="height:12em;">Response will appear here</textarea>
        </div>
        <!-- end slide - no content - for slides only -->
        <div class="slide endSlide slide-only"></div>
        <div id="engagementSection" class="section slide">
            <h2>Engagement Report</h2>
        </div>
        <div id="engagementIntro" class="slide">
            <h3>Getting a detailed engagement report</h3>
            <p>Detailed engagement reports are available for a video, a player, or a single account for periods within the past 32 days. (If the specified <code>from</code> value is earlier than 32 days ago, an error will be returned.) To get an engagement report for a video, make a request to this endpoint:</p>
<pre class="slide"><code>/engagement/accounts/{account_id}/videos/{video_id}&from={date-time}&to={date-time}</code></pre>
            <p class="slide">Example:</p>
<pre class="slide"><code>https://analytics.api.brightcove.com/v1//data?accounts=73734234876&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name<strong>&from=1434985080000&to=1434974335089</strong>
</code></pre>
<p class="BCL-aside slide">Note: you can also specify the date in ISO 8601 format if you want engagement by day(s) - use Epoch time (milliseconds) as shown here if you need hourly breakdowns within a single day.</p>
        </div>
        <div id="exercise9" class="slide">
            <h3>Exercise 9: Set the date range</h3>
            <p>This request modifies the previous exercise by requesting analytics for the month of January, 2015:</p>
            <textarea id="ex9request"></textarea>
            <p><button id="ex9button" class="bcls-button">Submit Request</button></p>
            <p class="slide-only">(Response will appear on the next slide)</p>
        </div>
        <div id="ex6resp" class="slide">
            <h3 class="slide-only">Exercise 9 response</h3>
            <textarea id="ex9response" style="height:12em;">Response will appear here</textarea>
        </div>
        <!-- end slide - no content - for slides only -->
        <div class="slide endSlide slide-only"></div>
    </div>

    <!-- End slides. -->

    <!-- Begin extension snippets. Add or remove as needed. -->

    <!-- deck.navigation snippet -->
    <div aria-role="navigation">
      <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
      <a href="#" class="deck-next-link" title="Next">&#8594;</a>
    </div>

    <!-- deck.status snippet -->
    <p class="deck-status" aria-role="status">
      <span class="deck-status-current"></span>
      /
      <span class="deck-status-total"></span>
    </p>

    <!-- deck.goto snippet -->
    <form action="." method="get" class="goto-form">
      <label for="goto-slide">Go to slide:</label>
      <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
      <datalist id="goto-datalist"></datalist>
      <input type="submit" value="Go">
    </form>

    <!-- End extension snippets. -->
  </div>

<!-- Required JS files. -->
<script src="//docs.brightcove.com/en/scripts/slides/jquery.min.js"></script>
<script src="//docs.brightcove.com/en/scripts/slides/core/deck.core.js"></script>

<!-- Extension JS files. Add or remove as needed. -->
<script src="//docs.brightcove.com/en/scripts/slides/extensions/menu/deck.menu.js"></script>
<script src="//docs.brightcove.com/en/scripts/slides/extensions/goto/deck.goto.js"></script>
<script src="//docs.brightcove.com/en/scripts/slides/extensions/status/deck.status.js"></script>
<script src="//docs.brightcove.com/en/scripts/slides/extensions/navigation/deck.navigation.js"></script>
<script src="//docs.brightcove.com/en/scripts/slides/extensions/scale/deck.scale.js"></script>

<!-- syntax highlighter for pre-code blocks -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>

<script id="pageScript" type="text/javascript">
var BCLS = (function(window, document) {
    'use strict';
    var proxyURL = 'https://solutions.brightcove.com/bcls/bcls-proxy/bcls-proxy.php',
        baseURL = 'https://analytics.api.brightcove.com/v1',
        useMyAccount = document.getElementById('useMyAccount'),
        basicInfo = document.getElementById('basicInfo'),
        account_id = document.getElementById('account_id'),
        client_id = document.getElementById('client_id'),
        client_secret = document.getElementById('client_secret'),
        video_id = document.getElementById('video_id'),
        player_id = document.getElementById('player_id'),
        tags = document.getElementById('tags'),
        setOptions = document.getElementById('setOptions'),
        /**
         * defaults - Brightcove Learning account values
         * here - change to account you want to use
         * permissions for:
         * Analytics API - all operations
         */
        defaults = {
            account_id: '20318290001',
            client_id: '2f3b7e79-a8e8-4a21-b2c8-6480cf5f2c8d',
            client_secret: 'PiDmMouSDBNsNJUuEK90u8bpVn-kSw9D-BM5ADI_rnsLP2KXGN_7OxE6ng2-FAykgLnjj47aS3EeBd2N2K5kiA',
            player_id: 'E16-WGGOe',
            video_id: '4230322585001',
            tags: 'drupal'
        },
        options = {},
        // for the exercises
        ex1request = document.getElementById('ex1request'),
        ex1response = document.getElementById('ex1response'),
        ex1button = document.getElementById('ex1button'),
        ex2request = document.getElementById('ex2request'),
        ex2response = document.getElementById('ex2response'),
        ex2button = document.getElementById('ex2button'),
        ex3request = document.getElementById('ex3request'),
        ex3response = document.getElementById('ex3response'),
        ex3button = document.getElementById('ex3button'),
        ex4request = document.getElementById('ex4request'),
        ex4response = document.getElementById('ex4response'),
        ex4button = document.getElementById('ex4button'),
        ex5request = document.getElementById('ex5request'),
        ex5response = document.getElementById('ex5response'),
        ex5button = document.getElementById('ex5button'),
        ex6request = document.getElementById('ex6request'),
        ex6response = document.getElementById('ex6response'),
        ex6button = document.getElementById('ex6button'),
        ex7request = document.getElementById('ex7request'),
        ex7response = document.getElementById('ex7response'),
        ex7button = document.getElementById('ex7button'),
        ex8request = document.getElementById('ex8request'),
        ex8response = document.getElementById('ex8response'),
        ex8button = document.getElementById('ex8button'),
        ex9request = document.getElementById('ex9request'),
        ex9response = document.getElementById('ex9response'),
        ex9button = document.getElementById('ex9button'),
        // functions
        isDefined,
        bclslog,
        copyObj,
        setAccountOptions,
        setupExercises,
        submitRequest;
        /**
         * tests for all the ways a variable might be
         * undefined or not have a value
         * @param {*} x the variable to test
         * @return {Boolean} true if variable is defined and has a value
         */
        isDefined = function(x) {
            if ( x === "" || x === null || x === undefined || x === NaN) {
                return false;
            }
            return true;
        };
        /**
         * Logging function - safe for IE
         * @param  {string} context description of the data
         * @param  {*} message data to be logged
         */
        bclslog = function(context, message) {
            if (window['console'] && console['log']) {
              console.log(context, message);
            }
        };
        /**
         * get a copy of (rather than reference to) an object
         * @param  {object} obj the object you want a copy
         * @return {object}     the copy
         */
        copyObj = function(obj) {
            if (isDefined(obj)) {
                return JSON.parse(JSON.stringify(obj));
            }
            bclslog("copy obj error - no object passed");
            return {};
        };
        /**
         * set up account options when you are ready
         * to assemble the URL and make the API call
         */
        setAccountOptions = function() {
            defaults.account_id = isDefined(account_id.value) ? account_id.value : defaults.account_id;
            defaults.client_id = isDefined(client_id.value) ? client_id.value : defaults.client_id;
            defaults.client_secret = isDefined(client_secret.value) ? client_secret.value : defaults.client_secret;
            defaults.video_id = isDefined(video_id.value) ? video_id.value : defaults.video_id;
            defaults.player_id = isDefined(player_id.value) ? player_id.value : defaults.player_id;
            defaults.tags = isDefined(tags.value) ? tags.value : defaults.tags;
            bclslog("defaults", defaults);
        };
        /**
         * set up values for exercises
         */
        setupExercises = function() {
            var dataAccounts = '/data?accounts=' + defaults.account_id,
                now = new Date(),
                nowISO = now.toISOString().substring(0, 9),
                weekAgo = new Date(now.valueOf() - 14 * 24 * 3600 * 1000),
                weekAgoISO = weekAgo.toISOString().substring(0, 9);
            bclslog("now", nowISO);
            bclslog("week ago", weekAgoISO);
            ex1request.value = baseURL + dataAccounts + '&dimensions=video';
            ex2request.value = baseURL + dataAccounts + '&dimensions=video,country';
            ex3request.value = baseURL + dataAccounts + '&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name';
            ex4request.value = baseURL + dataAccounts + '&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name';
            ex5request.value = baseURL + dataAccounts + '&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name&limit=5&offset=10';
            ex6request.value = baseURL + dataAccounts + '&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name&limit=5&offset=10&from=' + weekAgoISO + '&to=' + nowISO;
            ex7request.value = baseURL + dataAccounts + '&dimensions=video,country&fields=video_name,video_view,video_impression,country,country_name&sort=country_name&limit=5&offset=10&from=' + weekAgoISO + '&to=' + nowISO;
            ex8request.value = baseURL + dataAccounts + '/configuration';
            ex9request = baseURL;
        };
        // listeners
        // toggle sample/customer account
        useMyAccount.addEventListener('click', function() {
            if (basicInfo.className === 'display-none') {
                basicInfo.className = 'display-block';
                useMyAccount.innerHTML = 'Cancel';
            } else {
                basicInfo.className = 'display-none';
                useMyAccount.innerHTML = 'Use My Account';
            }
        });
        useSampleAccount.addEventListener('click', function() {
            setAccountOptions();
            useSampleAccount.innerHTML = 'Setup Complete!';
            setupExercises();
        });
        /**
         * submits the api request to the proxy and writes the response
         * @param  {string} the request type get, post, patch, put, delete
         * @param  {object:htmlElement} reqEl  element that holds the api request
         * @param  {object:htmlElement} respEl element to write the response to
         * @param  {object:htmlElement} dataEl element that holds request data (optional)
         */
        submitRequest = function(exNum, reqType, reqEl, respEl, dataEl) {
            var options = {},
                respData;
            options.client_id = defaults.client_id;
            options.client_secret = defaults.client_secret;
            options.url = reqEl.value;
            options.requestType = reqType.toUpperCase();
            options.requestBody = (isDefined(dataEl)) ? dataEl.value : null;
            bclslog('options', options);
            $.ajax({
                url: proxyURL,
                method: 'GET',
                data: options,
                success : function(data) {
                    try {
                        bclslog('data', data);
                        respData = JSON.parse(data);
                        respEl.value = JSON.stringify(respData, null, '  ');
                        if (exNum === 2) {
                            profile_id = respData.id;
                            bclslog('profile_id', profile_id);
                            setupExercises();
                        }
                        if (exNum === 6 || exNum === 7) {
                            config_id = respData['id'];
                            bclslog('config_id', config_id);
                            setupExercises();
                        }
                    } catch (e) {
                         bclslog('invalid JSON - something went wrong', e);
                         data = {'Error': e};
                         switch (exNum) {
                            default:
                            respEl.value = 'There was a problem with the request';
                            break;
                         }
                    }
                    // write the response to the response element

                }
            });
        }
        // set account options
        setOptions.addEventListener('click', function() {
            setAccountOptions();
            setOptions.innerHTML = 'Setup Complete!';
            setupExercises();
        });
        // exercise button handlers
        ex1button.addEventListener('click', function() {
            submitRequest(1, 'get', ex1request, ex1response);
        });
        ex2button.addEventListener('click', function() {
            submitRequest(2, 'post', ex2request, ex2response, ex2data);
        });
        ex3button.addEventListener('click', function() {
            submitRequest(3, 'get', ex3request, ex3response);
        });
        ex4button.addEventListener('click', function() {
            submitRequest(4, 'put', ex4request, ex4response, ex4data);
        });
        ex5button.addEventListener('click', function() {
            submitRequest(5, 'delete', ex5request, ex5response);
        });
        ex6button.addEventListener('click', function() {
            submitRequest(6, 'get', ex6request, ex6response);
        });
        ex7button.addEventListener('click', function() {
            submitRequest(7, 'post', ex7request, ex7response, ex7data);
        });
        ex8button.addEventListener('click', function() {
            submitRequest(8, 'post', ex8request, ex8response, ex8data);
        });
        ex9button.addEventListener('click', function() {
            submitRequest(9, 'post', ex9request, ex9response, ex8data);
        });
    return {};
})(window, document);
    </script>
<!-- Automatically write the doc h1 heading to the title tag
and creates public method BCLSslides.bclshighlight(), which
adds syntax highlighting to pre>code blocks
 -->
<script>
    var bclsslides = ( function($, window, document, hljs) {
        var bclsinjectTitle,
            bclshighlight,
            $precode = $("pre>code");
            bclsinjectTitle = function() {
                var titleEl = document.getElementsByTagName("title")[0],
                    docTitle = document.getElementsByTagName("h1")[0];
                    docTitle.addEventListener("change", function() {
                        titleEl.innerHTML = this.innerHTML;
                    });
            };
            bclshighlight = function() {
                $precode.each(function(i, e) {
                    hljs.highlightBlock(e);
                });
            };
            // call these initially
            bclsinjectTitle();
            bclshighlight();
            /**
             * return bclshighlight
             * public method: BCLSslides.BCLShightlight()
             */
            return {
                "bclshighlight": bclshighlight
            }
        })($, window, document, hljs);

</script>
<!-- Initialize the deck. You can put this in an external file if desired. -->
<!-- need to put this at the end in case the script above is generating content dynamically -->
<script>
  $(function() {
    $.deck('.slide');
  });
</script>
<iframe width="550" height="475" frameborder="0" src="
http://survey.clicktools.com/app/survey/go.jsp?iv=3poon3e7e9spn&q1=
[articleURL]" style="margin-left:25%; padding-bottom:20px;"></iframe>
<br><br>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>
</html>
