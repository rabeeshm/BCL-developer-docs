<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Begin Drupal Taxonomy Data -->
    <meta name="products" content="Live">
    <meta name="role" content="API Developer">
    <meta name="task" content="">
    <meta name="topic" content="General Info,Live Streaming">
    <meta name="API" content="Live">
    <meta name="keywords" content="">
    <!-- End Drupal Taxonomy Data -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <!-- change title to match the h1 heading -->
    <title>Server-Side Ad Insertion Using the Brightcove Live API</title>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
<link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
<script src="//use.edgefonts.net/source-code-pro.js"></script>
<link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
<link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
<link rel="stylesheet" href="/en/styles/foundation-fixes.css">

<script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-2728311-29', 'auto');
    ga('send', 'pageview');
</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
    <!-- header navbar -->
    <div id="navWrapper" class="fixed"></div>
    <!-- breadcrumbs -->
    <nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
    <!-- search -->
    <div id="searchModal" class="reveal-modal" data-reveal></div>
    <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
            <h1>Server-Side Ad Insertion Using the Brightcove Live API</h1>
            <!-- begin drupal content -->
            <article class="bcls-article"><script src="//learning-services-media.brightcove.com/doc-assets/js/searchDocs.js"></script>
                <header id="bcls_header" class="bcls-header">
                    <p>This topic shows you how to set up server-side ad insertion (SSAI) for you live stream jobs.</p>
                </header>
            </article>
            <section id="Overview" class="bcls-section">
                <h2>Overview</h2>
                <p>SSAI allows you display ads during a live streaming event at specified times. Here are the main featurs of SSAI:</p>
                <ul>
                    <li>Since ads are stitched into the live stream on the server side, they are not affected by ad blockers</li>
                    <li>Ads are inserted at cue points sent from your encoder or you can create an instant cue point using the Live API</li>
                    <li>You can ingest "slate" assets to fill any unused ad time</li>
                </ul>
            </section>
            <section id="authentication" class="bcls-section">
                <h2>Headers</h2>
                <p>The following headers are required with API requests:</p>
<pre class="line-numbers"><code class="language-http">x-api-key: <span class="bcle-input">APIKEY-HERE</span>
Content-Type: application/json</code></pre>
            </section>
            <section id="ad_configuration_variables" class="bcls-section">
                <h2>Ad configuration variables</h2>
                <p>The following table provides a summary of ad configuration variables, which are used in the requests to manage ad configurations detailed in the sections that follow.</p>
                <table class="bcls-table">
                    <caption class="bcls-caption--table">Ad Configuration Variables</caption>
                    <thead class="bcls-table__head">
                        <tr>
                            <th style="width:20%;">Variable</th>
                            <th style="width:60%;"><div style="word-wrap:break-word;">Description</div></th>
                        </tr>
                    </thead>
                    <tbody class="bcls-table__body">
                        <tr>
                            <td style="width:20%">session.session_id</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">unique session id</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">job.job_id</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">unique job id</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">application_ad_configuration.description</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">description value of the application at session creation</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">random.int32</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">random 32-bit signed integer</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">random.int64</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">random 64-bit signed integer</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">random.uuid</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">random uuid</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">server.timestamputc</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">epoch time in ms when the call from the ads-api has been made</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">client.useragent</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">http user-agent header value at session creation</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">client.ipaddress</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">http x-forwarded-for header value at session creation, if provided, otherwise the remote address</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">client.referrer</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">http referer header value at session creation (correct spelling)</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">client.referer</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">http referer header value at session creation (http spelling)</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreak</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">(currently unused)</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreakduration</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">double-precision floating-point value in seconds</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreakdurationint</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">integer value in seconds</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreak.timestamputc.wallclock</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">epoch time in ms when the call to the ads server has been made</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreak.timestamputc.origin</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">epoch time in ms from the origin chunklist. This value indicates the time when the cue out chunk has been created in the origin chunklist.</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreak.timestamputc.session</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">epoch time in ms from the ssai chunklist. This value indicates the time of the cue out chunk in the ssai chunklist. Since the adbreak content and the adbreak gap are NOT usually the same, after the 1st adbreak the live.adbreak.timestamputc.origin is different from live.adbreak.timestamputc.session. This value takes into account the time adjustments that have been made in the ssai chunklist.</div></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section id="create_ad_configurations" class="bcls-section">
                <h2>Create an ad configuration</h2>
                <p>To create a new ad configuration, send a <code>POST</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/application</code></pre>
                <h3>Sample request body</h3>
<pre class="line-numbers"><code class="language-json">{
    "application_ad_configuration": {
        "ad_configuration_description": "Human readable description of the configuration",
        "ad_configuration_expected_response_type": "Dfp/Vast/SmartXML",
        "ad_configuration_strategy": "SingleAdResponse/MultipleAdResponse",
        "ad_configuration_transforms": [
        {
            "xpath": "/",
            "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
        }],
        "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
    },
    "application_description": "Human readable description of the ad application",
    "account_id": <span class="bcls-input">"USER'S ACCOUNT ID" [Optional - When omitted, Account ID of requesting user is used]</span>
}</code></pre>
                <h3>Sample response</h3>
<pre class="line-numbers"><code class="language-json">{
  "application": {
    "account_id": "USER ACCOUNT ID",
    "application_description": "Human readable description of the ad application",
    "application_ad_configuration": {
      "ad_configuration_description": "Human readable description of the configuration",
      "ad_configuration_expected_response_type": "Dfp/Vast/SmartXML,
      "ad_configuration_strategy": "SingleAdResponse/MultipleAdResponse",
      "ad_configuration_transforms": [
        {
          "xpath": "/",
          "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
        }
      ],
      "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
    },
    "application_id": <span class="bcle-highlight">"APPLICATION ID"</span>
  },
  "inserted": true
}</code></pre>
            </section>
            <section id="Update_an_ad_configuration" class="bcls-section">
                <h3>Update an ad configuration</h3>
                <p>Updating an ad configuration is very similar to creating one. Make a <code>PUT</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/application/<span class="bcle-input">APPLICATION_ID</span></code></pre>
                <h3>Sample request body</h3>
<pre class="line-numbers"><code class="language-json">{
    "application_ad_configuration": {
        "ad_configuration_description": "Some Updated Description Value",
        "ad_configuration_expected_response_type": "Dfp/Vast/SmartXML",
        "ad_configuration_strategy": "SingleAdResponse/MultipleAdResponse",
        "ad_configuration_transforms": [
        {
            "xpath": "/",
            "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
        }],
        "ad_configuration_url_format": "https://updated-ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
    },
    "application_description": "Human readable description of the ad application",
    "account_id": <span class="bcls-input">"USER'S ACCOUNT ID" [Optional - When omitted, Account ID of requesting user is used]</span>
}</code></pre>
                <h3>Sample response</h3>
<pre class="line-numbers"><code class="language-json">{
    "account_id": "USER ACCOUNT ID",
    "application_description": "Human readable description of the ad application",
    "application_ad_configuration": {
        "ad_configuration_description": "Some Updated Description Value",
        "ad_configuration_expected_response_type": "Dfp/Vast/SmartXML,
        "ad_configuration_strategy": "SingleAdResponse/MultipleAdResponse",
        "ad_configuration_transforms": [
        {
            "xpath": "/",
            "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
        }
        ],
        "ad_configuration_url_format": "https://updated-ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
    },
    "application_id": <span class="bcle-highlight">"APPLICATION ID"</span>
}</code></pre>
            </section>
            <section id="Get_all_ad_configurations" class="bcls-section">
                <h2>Get all ad configurations</h2>
                <p>To retrieve all the ad configurations for an account, submit a <code>GET</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/applications/<span class="bcle-input">ACCOUNT_ID</span></code></pre>
                <h3>Sample response</h3>
<pre class="line-numbers"><code class="language-json">[
  {
    "application_id": "APPLICATION_ID_1",
    "application_description": "DFP Single Midroll",
    "application_ad_configuration": {
      "ad_configuration_description": "DFP Test Config Single Midroll",
      "ad_configuration_strategy": "MultipleAdResponse",
      "ad_configuration_transforms": [],
      "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler",
      "ad_configuration_expected_response_type": "Dfp"
    },
    "account_id": "ACCOUNT_ID"
  },
  {
    "application_id": "APPLICATION_ID_2",
    "application_description": "Test DFP Single Midroll"
    "application_ad_configuration": {
      "ad_configuration_description": "DFP Test Config Single Midroll",
      "ad_configuration_strategy": "MultipleAdResponse",
      "ad_configuration_transforms": [
        {
          "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;",
          "xpath": "/"
        }
      ],
      "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}",
      "ad_configuration_expected_response_type": "Dfp"
    },
    "account_id": "ACCOUNT_ID"
  }
]</code></pre>
            </section>
            <section id="Get_an_ad_configuration" class="bcls-section">
                <h2>Get an ad configuration</h2>
                <p>You can also retrieve a specific ad configuration by its <code>application_id</code> by sending <code>GET</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/application/<span class="bcle-input">APPLICATION_ID</span></code></pre>
                <h3>Sample response</h3>
<pre class="line-numbers"><code class="language-json">{
  "application_id": "APPLICATION_ID",
  "application_description": "Test DFP Single Midroll",
  "application_ad_configuration": {
    "ad_configuration_description": "DFP Test Config Single Midroll",
    "ad_configuration_strategy": "MultipleAdResponse",
    "ad_configuration_transforms": [
      {
        "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;",
        "xpath": "/"
      }
    ],
    "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}",
    "ad_configuration_expected_response_type": "Dfp"
  },
  "account_id": "ACCOUNT_ID"
}</code></pre>
            </section>
            <section id="Delete_an_ad_configuration" class="bcls-section">
                <h2>Delete an ad configuration</h2>
                <p>To delete an ad configuration, send a <code>DELETE</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/application/<span class="bcle-input">APPLICATION_ID</span></code></pre>
                <h3>Sample response</h3>
<pre class="line-numbers"><code class="language-json">{
  "application_id": "APPLICATION_ID",
  "deleted": true
}</code></pre>
            </section>
            <section id="Cuepoints" class="bcls-section">
                <h2>Cuepoints</h2>
                <p>Ad breaks are triggered by cuepoints, which can be specified in two ways:</p>
                <ul>
                    <li>Sent to Brightcove by the encoder</li>
                    <li>Immediate cuepoints created via the Live API</li>
                </ul>
                <h3>From the encoder</h3>
                <p>The Brightcove live delivery system can interpret cuepoints submitted by the encoder in the AMF format:</p>
<pre class="line-numbers"><code class="language-bash">AMFDataList
    [0]:onCuePoint
    [1]:{Obj[]:
        time: 1.9889, //Difference from PTS of THIS packet to the first PTS of the 1st video frame in the adbreak
        name: "scte35",
        type: "event",
        parameters: {Obj[]:
            type: "avail_in",
            duration: 12.0}
        }</code></pre>
                <h3>Manual insertion</h3>
                <p></p>
            </section>
            <section id="Manual_cue_point_insertion" class="bcls-section">
                <h2>Manual cue point insertion</h2>
                <p>You can also create immediate cuepoints using the Live API by sending a <code>POST</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/jobs/:jobId/cuepoint</code></pre>
                <p>Include a request body specifying the duration of the break in seconds:</p>
                <pre class="line-numbers"><code class="language-json">{
   "duration":30
}</code></pre>
            </section>
            <section id="Managing_slates" class="bcls-section">
                <h2>Managing slates</h2>
                <p>Slates are your own assets used to fill unused ad time. You can use slates to provide a "be right back" message or any content that you like.</p>
                <p>Below are details of the API requests to add and manage slate assets.</p>
                <h3>Ingest slate media source asset</h3>
                <p>To add a new slate asset, submit a <code>POST</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/slate</code></pre>
                <h4>Sample request body</h4>
<pre class="line-numbers"><code class="language-json">{
    "source_url": "https://somesourceasset.com/slate-to-ingest.mp4",
    <em>"account_id": "ACCOUNT_ID", [Optional - When omitted, Account ID of the requesting user is used.</em>
    <em>"source_description": "User identifiable description for the slate" [Optional]</em>
}</code></pre>
                <h4>Sample response</h4>
<pre class="line-numbers"><code class="language-json">{
  "media_source_asset_id": "NEW_UUID",
  "account_id": "ACCOUNT_ID",
  "media_source_asset_default": false,
  "media_source_asset_type": "slate",
  "media_source_asset_url": "https://somesourceasset.com/slate-to-ingest.mp4",
  "media_source_asset_status": "transcoding"
  "media_source_asset_description": "User identifiable description for the slate"
}</code></pre>
                <h3>Delete slate media source asset</h3>
                <p>To delete a slate media asset, send a <code>DELETE</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/slate/<span class="bcls-input">SLATE_MSA_ID</span></code></pre>
                <h4>Sample response</h4>
<pre class="line-numbers"><code class="language-json">{
  "media_source_asset_id": "MSA_UUID",
  "media_source_asset_type": "slate",
  "media_source_asset_url": "http://someS3urlpath/media.mp4",
  "media_source_asset_default": false,
  "media_source_asset_status": "ready",
  "account_id": "ACCOUNT_ID"
}</code></pre>
                <h3>Get slate media source assets</h3>
                <p>You can retrieve an array of all the slate assets for an account by sending a <code>GET</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/slates/<span class="bcls-input">ACCOUNT_ID</span></code></pre>
                <h4>Sample response</h4>
<pre class="line-numbers"><code class="language-json">[
  {
    "media_source_asset_id": "MSA_UUID_1",
    "media_source_asset_type": "slate",
    "media_source_asset_default": false,
    "media_source_asset_url": "http://someS3urlpath.com/media.mp4",
    "account_id": "ACCOUNT_ID",
    "media_source_asset_status": "ready"
  },
  {
    "media_source_asset_id": "MSA_UUID_2",
    "media_source_asset_type": "slate",
    "media_source_asset_default": true,
    "media_source_asset_url": "http://someS3urlpath.com/media.mp4",
    "account_id": "ACCOUNT_ID",
    "media_source_asset_status": "ready"
  }
]</code></pre>
            </section>
            <section id="Beacons" class="bcls-section">
                <h2>Beacons</h2>
                <p>Beacons are data points on playback sent to ad servers to track whether and how much of ads were played. In this section we will look at the beacon types that can be set using the Live API, and variables that can be used to provide the data. The next section will detail the API requests use to create and manage beacon sets.</p>
                <h3>Beacon types</h3>
                <table class="bcls-table">
                    <caption class="bcls-caption--table">Beacon Types</caption>
                    <thead class="bcls-table__head">
                        <tr>
                            <th style="width:20%;">Beacon Type</th>
                            <th style="width:60%;word-wrap:break-word">Description</th>
                        </tr>
                    </thead>
                    <tbody class="bcls-table__body">
                        <tr>
                            <td style="width:20%">Load</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">Fired once per session and only triggered when top level manifest is requested</td>
                        </tr>
                        <tr>
                            <td style="width:20%">Play</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">Content has been requested and the first segment returned</td>
                        </tr>
                        <tr>
                            <td style="width:20%">Heartbeat</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">Configurable on some interval</td>
                        </tr>
                        <tr>
                            <td style="width:20%">AdStart</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">Individual ad started</td>
                        </tr>
                        <tr>
                            <td style="width:20%">AdFirstQuartile</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">First ad quartile (25%)</td>
                        </tr>
                        <tr>
                            <td style="width:20%">AdMidpoint</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">Second ad quartile (50%)</td>
                        </tr>
                        <tr>
                            <td style="width:20%">AdThirdQuartile</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">Third ad quartile (75%)</td>
                        </tr>
                        <tr>
                            <td style="width:20%">AdComplete</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">Individual ad completed</td>
                        </tr>
                        <tr>
                            <td style="width:20%">AdBreakStart</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">Ad break has started</td>
                        </tr>
                        <tr>
                            <td style="width:20%">AdBreakComplete</td>
                            <td style="text-align:left;width:60%;word-wrap:break-word">ad break has ended</td>
                        </tr>
                    </tbody>
                </table>
                <h3>Valid beacon variables</h3>
                <p>The table below shows the variables you can use to provide data for the beacon URLs. To include a variable, surround with double curly braces, like this: <code><span class="bcls-highlight">{{</span>job.job_id<span class="bcls-highlight">}}</span></code>. See the next section on managing beacon sets for full examples.</p>
                <table class="bcls-table">
                    <caption class="bcls-caption--table">Beacon Variables</caption>
                    <thead class="bcls-table__head">
                        <tr>
                            <th style="width:20%;">Variable</th>
                            <th style="width:60%;"><div style="word-wrap:break-word;">Description</div></th>
                        </tr>
                    </thead>
                    <tbody class="bcls-table__body">
                        <tr>
                            <td style="width:20%">session.session_id</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">unique session id</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">job.job_id</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">unique job id</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">application_ad_configuration.description</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">description value of the application at session creation</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">random.int32</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">random 32-bit signed integer</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">random.int64</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">random 64-bit signed integer</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">random.uint32</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">random 32-bit unsigned integer</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">random.uint64</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">random 64-bit unsigned integer</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">random.uuid</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">random uuid</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">server.timestamputc</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">epoch time in ms when the call from the ads-api has been made</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">client.useragent</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">http user-agent header value at session creation</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">client.ipaddress</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">http x-forwarded-for header value at session creation, if provided, otherwise the remote address</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">client.referrer</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">http referer header value at session creation (correct spelling)</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">client.referer</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">http referer header value at session creation (http spelling)</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreak</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">(currently unused)</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreakduration</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">double-precision floating-point value in seconds</div></td>
                        </tr>
                        <tr>
                            <td style="width:20%">live.adbreakdurationint</td>
                            <td style="text-align:left;width:60%;"><div style="word-wrap:break-word;">integer value in seconds</div></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            <section id="Manage_beacon_setx" class="bcls-section">
                <h2>Manage beacon sets</h2>
                <p>This section provides details on the API requests to manage beacon sets. See the previous section for beacon types and variables.</p>
                <h3>Create a beacon set</h3>
                <p>To create a beacon set, send a <code>POST</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/beaconset</code></pre>
                <h4>Sample request body</h4>
<pre class="line-numbers"><code class="language-json">{
    <em>"account_id": "USER's ACCOUNT ID", [Optional - If omitted, the Account ID of the requesting user is used.]</em>
    "beacon_urls": [
        {
            "beacon_url": "https://myserver.com/beaconRX/{{job.job_id}}/load?position=load&amp;sid={{session.session_id}}&amp;jid={{job.job_id}}&amp;app={{application_ad_configuration.description}}&amp;rnd32={{random.int32}}&amp;rnd64={{random.int64}}&amp;bid={{random.uuid}}&amp;t={{server.timestamputc}}&amp;ua={{client.useragent}}&amp;ip={{client.ipaddress}}&amp;ref={{client.referrer}}&amp;ref={{client.referer}}&amp;ab={{live.adbreak}}&amp;abd={{live.adbreakduration}}&amp;abdi={{live.adbreakdurationint}}",
            "beacon_type": "Load"
        },
        {
            "beacon_url": "https://myserver.com/beaconRX/{{job.job_id}}/play?position=play&amp;sid={{session.session_id}}&amp;jid={{job.job_id}}&amp;app={{application_ad_configuration.description}}&amp;rnd32={{random.int32}}&amp;rnd64={{random.int64}}&amp;bid={{random.uuid}}&amp;t={{server.timestamputc}}&amp;ua={{client.useragent}}&amp;ip={{client.ipaddress}}&amp;ref={{client.referrer}}&amp;ref={{client.referer}}&amp;ab={{live.adbreak}}&amp;abd={{live.adbreakduration}}&amp;abdi={{live.adbreakdurationint}}",
            "beacon_type": "Play"
        }
    ]
}</code></pre>
                <h4>Sample response</h4>
<pre class="line-numbers"><code class="language-json">{
    "beacon_set": {
        "beacon_urls": [{
            "beacon_url": "https://myserver.com/beaconRX/{{job.job_id}}/load?position=load&amp;sid={{session.session_id}}&amp;jid={{job.job_id}}&amp;app={{application_ad_configuration.description}}&amp;rnd32={{random.int32}}&amp;rnd64={{random.int64}}&amp;bid={{random.uuid}}&amp;t={{server.timestamputc}}&amp;ua={{client.useragent}}&amp;ip={{client.ipaddress}}&amp;ref={{client.referrer}}&amp;ref={{client.referer}}&amp;ab={{live.adbreak}}&amp;abd={{live.adbreakduration}}&amp;abdi={{live.adbreakdurationint}}",
            "beacon_type": "Load"
        },
        {
            "beacon_url": "https://myserver.com/beaconRX/{{job.job_id}}/play?position=play&amp;sid={{session.session_id}}&amp;jid={{job.job_id}}&amp;app={{application_ad_configuration.description}}&amp;rnd32={{random.int32}}&amp;rnd64={{random.int64}}&amp;bid={{random.uuid}}&amp;t={{server.timestamputc}}&amp;ua={{client.useragent}}&amp;ip={{client.ipaddress}}&amp;ref={{client.referrer}}&amp;ref={{client.referer}}&amp;ab={{live.adbreak}}&amp;abd={{live.adbreakduration}}&amp;abdi={{live.adbreakdurationint}}",
            "beacon_type": "Play"
        }],
        "beacon_set_id": "Inserted Beacon Set ID",
        "account_id": "USER's ACCOUNT ID"
    }
    "inserted": true
}</code></pre>
                <h3>Update a beacon set</h3>
                <p>Updating a beacon set is similar to creating one. Submit a <code>PUT</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/beaconset/<span class="bcle-input">BEACON_SET_ID</span></code></pre>
                <h4>Sample request body</h4>
<pre class="line-numbers"><code class="language-json">{
    <em>"account_id": "USER's ACCOUNT ID", [OPTIONAL - If omitted, the account id of the requesting user is used.]</em>,
    "beacon_urls": [
        {
            "beacon_url": "https://myserver.com/beaconRX/load",
            "beacon_type": "Load"
        },
        {
            "beacon_url": "https://myserver.com/beaconRX/play",
            "beacon_type": "Play"
        }
    ]
}</code></pre>
                <h4>Sample response</h4>
<pre class="line-numbers"><code class="language-json">{
    "beacon_set": {
        "account_id": "USER's ACCOUNT ID",
        "beacon_set_id": "BEACON_SET_ID",
        "beacon_urls": [{
            "beacon_url": "https://myserver.com/beaconRX/load",
            "beacon_type": "Load"
        },
        {
            "beacon_url": "https://myserver.com/beaconRX/play",
            "beacon_type": "Play"
        }],
        "updated_beacon_set": {
            "beacon_set_id": "BEACON_SET_ID",
            "beacon_urls": [{
                "beacon_url": "https://myserver.com/beaconRX/load",
                "beacon_type": "Load"
            },
            {
                "beacon_url": "https://myserver.com/beaconRX/play",
                "beacon_type": "Play"
            }],
            "account_id": "USER's ACCOUNT ID"
        }
    }
}</code></pre>
                <h3>Get beacon sets</h3>
                <p>To retrieve the beacon sets for an account, submit a <code>GET</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/beaconsets/ACCOUNT_ID</code></pre>
                <h4>Sample response</h4>
<pre class="line-numbers"><code class="language-json">[{
    "account_id": "USER's ACCOUNT ID",
    "beacon_set_id": "BEACON_SET_ID_1",
    "beacon_urls": [{
        "beacon_url": "https://myserver.com/beaconRX/load",
        "beacon_type": "Load"
    }]
},
{
    "account_id": "USER's ACCOUNT ID",
    "beacon_set_id": "BEACON_SET_ID_2",
    "beacon_urls": [{
       "beacon_url": "https://myserver.com/beaconRX2/load",
       "beacon_type": "Load"
    },
    {
       "beacon_url": "https://myserver.com/beaconRX2/play",
       "beacon_type": "Play"
    }]
}]</code></pre>
                <h3>Get beacon sets for requesting user</h3>
                <p>You can also get the beacon sets for the account of the requesting user without including the account id in the request URL:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/beaconsets</code></pre>
                <h4>Sample response</h4>
<pre class="line-numbers"><code class="language-json">[{
    "account_id": "USER's ACCOUNT ID",
    "beacon_set_id": "BEACON_SET_ID_1",
    "beacon_urls": [{
        "beacon_type": "Load",
        "beacon_url": "https://myserver.com/beaconRX/load"
    }]
},
{
    "account_id": "USER's ACCOUNT ID",
    "beacon_set_id": "BEACON_SET_ID_2",
    "beacon_urls": [{
        "beacon_type": "Load",
        "beacon_url": "https://myserver.com/beaconRX2/load"
    },
    {
        "beacon_type": "Play",
        "beacon_url": "https://myserver.com/beaconRX2/play"
    }]
}]</code></pre>
                <h3>Get a beacon set by id</h3>
                <p>To retrieve a single beacon set by its id, submit a <code>GET</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/beaconset/<span class="bcls-input">BEACON_SET_ID</span></code></pre>
                <h4>Sample response</h4>
<pre class="line-numbers"><code class="language-json">{
    "account_id": "USER_ACCOUNT_ID",
    "beacon_set_id": "BEACON_SET_ID",
    "beacon_urls": [{
        "beacon_type": "Load",
        "beacon_url": "https://myserver.com/beaconRX2/load"
    },
    {
        "beacon_type": "Play",
        "beacon_url": "https://myserver.com/beaconRX2/play"
    }]
}</code></pre>
                <h3>Delete a beacon set</h3>
                <p>Finally, to delete a beacon set, send a <code>DELETE</code> request to:</p>
                <pre class="line-numbers"><code class="language-http">https://api.bcovlive.io/v1/ssai/beaconset/<span class="bcls-input">BEACON_SET_ID</span></code></pre>
                <h4>Sample response</h4>
                <p>The response will look like this:</p>
<pre class="line-numbers"><code class="language-json">{
  "beacon_set_id": "BEACON_SET_ID",
  "deleted": true
}</code></pre>
            </section>
            <section id="Known_issues" class="bcls-section">
                <h2>Known issues</h2>
                <ul>
                    <li>If the VAST returned has the same ad ID, then the server will not request the ad content, even though the ad URL uses dynamic variables to make it a unique URL.</li>
                    <li>If an ad break has a duration less than the MAX duration of the ad URL (min_ad_duration=0&amp;max_ad_duration=30000), if ad is returned longer than the ad break, the ad will not be played.</li>
                </ul>
            </section>
            <!-- end drupal content -->
        </div>
    </div>
    <!-- bcl scripts -->
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.4/gist-embed.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
<script src="/en/scripts/docs-nav-data.min.js"></script>
<script src="/en/scripts/bcls-doc-site-v2.js"></script>
<script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
<script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
<script>
    $(document).foundation();
</script>
<div style="text-align:center">
    <iframe id="CSAT" src="//learning-services-media.brightcove.com/doc-assets/general/surveylink.html" style=" padding-bottom:20px;border:none"></iframe>
</div>
<div class="bcls-footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>
</html>
