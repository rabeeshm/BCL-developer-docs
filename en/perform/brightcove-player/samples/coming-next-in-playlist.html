<!DOCTYPE html>
<html lang="en">

<head>

	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
	<!-- change title to match the h1 heading -->
	<title>Brightcove Player Sample: Display Next Video Name from Playlist</title>
	<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
	<script src="//use.edgefonts.net/source-code-pro.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css" />
    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
  <style type="text/css">
    .video-js {
      float: left;
      margin: 15px;
      width: 450px;
      height: 250px;
    }
    .vjs-playlist {
      width: 250px;
      float: left;
      margin: 15px;
    }
    .hide-overlay .vjs-overlay {
      display: none;
    }
  </style>
  <link href="//players.brightcove.net/videojs-overlay/lib/videojs-overlay.css" rel='stylesheet'>
</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<!-- content -->
    <div class="perform-only">
        <h1>Brightcove Player Sample: Display Next Video Name from Playlist</h1>
        <p>The information contained in this document is not applicable for Perform customers.</p>
    </div>
  	<div class="row video-cloud-only">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav" class="side-nav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<div id="top" class="section">
				<h1>Brightcove Player Sample: Display Next Video Name from Playlist</h1>
				<!-- Place document intro sentence(s) here -->
				<p>This sample demonstrates how to display the title of the next video in a playlist the last 5 seconds of the currently playing video from the playlist. The last video in the playlist displays a note saying it is the last video in the playlist. The duration for which the name/message should be displayed is set in a variable. The sample uses the Overlay Plugin to display the name. A CSS style is used to control the visibility of the overlay.</p>
			</div>

			<div id="developmentsequence" class="section">
        <h2 id="expanderHead">Development sequence</h2>
        <div id="expanderContent" style="display:none">
          <p>Here is the recommended development sequence:</p>
          <ol>
            <li>Use the embed_in_page player implementation to test the functionality of your player, plugin and CSS (if CSS is needed)</li>
            <li>Put the plugin's JavaScript and CSS into separate files for local testing</li>
            <li>Deploy the plugin code and CSS to your server once you have worked out any errors</li>
            <li>Use the new Video Cloud Studio to add the plugin and CSS to your player</li>
            <li>Replace the embed_in_page player implementation if you determine that the iframe implementation is a better fit (detailed in next section)</li>
          </ol>
          <p>For details about these steps, review the <a href="//docs.brightcove.com/en/video-cloud/brightcove-player/guides/plugin-dev-quick-start.html">Quick Start to Plugin Development</a> guide.</p>
          <h3>iframe or embed_in_page</h3>
          <p>When developing enhancements for the Brightcove player you will need to decide if the code is a best fit for the iframe or embed_in_page implementation. The best practice recommendation is to build a plugin for use with an iframe implementation. The advantages of using the iframe player are:</p>
          <ul>
            <li>No collisions with existing JavaScript and/or CSS</li>
            <li>Automatically responsive</li>
            <li>The iframe eases use in social media apps (or whenever the video will need to "travel" into other apps)</li>
          </ul>
          <p>Although integrating the embed_in_page player can be more complex, there are times when you will plan your code around that implementation. To generalize, this approach is best when the containing page needs to communicate to the player. Specifically, here are some examples:</p>
          <ul>
            <li>Code in the containing page needs to listen for and act on player events</li>
            <li>The player uses styles from the containing page</li>
            <li>The iframe will cause application logic to fail, like a redirect from the containing page</li>
          </ul>
          <p>Even if your final implementation does not use the iframe player, you can still use the embed_in_page player with a plugin that contains your JavaScript and CSS. This encapsulates your logic so that you can easily use it in multiple players.</p>
			  </div><!-- id="expanderContent" -->
      </div>

      <div id="selectimplementation" class="section">
				<h2>Select implementation</h2>
				<p>In this sample, the logic can be placed in a plugin in used in that manner.</p>
			</div>

			<div id="resources" class="section">
				<h2>API resources used</h2>
				<p>The following sections detail resources used.</p>
				<h3>Brightcove Player API</h3>
				<p>
        <ul>
          <li>on()</li>
          <li>one()</li>
          <li>play()</li>
          <li>addClass()</li>
          <li>paused()</li>
          <li>playlist()</li>
          <li>playlist.currentItem()</li>
          <li>currentTime()</li>
          <li>removeClass()</li>
        </ul>
        </p>
				<h3>Plugins</h3>
				<p><a href="//docs.brightcove.com/en/video-cloud/brightcove-player/guides/overlay-plugin.html">Display Overlay Plugin</a></p>
			</div>

			<div id="player" class="section">
				<h2>The player</h2>
				<p>Start the video and with 5 seconds left in the video you will see the name of the second video appear. The last video will display a message stating it is the last video.</p>
        <video id="myPlayerID"
          data-playlist-id="4684620718001"
          data-account="1752604059001"
          data-player="7a129b53-9225-4b32-8595-906f9f4eaea9"
          data-embed="default"
          class="video-js" controls></video>

        <ol class="vjs-playlist"></ol>
			</div>

			<div id="code" class="section">
				<h2>How it works</h2>
				<p>The following sections explain the player, JavaScript and CSS code used in the example.</p>
        <h3>Create the player</h3>
        <div class="video-cloud-only">
          <p>To create a player and assign a playlist to it, follow these steps:</p>
            <ol>
              <li>Using Video Cloud Studio, in the <strong>Players</strong> module, create a new player. In the <strong>SETTINGS</strong> section, be sure to enable the use and auto-advance for playlists.<br />
              <div><img src="/en/video-cloud/brightcove-player/samples/assets/coming-next-in-playlist/studio-enable-playlist.png"></div>
              </li>
              <li>In the <strong>Media</strong> module, select an existing playlist, or create one. Publish the playlist with the player just created.</li>
              <li>Copy the <strong>Advanced</strong> (in-Page embed) code and paste it into a new HTML file.</li>
            </ol>
        </div>
				<h3>The player code</h3>
          <p>Your player code should look similar to the following:</p>
          <p class="video-cloud-only"><code data-gist-id="17b9c030dcb68e6229a5" data-gist-hide-footer="true" data-gist-line="28-38"></code></p>
          <p>Note that an <code>id</code> is added to the code. Since this code is for a playlist player, an HTML <code>&lt;ol&gt;</code> is also part of code and where the playlist appears.</p>
        <h3>Overlay plugin</h3>
        <p>Add the following to allow use of the Overlay plugin:</p>
        <ul>
          <li>In the &lt;head&gt; section: <code>&lt;link href=&quot;//players.brightcove.net/videojs-overlay/lib/videojs-overlay.css&quot; rel='stylesheet'&gt;</code></li>
          <li>Below the player's JavaScript <strong>index.min.js</strong> file: <code>&lt;script src=&quot;//players.brightcove.net/videojs-overlay/lib/videojs-overlay.js&quot;&gt;&lt;/script&gt;</code></li>
        </ul>
				<h3>The JavaScript code</h3>
				<p>Add the JavaScript shown in the block below to your page code. Key points in the code are detailed in the following bulleted list.</p>
        <ul>
          <li>Lines 42-46: Declare the script's variables. The duration of how long to display the overlay is set here.</li>
          <li>Lines 48-57: Listen for the player to be ready and adds the overlay. The content of the overlay at this point is meaningless since before the overlay is displayed appropriate content will be dynamically added.</li>
          <li>Lines 61-72: Code that needs to be executed once on the <code>loadedmetadata</code> event is dispatched. You cannot perform these tasks in the <code>ready</code> event as the playlist info is not available in the player info when only <code>ready</code>.</li>
          <li>Line 66: Setup an timer using JavaScript's <code>window.setInterval()</code> method. This will cause the <code>checkTime</code> function to be called every second.</li>
          <li>Line 68: Listen for the <code>loadedmetadata</code> event that is dispatched when a new video is loaded in the player, either by automatic playlist functionality or the user clicking on a video in the playlist. The called function removes the overlay.</li>
          <li>Line 70: Adds the <code>hide-overlay</code> class, which sets the overlay's CSS <code>display</code> property to <code>none</code>.</li>
          <li>Lines 75-104: Function called every one second.</li>
          <li>Lines 76,101-103: Checks if the video is paused, and if so does nothing.</li>
          <li>Lines 79-82: Calculates time remaining in video by getting the current video's duration and subtracting the video's current time.</li>
          <li>Lines 85-89: Assigns to a variable either the name of the next video in the playlist, or a note saying this is the last video in the playlist.</li>
          <li>Lines 93-100: If within the time the name should be displayed, assign the text to the overlay, and then remove the <code>hide-overlay</code> class so the name/message is displayed.</li>
          <li>Lines 97-99: If playing the last video, remove the interval using JavaScript's <code>window.clearInterval()</code> function so the function does not get called indefinitely.</li>
          <li>Lines 107-109: Function called when new video is placed in the player. This hides the overlay.</li>
        </ul>
        <p><code data-gist-id="17b9c030dcb68e6229a5" data-gist-hide-footer="true" data-gist-line="41-110"></code></p>
        <h3>The stylesheet</h3>
				<p>Add the following styles to your page code:</p>
        <ul>
          <li>Lines 8-18: Standard CSS to size player and playlist.</li>
          <li>Lines 19-21: CSS used to hide and show the overlay by adding and removing this class selector.</li>
        </ul>
        <p><code data-gist-id="17b9c030dcb68e6229a5" data-gist-hide-footer="true" data-gist-line="7-22"></code></p>
        <h3>Complete code</h3>
        <p>The entire HTML page when using the in-page embed implementation appears as follows:</p>
        <p><code data-gist-id="17b9c030dcb68e6229a5" data-gist-hide-footer="true" data-gist-line="1-113"></code></p>
			</div>

			<div id="plugin" class="section">
				<h2>Use a plugin</h2>
				<p>It is a best practice to use a plugin so that you can easily add the JavaScript code's functionality to multiple players.</p>
				<h3>Create the JavaScript file</h3>
				<p>Move the plugin's JavaScript code into a file and place it in an Internet accessible URL.</p>
				<ul>
				    <li>Lines 120,183: Use the standard syntax to begin and end a Brightcove Player plugin.</li>
				    <li>Line 120: The first argument of the function call is the name of the function defined in the plugin code, in this case <code>comingNextInPlaylist</code>.</li>
				    <li>Line 183: The trailing semicolon is required.</li>
				</ul>
        <p class="BCL-aside">Note: In a plugin's JavaScript it is not necessary to listen for the <code>ready</code> event.</p>
				<p><code data-gist-id="17b9c030dcb68e6229a5" data-gist-hide-footer="true" data-gist-line="120-183"></code></p>
				<h3>Create the CSS file</h3>
				<p>Move the appropriate styles into a file and place it in an Internet accessible URL.</p>
				<h3>Deploy plugin and CSS</h3>
        <p>To deploy the <code>comingNextInPlaylist</code> Plugin using the Players module, follow these steps:</p>
        <ol>
          <li>In Video Cloud Studio, open the <strong>Players</strong> module and locate the player.</li>
          <li>Click the link for the player to open the player properties.</li>
          <li>Locate the <strong>Plugins</strong> section and click <strong>Edit</strong>.</li>
          <li>For the <strong>JavaScript URL</strong>, enter the URL for the Overlay plugin's JavaScript AND the URL which specifies the location of where you saved your plugin's JavaScript.</li>
          <div><img src="/en/video-cloud/brightcove-player/samples/assets/coming-next-in-playlist/studio-plugins-js.png"></div>
          <li>For the <strong>CSS URL</strong>, enter the URL for the Overlay plugin's CSS AND the URL which specifies the location of where you saved your plugin's CSS.</li>
          <div><img src="/en/video-cloud/brightcove-player/samples/assets/coming-next-in-playlist/studio-plugins-css.png"></div>
          <li>For the <strong>Name</strong>, enter <strong>comingNextInPlaylist</strong>. Since there are no options, simply enter empty braces for that.</li>
          <div><img src="/en/video-cloud/brightcove-player/samples/assets/coming-next-in-playlist/studio-plugins-name-options.png"></div>
          </li>
          <li>Click <strong>Save</strong> and then <strong>Publish</strong> the player.</li>
        </ol>
			</div>

      <div id="useiframe" class="section">
        <h2>Use iframe</h2>
        <p>It is a best practice to use the iframe player implementation. Since you can create this functionality as a plugin, replace the embed_in_page implementation with the iframe implementation.</p>
				<p><code data-gist-id="17b9c030dcb68e6229a5" data-gist-hide-footer="true" data-gist-line="188-208" data-gist-highlight-line="204"></code></p>
      </div>

			<div class="section" id="BCLreferences">
				<h2>Related Topics</h2>
				<ul>
					<li> <a href="http://docs.brightcove.com/en/video-cloud/brightcove-player/guides/overlay-plugin.html">Display Overlay Plugin</a></li>
					<li> <a href="http://docs.brightcove.com/en/video-cloud/brightcove-player/guides/plugin-dev-quick-start.html">Quick Start to Plugin Development</a></li>
					<li> <a href="http://docs.brightcove.com/en/video-cloud/brightcove-player/guides/plugin-guide.html">Player Plugin Overview</a></li>
				</ul>
			</div>
		</div>
	</div>
	<!-- bcl scripts -->
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.2/gist-embed.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
	<script src="/en/scripts/log.js"></script>
	<script src="/en/scripts/docs-nav-data.min.js"></script>
	<script src="/en/scripts/bcls-doc-site-v1.js"></script>
	<script src="/en/scripts/bc-mapi.js"></script>
  <script src="/en/scripts/expander.js"></script>
	<script>
		$(document).foundation();
	</script>
  <script src="//players.brightcove.net/1752604059001/7a129b53-9225-4b32-8595-906f9f4eaea9_default/index.min.js"></script>

  <script src="//players.brightcove.net/videojs-overlay/lib/videojs-overlay.js"></script>
	<script type="text/javascript">
		/******** Any scripts specific to page samples should go here *********/
    var myPlayer,
      intervalID,
      playlistInfo,
      timeToDisplayOverlay = 5,
      lengthOfPlaylist = 0;

    videojs('myPlayerID').ready(function () {
      var myPlayer = this;
      // Add Overlay to player, which is hidden immediately
      myPlayer.overlay({
        overlays: [{
          content: '<h3>this is the overlay</h3>',
          start: 'play'
        }]
      });
    });

    // Wait for loadedmetatdata to get playlist info
    // Code in this block only performed once, hence one() method for the event listener
    videojs('myPlayerID').one('loadedmetadata', function () {
      myPlayer = this;
      playlistInfo = myPlayer.playlist();
      lengthOfPlaylist = playlistInfo.length;
      // Set interval to call function every one second
      intervalID = window.setInterval(checkTime, 1000);
      // Listen for every loadedmetatdata, which means a new video has been loaded in the player
      myPlayer.on('loadedmetadata', videoChanged);
      // Hide overlay on initial load of player
      myPlayer.addClass("hide-overlay");
    });

    // Function called every one second
    function checkTime() {
      if (!myPlayer.paused()) {

        // Calculate time remaining in video
        var currentVideoIndex = myPlayer.playlist.currentItem(),
          nextVideoIndex = currentVideoIndex + 1,
          currentVideoDuration = playlistInfo[currentVideoIndex].duration,
          timeRemaining = currentVideoDuration - myPlayer.currentTime();

        // Assign name of next video, or assign end of playlist note
        if (nextVideoIndex < lengthOfPlaylist) {
          nextVideoName = 'Next video in playlist: ' + playlistInfo[nextVideoIndex].name
        } else {
          nextVideoName = 'Last video in playlist'
        };

        // Display overlay with name or note if near end of video
        // Default time to display note is 5 seconds to end
        if (timeRemaining <= timeToDisplayOverlay) {
          var theDiv = document.getElementsByClassName("div.vjs-overlay");
          document.getElementsByClassName("vjs-overlay")[0].innerHTML =  nextVideoName;
          myPlayer.removeClass("hide-overlay");
          if (nextVideoIndex >= lengthOfPlaylist) {
            window.clearInterval(intervalID);
          };
        };
      } else {
        console.log('video paused');
      }
    }

    // If video changed, hide overlay
    function videoChanged() {
      myPlayer.addClass("hide-overlay");
    }
	</script>
	
    
<iframe id="CSAT" src="http://survey.clicktools.com/app/survey/go.jsp?iv=3poon3e7e9spn&q1=[articleURL]" style="margin-left:25%; padding-bottom:20px;width:550px;height:475px;border:none"></iframe>
<script>
    
    var cSat = document.getElementById('CSAT'),
        cSatSrc = cSat.getAttribute('src'),
        pageurl = window.location.href;
    cSat.setAttribute('src', cSatSrc.replace('[articleURL]', pageurl));
    
</script>
<br><br>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>

</html>
