<!DOCTYPE html>
<html lang="en">

<head>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
  <!-- change title to match the h1 heading -->
  <title>Brightcove Player Sample: Loading the Player Dynamically</title>
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
  <script src="//use.edgefonts.net/source-code-pro.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

  <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

  <!-- Page styles -->
	<style id="pageStyles">
    #myPlayer {
      width: 640px;
      height: 360px;
    }
	</style>
</head>

<body>
    <!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
  <!-- search -->
  <div id="searchModal" class="reveal-modal" data-reveal></div>
  <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
      <div id="top" class="section">
        <h1>Brightcove Player Sample: Loading the Player Dynamically</h1>
        <p>This topic describes how to load the Brightcove player dynamically, that is, on a user event and NOT in the startup HTML. In the working example here you can click the <strong>Add Player</strong> button to dynamically load the player and play a video.</p>
        <p>Three approaches are taken to perform the task. Fist an <code>iframe</code> tag is dynamically built. Next, in-page embed code is dynamically built. Lastly, the <code>bc()</code> method is used. The <code>bc()</code> method is essential when you need to load the player specific JavaScript before the video element is added to the DOM.</p>
      </div>

      <div id="resources" class="section">
        <h2>API resources used</h2>
        <ul>
          <li><code>videojs()</code> method: Creates an instance of the player</li>
        </ul>
      </div>

      <div id="player" class="section">
        <h2>The player</h2>
        <p>Select the <strong>Add Player</strong> button to dynamically load the player with its associated video. Notice that the video starts playing automatically.</p>

            <div id="placeHolder" style="background-color:#64AAB2;width:640px;height:360px;text-align: center;">
                <button onclick="addPlayer()">Add Player</button>
            </div>

      </div><!-- class="section" -->

      <div id="code" class="section">
        <h2>How it works</h2>
        <p>In the following two sections you will see how to use JavaScript and CSS to dynamically build the standard code used for in-page embed and iframe implementations of Brightcove Player.</p>
        <p>It is assumed you have created a Brightcove Player using Studio.</p>
      </div>

      <div id="iframe" class="section video-cloud-only">
        <h2>iframe code</h2>
        <p></p>
      <p>The following sections explain the player, JavaScript and CSS code used in the example.</p>
        <h3>The player code</h3>
        <p>The player code is simply the code for the iframe implementation displayed when the player is published.</p>
        <p class="BCL-aside">Note: This code does not initially reside in the HTML page, but is generated dynamically when the user selects the <strong>Add Player</strong> button.</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="2" data-gist-hide-footer="true"></code></p>

        <h3><a name="HTMLCode"></a>The HTML code</h3>
            <p>The following HTML is used to target where the dynamically created player will be injected:</p>
          <ul>
            <li>Lines 23,25: Define the container where the player will by dynamically added.</li>
            <li>Line 24: Defines the button that when selected adds the player to the page.</li>
          </ul>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="23-25" data-gist-hide-footer="true"></code></p>

        <h3><a name="JSCode"></a>The JavaScript code</h3>

        <p>The JavaScript used will define the variables, create the player code and inject it into the HTML page.</p>
        <ol>
          <li>Lines 28-34: Define the variables for the script.</li>
          <li>Line 38: The <code>accountId</code>, <code>playerId</code> and <code>videoId</code> fields are used to dynamically create the player code.</li>
          <li>Line 41: Dynamically add the player code to your HTML page. The <code>iframe</code> element is built and injected into the HTML page.</li>
        </ol>
    <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="27-43"  data-gist-hide-footer="true"></code></p>

        <h3><a name="CSSCode"></a>The stylesheet</h3>
          <p>This example uses CSS styles for the Brightcove player.</p>
        <ul>
          <li>Lines 15-18: Set the dimensions of the <code>iframe</code> element.</li>
        </ul>
          <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="14-19"  data-gist-hide-footer="true"></code></p>
        <h3><a name="completecode"></a>The complete code</h3>
        <p>Your page should look similar to this:</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="8-46"  data-gist-hide-footer="true"></code></p>
      </div>

      <div id="iframeperform" class="section perform-only">
        <h2>iframe code</h2>
        <p></p>
      <p>The following sections explain the player, JavaScript and CSS code used in the example.</p>
        <h3>The player code</h3>
        <p>The player code will use a plugin which reads the video type and source URL as query parameters. You could make this implementation much simpler by simply assigning a video to the player in <code>Perform Studio > Players > Video Content</code> section, but the goal in this document is to allow the video content to be set programmatically. In the code below you will see the query parameters <code>videoType</code> and <code>videoURL</code>. <strong>These are NOT normal parameters you can use with the iframe implementation, but functional because of the plugin detailed in this section.</strong> Note that the values assigned to these parameters must be URL encoded to be part of the URL address.</p>
        <p class="BCL-aside">Note: This code does not initially reside in the HTML page, but is generated dynamically when the user selects the <strong>Add Player</strong> button.</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="116" data-gist-hide-footer="true"></code></p>

        <h3><a name="HTMLCode"></a>The HTML code</h3>
            <p>The following HTML is used to target where the dynamically created player will be injected:</p>
          <ul>
            <li>Lines 165,167: Define the container where the player will by dynamically added.</li>
            <li>Line 166: Defines the button that when selected adds the player to the page.</li>
          </ul>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="165-167" data-gist-hide-footer="true"></code></p>

        <h3><a name="JSCode"></a>The JavaScript code</h3>

        <p>The JavaScript used will define the variables, create the player code and inject it into the HTML page. This JavaScript sits in the HTML page in a <code>&lt;script&gt;</code> block.</p>
        <ol>
          <li>Lines 171-178: Define the variables for the script. Note that the <code>encodedVideoURL</code> and <code>encodedVideoType</code> variables' values must be in URL encoded format.</li>
          <li>Lines 180-186: Define the function called by the button click.</li>
          <li>Line 182: The <code>accountId</code>, <code>playerId</code> fields, along with the variables with URL encoded values, are used to dynamically create the player code.</li>
          <li>Line 185: Dynamically add the player code to your HTML page. The <code>iframe</code> element is built and injected into the HTML page.</li>
        </ol>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="170-187"  data-gist-hide-footer="true"></code></p>
        <p>A player plugin is need to perform the following tasks:</p>
        <ul>
          <li>Read the query parameters' values from the iframe's URL.</li>
          <li>Use those values to assign a video to the player.</li>
          <li>Play the video.</li>
        </ul>
        <ol>
          <li>Lines 121,143: Standard code to define a Brightcove Player plugin. In this case the name of the plugin is <strong>dynamicLoad</strong>.</li>
          <li>Lines 135-142: A function that retrieves the value from a URL. The parameter passed to the function is the name of the query parameter for which the value is retrieved.</li>
          <li>Line 122: Creates a variable for the player instance.</li>
          <li>Lines 123-124: Assigns variables the values of the query parameters using the aforementioned function.</li>
          <li>Lines 126-131: Assigns a video source to the player.</li>
          <li>Line 133: Plays the video.</li>
        </ol>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="121-143"  data-gist-hide-footer="true"></code></p>
        <p>This plugin needs to be associated with the appropriate player using Perform Studio.</p>


        <h3><a name="CSSCode"></a>The stylesheet</h3>
          <p>This example uses CSS styles for the Brightcove player.</p>
        <ul>
          <li>Lines 156-159: Set the dimensions of the <code>iframe</code> element.</li>
        </ul>
          <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="155-160"  data-gist-hide-footer="true"></code></p>
        <h3><a name="completecode"></a>The complete code</h3>
        <p>Your page should look similar to this:</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="149-190"  data-gist-hide-footer="true"></code></p>
      </div>

      <div id="useembedinpagevc" class="section video-cloud-only">
        <h2>in-page embed code</h2>
        <p>It is a best practice to use the iframe player implementation as shown above. If you want to get a reference to the player to control it, you can use the in-page embed implementation.</p>

        <h3>The player code</h3>
        <p>In this case, you will use the in-page embed implementation displayed when the player is published.</p>
        <p class="BCL-aside">Note: This code does not initially reside in the HTML page, but is generated dynamically when the user selects the <strong>Add Player</strong> button.</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="51-57"  data-gist-hide-footer="true"></code></p>

        <h3><a name="JSCode"></a>The JavaScript code</h3>
        <p>In this JavaScript code you will perform the following tasks:
        <ul>
            <li>Define the variables.</li>
            <li>Create the player code.</li>
            <li>Inject it into the HTML page.</li>
            <li>Create the appropriate script block and assign the appropriate source.</li>
            <li>Append the dynamically create script to the page.</li>
            <li>On the load of the script, which happens automatically with the append, call a function to instantiate the player and play the video.</li>
        </ul>
        <ol>
          <li>Lines 84-90: Define the variables for the script. The <code>accountId</code>, <code>playerId</code> and <code>videoId</code> fields are used to dynamically create the player code.</li>
          <li>Line 94: Build the <code>video</code> element.</li>
          <li>Lines 96: Dynamically add the player code, in this case the <code>video</code> element, to the HTML page.</li>
          <li>Lines 98-99: Create the <code>script</code> element, and set its <code>src</code></li>
          <li>Line 100: Adds the script using the <code>appendChild()</code> method, which also runs the script.</li>
          <li>Line 101: On the load of the script, call the <code>callback</code> function.</li>
          <li>Lines 104-107: In the function, create an instance of the player using the <code>videojs</code> method, and play the video.</li>
        </ol>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="83-108"  data-gist-hide-footer="true"></code></p>
        <p>For this embed version, it will not work with IE 10 and below in fullscreen. This is because fullscreen opens the page in a new window, and the player hasn’t been added to this new page. Use the following to surround the call to the <code>addPlayer()</code> function to correct this issue. The small timeout is necessary as the window name isn’t set immediately.</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="267-273"  data-gist-hide-footer="true"></code></p>

        <h3><a name="completecode"></a>The complete code</h3>
        <p>Your page should look similar to this:</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="63-111"  data-gist-hide-footer="true"></code></p>

      </div>

      <div id="useembedinpagep" class="section perform-only">
        <h2>in-page embed code</h2>
        <p>It is a best practice to use the iframe player implementation as shown above. If you want to get a reference to the player to control it, you can use the in-page embed implementation.</p>

        <h3>The player code</h3>
        <p>In this case, you will use the in-page embed implementation displayed when the player is published.</p>
        <p class="BCL-aside">Note: This code does not initially reside in the HTML page, but is generated dynamically when the user selects the <strong>Add Player</strong> button.</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="196-201"  data-gist-hide-footer="true"></code></p>

        <h3><a name="JSCode"></a>The JavaScript code</h3>
        <p>In this JavaScript code you will perform the following tasks:
        <ul>
            <li>Define the variables.</li>
            <li>Create the player code.</li>
            <li>Inject it into the HTML page.</li>
            <li>Create the appropriate script block and assign the appropriate source</li>
            <li>Append the dynamically create script to the page.</li>
            <li>On the load of the script, which happens automatically with the append, call a function to instantiate the player, set the video source, and play the video.</li>
        </ul>
        <ol>
          <li>Lines 229-234: Define the variables for the script. The <code>accountId</code> and <code>playerId</code> fields are used to dynamically create the player code.</li>
          <li>Line 238: Build the <code>video</code> element.</li>
          <li>Lines 240: Dynamically add the player code, in this case the <code>video</code> element, to the HTML page.</li>
          <li>Lines 242-243: Create the <code>script</code> element, and set its <code>src</code>.</li>
          <li>Line 244: Adds the script using the <code>appendChild()</code> method, which also runs the script.</li>
          <li>Line 245: On the load of the script, call the <code>callback</code> function.</li>
          <li>Line 249: In the function, create an instance of the player using the <code>videojs</code> method.</li>
          <li>Lines 250-253: In the function, set the source of the video.</li>
          <li>Lines 254: In the function, play the video.</li>
        </ol>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="228-256"  data-gist-hide-footer="true"></code></p>
        <p>For this embed version, it will not work with IE 10 and below in fullscreen. This is because fullscreen opens the page in a new window, and the player hasn’t been added to this new page. Use the following to surround the call to the <code>addPlayer()</code> function to correct this issue. The small timeout is necessary as the window name isn’t set immediately.</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="267-273"  data-gist-hide-footer="true"></code></p>
        <h3><a name="completecode"></a>The complete code</h3>
        <p>Your page should look similar to this:</p>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="208-259"  data-gist-hide-footer="true"></code></p>
      </div>
      <div id="bcmethod" class="section">
        <h2>Use the bc() method</h2>
        <p>There are times where you will want to the use the <code>bc()</code> method to dynamically instantiate the player rather than the method show above. You will want to use the <code>bc()</code> method when you wish to load the player's JavaScript before the video element is loaded into the DOM. If you use the <code>videojs()</code> method NOT in conjunction with <code>bc()</code>, you will get the Video.js player, but without the customizations that are added by Brightcove Player.</p>
        <p>To use the <code>bc()</code> method follow this general approach:</p>
        <ul>
          <li>Load the player's script. That is, the specific <strong>index.min.js</strong> file for a player.</li>
          <li>Dynamically build and inject the video object into the page.</li>
          <li>Use the <code>bc()</code> method.</li>
          <li>Use the <code>videojs()</code> method.</li>
        </ul>
        <p>The code below executes the general steps:</p>
        <ul>
          <li>Lines 280-282: Creates an insertion point for the player, also displays the button to call the function which dynamically loads the player.</li>
          <li>Line 284: Loads the JavaScript specific to a Brightcove Player.</li>
          <li>Lines 286-292: Creates variables for use in the code, specifically data which will be inserted when the <code>video</code> tag is dynamically created.</li>
          <li>Lines 294,304: Defines the function called on button click.</li>
          <li>Line 296: Dynamically builds the specific <code>video</code> tag.</li>
          <li>Line 298: Inject the newly created tag into the DOM.</li>
          <li>Line 300: Use the <code>bc()</code> method to initialize the Brightcove Player. Note that the method does NOT take a player ID, rather the player element itself.</li>
          <li>Line 301-303: Use the <code>videojs()</code> method to create a player instance from the Brightcove Player, identified by its ID.</li>
        </ul>
        <p><code data-gist-id="06c0f61aa0c21ad924a4" data-gist-line="280-305"  data-gist-hide-footer="true"></code></p>
      </div>
    </div>
  </div>
  <!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.2/gist-embed.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
  <script src="/en/scripts/log.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site-v1.js"></script>
  <script src="/en/scripts/bc-mapi.js"></script>
  <script src="/en/scripts/expander.js"></script>
  <script>
      $(document).foundation();
  </script>
  <script type="text/JavaScript">
    var myPlayer,
      playerHTML,
      playerData = {
        'accountId': '1752604059001',
        'playerId': '04ee9f58-9d08-43ea-803f-abda86776db2',
        'videoId': '4172255216001'
      };

    function addPlayer() {
      // dynamically build the player video element
      playerHTML = '<video id=\"myPlayer\" data-video-id=\"' + playerData.videoId + '\"  data-account=\"' + playerData.accountId + '\" data-player=\"' + playerData.playerId + '\" data-embed=\"default\" class=\"video-js\" controls></video>';
      // inject the player code into the DOM
      document.getElementById('placeHolder').innerHTML = playerHTML;
      // add and execute the player script tag
      var s = document.createElement('script');
      s.src = "//players.brightcove.net/" + playerData.accountId + "/" + playerData.playerId + "_default/index.min.js";
      document.body.appendChild(s);
      s.onload = callback;
    }

    function callback() {
      myPlayer = videojs('myPlayer');
      myPlayer.play();
    }
  </script>

    <div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
    <script>
	var feedbackMail = document.getElementById("feedbackMail");
	feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
	</script>
	</body>

</html>
