<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
	<!-- change title to match the h1 heading -->
	<title>Brightcove Player SDK for iOS: Code Snippets</title>
	<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
	<script src="//use.edgefonts.net/source-code-pro.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css" />
    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">
  
  <!--Page styles-->
  <style>
    	.bcls-question {
        	color: #2346b7;
        	cursor: pointer;
        	font-size: 1.15em;
          padding-top: 0;
          line-height: .5em;
    	}
    	.bcls-question:hover {
        	text-decoration: underline;
    	}
    	.bcls-answer {
        	display: none;
    	}
		a code {
			text-decoration: none;  
		}
	</style>

	<script>

	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<!-- content -->
	<div class="row">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav" class="side-nav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<div id="top" class="section">
				<h1>Brightcove Player SDK for iOS: Code Snippets</h1>
						<p>This topic contains a collection of code snippets which you may find useful as a reference while developing with the SDK. For more detailed solutions, see the <a href="https://github.com/BrightcoveOS/ios-player-samples">iOS player samples</a>.</p>
						<h3>Table of contents</h3>
        
						<h3 class="bcls-question">Advertising</h3>
						<ul class="bcls-answer">
							<li><a href="#Media_progress_values">Media progress values</a></li>
						</ul>
        
						<h3 class="bcls-question">Analytics</h3>
						<ul class="bcls-answer">
							<li><a href="#Google_Analytics">Google Analytics</a></li>
						</ul>
        
<!--
                <h3 class="bcls-question">Captions</h3>
                <ul class="bcls-answer">
                </ul>
-->
        
<!--
                <h3 class="bcls-question">Concepts</h3>
                <ul class="bcls-answer">          
                </ul>
-->
        
<!--
                <h3 class="bcls-question">Content security (DRM)</h3>
                <ul class="bcls-answer">        
                </ul>
-->
					<h3 class="bcls-question">Cue points</h3>
						<ul class="bcls-answer">
						  <li><a href="#Programmatically_adding_cue_points">Programmatically adding cue points</a></li>
						</ul>
        
<!--
				<h3 class="bcls-question">Live streams</h3>
                <ul class="bcls-answer">          
                </ul>
-->
				
<!--
                <h3 class="bcls-question">Player controls</h3>
                <ul class="bcls-answer">
                </ul>
-->
				
<!--
				<h3 class="bcls-question">Playlists</h3>
                <ul class="bcls-answer">           
                </ul>
-->
        
						<h3 class="bcls-question">Media content</h3>
						<ul class="bcls-answer">
						  <li><a href="#Limiting_the_bitrate">Limiting the bitrate</a></li>
							<li><a href="#Looping_a_video">Looping a video</a></li>
							<li><a href="#Media_progress_values">Media progress values</a></li>
							<li><a href="#Setting_the_buffer_size">Setting the buffer size</a></li>
							<li><a href="#Setting_the_playback_rate">Setting the playback rate</a></li>
						</ul>
                
			</div>
			
			<div id="Google_Analytics" class="section">
        <h2>Google Analytics</h2>
					<p>If you use the Brightcove player and the catalog class, video analytics will be automatically collected and will appear in your Video Cloud Analytics module. For additional metrics, you can add Google Analytics to your app.</p>
					<p>To integrate Google Analytics with your app, follow these steps:</p>
				  <ol>
						<li><p>In your project Podfile, add the following dependency:</p>
						<p><a href="https://developers.google.com/analytics/devguides/collection/ios/v3/#get-config"><code data-gist-id="e31445438f3a98f54a67" data-gist-hide-footer="true" data-gist-line="29" data-gist-hide-line-numbers="true"></code></a></p></li>
						<li>Get a Google configuration file and add it to your project.</li>
						<li><p>Initialize analytics for your app:</p>
						<p><a href="https://developers.google.com/analytics/devguides/collection/ios/v3/#get-config"><code data-gist-id="e31445438f3a98f54a67" data-gist-hide-footer="true" data-gist-line="32-43" data-gist-hide-line-numbers="true"></code></a></p></li>
						<li><p>Send screen view to analytcis:</p>
						<p><a href="https://developers.google.com/analytics/devguides/collection/ios/v3/#get-config"><code data-gist-id="e31445438f3a98f54a67" data-gist-hide-footer="true" data-gist-line="46-51" data-gist-hide-line-numbers="true"></code></a></p></li>
				  </ol>
				  <p>For detailed steps, see Google's document to <a href="https://developers.google.com/analytics/devguides/collection/ios/v3/#get-config">Add Analytics to Your iOS App</a>.</p>
      </div>
			
			<div id="Limiting_the_bitrate" class="section">
        <h2>Limiting the bitrate</h2>
					<p>You can't control which rendition in the HLS manifest gets selected by the <code>AVPlayer</code>, but you can put a bitrate cap on playback. This prevents the player from using renditions with a bitrate over the specified bitrate.</p>
					<p>Set the <code>preferredPeakBitRate</code> to the desired limit, in bits per second, of the network bandwidth consumption for the given <code>AVPlayerItem</code>.</p>
					<p>Use one of the following declarations:</p>
					<p><a href="https://developer.apple.com/library/prerelease/mac/documentation/AVFoundation/Reference/AVPlayerItem_Class/index.html#//apple_ref/occ/instp/AVPlayerItem/preferredPeakBitRate"><code data-gist-id="e31445438f3a98f54a67" data-gist-hide-footer="true" data-gist-line="18-22"></code></a></p>
				
			<div id="Looping_a_video" class="section">
				<h2>Looping a video</h2>
					<p>In some cases, you may want a video to automatically replay. To do this, you can get the "end of video" lifecycle event, seek to the beginning and play again.</p>
					<p>This code assumes that you have set the delegate of the playbackController to the object with this method:</p>
					<p><a href="../reference/current/Classes/BCOVPlaybackSessionLifecycleEvent.html"><code data-gist-id="e31445438f3a98f54a67" data-gist-line="1-12" data-gist-hide-line-numbers="true"></code></a></p>       
      </div>
				
			<div id="Media_progress_values" class="section">
        <h2>Media progress values</h2>
					<p>During media playback, the values reported to the Player SDK progress delegate method may include an initial value of negative infinity and a final value of positive infinity. These values are used when processing pre-roll and post-roll ads.</p>
				  <p>If these values are not important to you or interfere with your own progress tracking, they can be easily ignored with a conditional statement like this:</p>
					<p><a href="../reference/current/Protocols/BCOVPlaybackControllerBasicDelegate.html#//api/name/playbackController:playbackSession:didProgressTo:"><code data-gist-id="e31445438f3a98f54a67" data-gist-line="109-115" data-gist-hide-line-numbers="true"></code></a></p>
					<p></p>
      </div>
				
			<div id="Programmatically_adding_cue_points" class="section">
        <h2>Programmatically adding cue points</h2>
					<p class="video-cloud-only">You can add cue points to your video using Video Cloud Studio as shown in the <a href="//support.brightcove.com/en/video-cloud/docs/adding-cue-points-videos">Adding Cue Points to Videos</a> document.</p>
					<p><span class="video-cloud-only">You can also add</span><span class="perform-only">You can add</span> cue points to your video programmatically. The code below adds quarterly interval cue points to the video returned from the Playback API:</p>
					<p><a href="../reference/current/Protocols/BCOVVideo.html#//api/name/update:"><code data-gist-id="e31445438f3a98f54a67" data-gist-line="58-93" data-gist-hide-footer="true" data-gist-highlight-line="65-83" data-gist-hide-line-numbers="true"></code></a></p>
					<p></p>
					<p>The code below listens for your cue points and displays a message:</p>
					<p><a href="../reference/current/Protocols/BCOVCuePoint.html"><code data-gist-id="e31445438f3a98f54a67" data-gist-line="95-104" data-gist-hide-line-numbers="true" ></code></a></p>
					<p></p>
      </div>
				
			<div id="Setting_the_buffer_size" class="section">
				<h2>Setting the buffer size</h2>
				<p>You may consider increasing the buffer length to eliminate buffering in the player if the delivery of the next segment is delayed from the CDN. But, you may not be able to do anything better manually that HLS already does.</p>
<!--				<p>The <code>AVPlayer</code> contains the <code>AVPlayerItem</code>, essentially the video being played, that contains the <code>loadedTimeRanges</code> property. This tells you how much is buffered.</p>-->
				<p>HLS is designed to play right away and drop quality if it can't keep up. This way, it does not need to preload a buffer. If it can't keep up, it will load as much of the video as it can at the best quality to prevent interruption.</p>     
      </div>
			
			<div id="Setting_the_playback_rate" class="section">
				<h2>Setting the playback rate</h2>
				<p>To control the playback rate, you can set the <code>rate</code> property on the <code>AVPlayer</code> class exposed on the session. For a <code>BCOVPlaybackSession</code>, you could do something like this:</p>
				<p><a href="../reference/current/Protocols/BCOVPlaybackSession.html"><code data-gist-id="e31445438f3a98f54a67" data-gist-line="55" data-gist-hide-footer="true" data-gist-hide-line-numbers="true" ></code></a></p>
				<p>Note the following:</p>
				<ul>
					<li>For iOS6, a stream can only play at 2X if <code>session.player.currentItem.canPlayFastForward</code> returns <strong>YES</strong>.</li>
					<li>For iOS7, you can play up to 2X always, but it won't go higher unless <code>session.player.currentItem.canPlayFastForward</code> returns <strong>Yes</strong>.</li>
				</ul>
				<p class="BCL-aside">For more information about managing playback, see Apple's <a href="https://developer.apple.com/library/ios/documentation/AVFoundation/Reference/AVPlayer_Class/index.html#//apple_ref/occ/instp/AVPlayer/rate">AVPlayer Class Reference</a>.</p>	     
      </div>
      
		</div>
	</div>
	<!-- bcl scripts -->
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.2/gist-embed.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.3/fastclick.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
	<script src="/en/scripts/log.js"></script>
	<script src="/en/scripts/docs-nav-data.min.js"></script>
	<script src="/en/scripts/bcls-doc-site.js"></script>
  <script src="/en/scripts/bclsfaq.js"></script>
	<script>
		$(document).foundation();
	</script>
	<script type="text/javascript">
		/******** Any scripts specific to page samples should go here *********/
	</script>
	
    
<iframe id="CSAT" src="http://survey.clicktools.com/app/survey/go.jsp?iv=3poon3e7e9spn&q1=[articleURL]" style="margin-left:25%; padding-bottom:20px;width:550px;height:475px;border:none"></iframe>
<script>
    
    var cSat = document.getElementById('CSAT'),
        cSatSrc = cSat.getAttribute('src'),
        pageurl = window.location.href;
    cSat.setAttribute('src', cSatSrc.replace('[articleURL]', pageurl));
    
</script>
<br><br>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>

</html>
