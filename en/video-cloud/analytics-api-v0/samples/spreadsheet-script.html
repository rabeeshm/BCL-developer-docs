<!DOCTYPE html>
<html lang="en">
  <head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <title id="bclPageTitle">
      Google Spreadsheet Script
    </title>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css" />
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
  </head>

  <body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
    <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
        <h1>Google Spreadsheet Script</h1>
        <div id="top" class="section">
        <p class="BCL-objective">This sample shows you how to use a Google Apps Script to populate a Google spreadsheet with your data from the Brightcove Analytics API - and in this case we also add additional video data using the <a href="//docs.brightcove.com/en/video-cloud/media/index.html">Media API</a>, but that is not required. Google Apps Script is a cloud scripting language based on JavaScript which allows you to automate tasks between Google products and third party services.</p>
		<p>For more details about interacting with Google spreadsheets, read about <a href="https://developers.google.com/apps-script/">Google Apps Script</a> and <a href="https://developers.google.com/apps-script/guides/sheets#writing">Writing Data from JavaScript Objects to a Spreadsheet</a>.</p><!--break-->
		<p>To automate the process of adding your Brightcove Analytics data to a Google spreadsheet you can use a Google App Script. Just follow these steps:</p>
			<ol>
				<li>Create a blank Google spreadsheet</li>
				<li>Add a Google Apps Script to your spreadsheet</li>
				<li>Edit the script to pull data from your account using the Brightcove Analytics API</li>
				<li>Run the script</li>
			</ol>
        </div>
        <div id="results" class="section">
        <h2><a name="results"></a>Results</h2>
        <p>Below is the Google spreadsheet after running the script to populate it with Brightcove Analytics data. In the script, we retrieved the video analytics data from our account for the past week. Then we created a new sheet, formatted the column headers and populated the rows with the response data. </p>
		<img src="/en/video-cloud/analytics-api-v0/samples/assets/spreadsheet-sample-data.png">
        </div>

        <div id="details" class="section">
        <h2><a name="details"></a>Detailed Steps</h2>
        <p>Here are the details to populate your Google spreadsheet with data from the Brightcove Analytics API.</p>
		<ol>
			<li>In Google Drive, create a new spreadsheet and give it a title.</li>
			<li>In your spreadsheet, open the script editor (<strong>Tools > Script editor...</strong>).</li>
			<div><img src="/en/video-cloud/analytics-api-v0/samples/assets/spreadsheet-script/apps-script3.png"></div>
			<li>In the <strong>Google Apps Script</strong> dialog, in the <strong>Create Script for</strong> section, select the <strong>Blank Project</strong> option.</li>
			<div><img src="/en/video-cloud/analytics-api-v0/samples/assets/spreadsheet-script/apps-script4.png"></div>
			<li>Name the untitled script project. In this case, we have named it <strong>bcls data</strong>.</li>
			<li>In your Google Apps Script, delete any default code that may be there.</li>
			<li>
                <p>Copy the following JavaScript code or download the code from <a href="https://gist.github.com/bcls/8965294">here</a>. Then, paste it into your Google Apps Script. We'll review this code in detail in the next section.</p>
                <p>
                    <code data-gist-id="8965294" data-gist-hide-footer="true"></code>
                </p>
            </li>
			<li>Save the script.</li>
            <li>
                <p>Select <strong>Run &gt; fetchData</strong> in the Script Editor menu to run the script.</p>
                <p>
                    <img src="/en/video-cloud/analytics-api-v0/samples/assets/run-script.png" alt="run script" />
                </p>
            </li>
			<!-- <li>Save your script. Return to your spreadsheet and open the Script Manager (<strong>Tools > Script manager...</strong>)</li>
			<li>In the <strong>Script Manager</strong> dialog, select your script and run it.</li>
			<div><img src="/en/video-cloud/analytics-api-v0/samples/assets/spreadsheet-script/apps-script5.png"></div> -->
			<li>If an <strong>Authorization Required</strong> dialog appears, select <strong>OK</strong> and then <strong>Accept</strong>. This will allow your script to connect to an external source and update your spreadsheet.</li>
			<li>You should see the video analytics data now populated in your spreadsheet.</li>
		</ol>
        </div>

        <div id="code" class="section">
          <h2><a name="code"></a>The Code</h2>
          <p>First, we define the account id and authorization token.</p>
          <p>Since we are adding additional data using the Media API, we also define the Media API Read token.</p>
		  <p>Your account id can be found when you log into Video Cloud. This is the publisher id on the home page.</p>
		  <p>If your account has been enabled for the Analytics API, your authorization token was emailed to the account administrator when you joined the <strong>limited availability</strong> program. The Media API tokens are found in your Account Settings, under API Management.</p>
		  <code data-gist-id="8965294" data-gist-line="1-3" data-gist-hide-footer="true"></code>
		  <p>Next, we define the time period to limit the amount of response data. In this example, we are returning video metrics for one week.</p>
		  <code data-gist-id="8965294" data-gist-line="4-6" data-gist-hide-footer="true"></code>
		  <p>Here, we build the URL and header for the RESTful call to the Brightcove Analytics API. This call returns the video metric data in our account for one week. Refer to the <a href="//docs.analytics2.apiary.io/">Analytics API Reference</a> document to learn more about how to retrieve data for your Video Cloud videos and players.</p>
		  <code data-gist-id="8965294" data-gist-line="8-13" data-gist-hide-footer="true"></code>
		  <p>In the <code>fetchData()</code> function, we do the following:</p>
		  <ol>
			  <li>Assign and format the response data from the Analytics API.</li>
              <li>
                  Loop through the data items, and for each one make a <code>find_video_by_id</code> call to the Media API to retrieve the following additional video information:
                  <ul>
                      <li><code>name</code> (in case the video_name is missing from the analytics data, we insert the value from the Media API)</li>
                      <li><code>referenceId</code></li>
                      <li><code>publishedDate</code></li>
                      <li><code>tags</code></li>
                  </ul>
              </li>
			  <li>Create a new sheet in our Google spreadsheet.</li>
			  <li>Define and set the header names for our table.</li>
			  <li>Populate the table rows with the combined data from the Analytics and Media API calls.</li>
		  </ol>
		  <code data-gist-id="8965294" data-gist-line="15-36" data-gist-hide-footer="true"></code>
        </div>
		<div class="section" id="BCLreferences">
          <h2>Related topics</h2>
          <ul>
            <li><a href="//docs.analytics2.apiary.io/">Analytics API Reference</a></li>
            <li><a href="//docs.brightcove.com/en/video-cloud/analytics-api-v0/guides/api-overview.html">Analytics API Overview</a></li>
            <li><a href="//docs.brightcove.com/en/video-cloud/analytics-api-v0/guides/quick-start.html">Video Cloud Analytics API Quick Start</a></li>
            <li><a href="//docs.brightcove.com/en/video-cloud/media/index.html">Media API</a></li>
            <li><a href="https://developers.google.com/apps-script/">Google Apps Scripts</a></li>
			<li><a href="https://developers.google.com/apps-script/guides/sheets#writing">Writing Data from JavaScript Objects to a Spreadsheet</a></li>

          </ul>
        </div>

      </div>
    </div>
    <!-- bcl scripts -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.2/gist-embed.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
    <script src="/en/scripts/docs-nav-data.min.js"></script>
    <script src="/en/scripts/bcls-doc-site.js"></script>
    <script src="/en/scripts/format_json.js"></script>
    <script src="/en/scripts/prefix.js"></script>
    <script>
        $(document).foundation();
    </script>

	    
    
	<iframe width="550" height="475" frameborder="0" src="
http://survey.clicktools.com/app/survey/go.jsp?iv=3poon3e7e9spn&q1=
[articleURL]" style="margin-left:25%; padding-bottom:20px;"></iframe>
<br><br>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>
</html>
