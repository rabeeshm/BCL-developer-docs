<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <!-- change title to match the h1 heading -->
    <title id="bclPageTitle">Smart Player API Samples: Basic Setup</title>
    <link href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" rel="stylesheet" type="text/css" />
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

    <link href="/en/video-cloud/smart-player-api/samples/css/api-samples.css" rel="stylesheet" type="text/css">
    <style id="pageStyles">
      #progressBar {
        background-color:#64AAB2;
      }
    </style>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
  </head>
  <body>
  <!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
  <!-- search -->
  <div id="searchModal" class="reveal-modal" data-reveal></div>
  <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
        <div id="top" class="section">
            <h1 id="bclPageHeading">Smart Player API Samples: Basic Setup</h1>
          <p>This example shows the basic setup for working with the Smart Player API, including:</p>
          <ul>
            <li>Adding <code>params</code> required in the player publishing code to include the API and specify handlers for initial player events</li>
            <li>Getting a reference to the BrightcoveExperience object when the player loads</li>
            <li>Getting references to API modules</li>
            <li>Calling an API module method and handling the results</li>
            <li>Adding an event listener and setting up a handler for the event</li>
            <li>Removing an event listener</li>
          </ul>
          <p>For a detailed explanation of this sample, see the <a href="/en/video-cloud/smart-player-api/guides/quick-start.html">Getting Started Guide</a>.</p>
        </div>
        <!-- every div class section must have an id -->
        <div class="section" id="resources">
          <h2><a name="resources"></a>API resources used</h2>
          <p>This sample uses the following API resources</p>
          <h4>Modules and methods</h4>
          <ul>
            <li>VIDEO_PLAYER
              <ul>
                <li>getCurrentVideo()</li>
                <li>addEventListener()</li>
                <li>removeEventListener()</li>
              </ul>
            </li>
          </ul>
          <h4>Events</h4>
          <ul>
            <li>templateLoad</li>
            <li>templateReady</li>
            <li>Media: PROGRESS</li>
          </ul>
        </div>
        <div class="section" id="player">
          <!-- h2 contents will be in page navigation label - 21 characters (including spaces) maximum -->
          <h2><a name="player"></a>The player</h2>
          <p>A standard Chromeless Video Player is used for this sample.</p>
          <p class="text-warning">Note: the buttons below are for development purposes only &mdash; do not use in production.</p>
          <div id="modeSwitch">
            <span class="button" id="switchToHTML5" style="margin-bottom: 20px;margin-right: 10px;">Switch to HTML5 Player</span>
            <span class="button" id="switchToFlash" style="margin-bottom: 20px;">Switch to Flash Player</span>
          </div>
          <div class="player-block">
            <!-- Start of Brightcove Player -->
            <script language="JavaScript" type="text/javascript" src="//sadmin.brightcove.com/js/BrightcoveExperiences.js"></script>

            <object id="myExperience" class="BrightcoveExperience">
                <param name="bgcolor" value="#FFFFFF" />
                <param name="width" value="860" />
                <param name="height" value="400" />
                <param name="playerID" value="2667922529001" />
                <param name="playerKey" value="AQ~~,AAAA1oy1bvE~,ALl2ezBj3WFvZPnJHJes3hV5LyW3yECp" />
                <param name="isVid" value="true" />
                <param name="isUI" value="true" />
                <param name="dynamicStreaming" value="true" />
                <!-- params for API -->
                <param name="includeAPI" value="true" />
                <param name="templateLoadHandler" value="BCLS.onTemplateLoad" />
                <param name="templateReadyHandler" value="BCLS.onTemplateReady" />

            </object>
            <script src="//docs.brightcove.com/en/scripts/https-fix.js"></script><script type="text/javascript">brightcove.createExperiences();</script>
            <!-- End of Brightcove Player -->
            <p id="videoName"></p>
            <p id="progress">Video Progress: <span id="progressBar"></span></p>
          </div>
          <div class="section" id="code">
            <h2><a name=""></a>The code</h2>
            <h3>Modifications to the player publishing code</h3>
<pre><code>
  &lt;!-- smart player api params --&gt;
  &lt;param name="includeAPI" value="true" /&gt;
  &lt;param name="templateLoadHandler" value="BCLS.onTemplateLoad" /&gt;
  &lt;param name="templateReadyHandler" value="BCLS.onTemplateReady" /&gt;
</code></pre>
          <h3>CSS used for this sample:</h3>
<pre><code id="css_code"></code></pre>
            <h3>JavaScript used for this sample:</h3>
<pre><code id="js_code"></code></pre>
          </div>
        </div>
      </div>
    </div>
    <!-- bcl scripts -->
    <script src="/en/scripts/prefix.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
    <script src="/en/scripts/flashHTMLswitch-nojQ.js"></script>
    <script src="/en/scripts/docs-nav-data.min.js"></script>
    <script src="/en/scripts/bcls-doc-site.js"></script>
    <script>
        $(document).foundation();
    </script>
    <script id="pageScript" type="text/javascript">
      //**** Any scripts specific to page samples should go here *********/
      // Brightcove Learning Services Module
      var BCLS = (function() {
        // variables
        var // API class references
            player,
            APIModules,
            mediaEvent,
            videoPlayer,
            // functions
            onTemplateLoad,
            onTemplateReady,
            onProgress,
            onSeekNotify,
            onMediaChange,
            // tracker for current position and current seek activity
            currentPosition = 0,
            lastCurrentPosition = 0,
            revertingSeek = false;
        // public functions
        // template loaded event handler
          onTemplateLoad = function (experienceID) {
            // get a reference to the player and API Modules and Events
            player = brightcove.api.getExperience(experienceID);
            APIModules = brightcove.api.modules.APIModules;
            mediaEvent = brightcove.api.events.MediaEvent;
          }
          // template ready event handler
          onTemplateReady = function (evt) {
            console.log(evt);
            // get references to modules
            videoPlayer = player.getModule(APIModules.VIDEO_PLAYER);
            // set up listeners for progress, seek-notify, change
            // note that handler name must be the *public* name
            videoPlayer.addEventListener(mediaEvent.PROGRESS, BCLS.onProgress);
            videoPlayer.addEventListener(mediaEvent.SEEK_NOTIFY, BCLS.onSeekNotify);
            videoPlayer.addEventListener(mediaEvent.CHANGE, BCLS.onMediaChange);
          }
          // progress event handler - save current position
          onProgress = function (evt) {
            // save current position
            if (!revertingSeek) {
                lastCurrentPosition = currentPosition;
                currentPosition = evt.position;
            } else {
                currentPosition = lastCurrentPosition;
            }
          }
          // seek-notify handler - undo seek
          onSeekNotify = function ( evt ) {
            // seek back to where we were
            if (!revertingSeek) {
                revertingSeek = true;
                do {
                  //console.log(evt);
                  console.log("currentPosition = " + currentPosition);
                  console.log("lastCurrentPosition = " + lastCurrentPosition);
                  console.log("evt.position = " + evt.position);
                  videoPlayer.seek(currentPosition);
                  console.log("in do while");
                  console.log("while value= " + Math.abs(currentPosition - evt.position));
                }
                while ( Math.abs(currentPosition - evt.position) > .5 );
            } else {
                console.log("resetting")
                revertingSeek = false;
            }

          }
          // media change handler - reset current position for new video
          onMediaChange = function () {
            // reset current position
            currentPosition = 0;
          }
        return {
            onTemplateLoad : onTemplateLoad,
            onTemplateReady : onTemplateReady,
            onProgress : onProgress,
            onSeekNotify : onSeekNotify
        }
      }());
    </script>
    <script>
      $(document).ready(function(){
        $("#js_code").html(BCLSpreFix($("#pageScript").html()));
        $("#css_code").html(BCLSpreFix($("#pageStyles").html()));
      });
    </script>
      
    
	<div style="text-align:center">
    <iframe id="CSAT" src="//learning-services-media.brightcove.com/doc-assets/general/surveylink.html" style=" padding-bottom:20px;border:none"></iframe>
</div>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>
</html>
