<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
  <!-- change title to match the h1 heading -->
  <title></title>
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
  <script src="//use.edgefonts.net/source-code-pro.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

  <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
  </head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
    <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
      <div id="top" class="section">
                <h1>Display Tags and Custom Fields</h1>
        <!-- content starts here -->

        <!-- Start of content -->

        <p class="BCL-objective">This example uses the Smart Player API to display information about the video being played, including the tags and custom fields. In this example, the tags and custom fields are displayed below the player.</p>
      </div><!-- div id="top" -->

      <!-- every div class section must have an id -->
      <!--break-->
      <div id="resources" class="section">
        <!-- h2 contents will be in page navigation label - 21 characters (including spaces) maximum -->
        <h2><a name="resources"></a>API resources used</h2>
        <h3>Smart Player API</h3>
        <p>This sample uses the following API resources</p>
        <h4>Modules and methods</h4>
        <ul>
          <li>
            <ul>
              <li>VIDEO_PLAYER
                <ul>
                  <li>getCurrentVideo()</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
        <h4>Events</h4>
        <ul>
          <li>None</li>
        </ul>
        <p class="text-warning">Note: the read methods of the Smart Player API are available to Express 3, Professional, and Enterprise accounts.</p>
      </div><!-- div id="resources" -->

      <div id="player" class="section">
        <h2><a name="player"></a>Functioning example</h2>
        <p class="text-warning">Note: the buttons below are for development purposes only &mdash; do not use in production.</p>
          <!-- buttons to switch between HTML and Flash Players -->
          <div id="modeSwitch">
            <span class="button" id="switchToHTML5" style="margin-bottom: 20px;margin-right: 10px;">Switch to HTML5 Player</span>
            <span class="button" id="switchToFlash" style="margin-bottom: 20px;">Switch to Flash Player</span>
          </div>
        <!-- Start of Brightcove Player -->

        <div style="display:none">
        </div>

        <!-- Start of Brightcove Player -->

        <div style="display:none">
        Used for display tags and custom fields sample
        </div>

       <!-- Start of Brightcove Player -->
        <script language="JavaScript" type="text/javascript" src="//sadmin.brightcove.com/js/BrightcoveExperiences.js"></script>
        
        <object id="myExperience928199562001" class="BrightcoveExperience">
          <param name="bgcolor" value="#FFFFFF" />
          <param name="width" value="480" />
          <param name="height" value="270" />
          <param name="playerID" value="921267190001" />
          <param name="playerKey" value="AQ~~,AAAA1oy1bvE~,ALl2ezBj3WG3MLvDx9F9zkV06cNK00ey" />
          <param name="isVid" value="true" />
          <param name="isUI" value="true" />
          <param name="dynamicStreaming" value="true" />
          
          <param name="@videoPlayer" value="928199562001" />

          <!-- smart player api params -->
          <param name="includeAPI" value="true" />
          <param name="templateLoadHandler" value="onTemplateLoad" />
          <param name="templateReadyHandler" value="onTemplateReady" />

        </object>
        <script src="//docs.brightcove.com/en/scripts/https-fix.js"></script><script type="text/javascript">brightcove.createExperiences();</script>

        <!-- End of Brightcove Player -->

        <div id="displayInfo"></div>

      </div><!-- div id="player" -->

      <div id="logic" class="section" >
        <h2><a name="logic"></a>How it is done</h2>
        <p>The sample uses the Smart Player API to retrieve information about the currently playing video using the <code>getCurrentVideo()</code> method. This method returns information about the video in an object. In the object, the tags are stored in an array, and the custom fields are stored in another object. Two different kinds of JavaScript loops are then used to dynamically build HTML, and then that HTML is injected into the page.</p>
        <h3>The Smart Player API part</h3>
        <p> When the asynchronous call is complete, the callback function is called, and the video information (in the form of a data transfer object) is automatically passed to the function. In this example, the video DTO contains the following:</p>
        <img src="//img.brightcove.com/dev-docs_display-tags-custom-fields_dto-in-console2.png" width="948" height="328">
        <p></p>
        <p>Notice that the <code>customFields</code> are stored in an object and the <code>tags</code> are stored in an array.</p>
        <h3>The rest</h3>
        <p>Once the video DTO has been retrieved, the rest of the work is using JavaScript to loop over the data structures and display the information in HTML. To display the tags, you first need to know how many tags are associated with the video. The <code>length</code> property can be used to retrieve the value, as shown on line 74 below. Then use a <code>for</code> loop to iterate over the array and retrieve the tags from the array. In the following code example, a unordered list (<code>&lt;ul&gt;</code>) is dynamically built and injected into the page's HTML.</p>
        <code data-gist-id="6941373" data-gist-hide-footer="true" data-gist-line="73-79"></code><br />
        <p>To display the custom fields, you will need to use a JavaScript <code>for-in</code> loop. This control structure can iterate over objects. The iterator, which is named <code>key</code> in the code below, does in fact represent the keys in the object, which in this example are:
          <ul>
            <li>imagepath</li>
            <li>playerurl</li>
            <li>videotopic</li>
          </ul>
          To access the values associated with those keys you use the following syntax: <code>videoDTO.customFields[key]</code>. The loop will iterate once for each key-value pair in the object and display the values in the object, which in this example are:
          <ul>
            <li>http://files.brightcove.com/BCL_PlayerAPI_wildlife.png</li>
            <li>http://support.brightcove.com/en/training-videos</li>
            <li>Land</li>
          </ul>
          Again, an unordered list is dynamically generated and injected into the HTML.
        </p>
        <code data-gist-id="6941373" data-gist-hide-footer="true" data-gist-line="81-87"></code><br />
      </div><!-- div id="logic" -->

      <div id="code" class="section">
        <h2><a name="code"></a>The code</h2>
        <p>See the full code <a href="https://gist.github.com/bcls/6941373">here</a>.</p>
      </div><!-- div id="code" -->

      <div id="alternative" class="section">
        <h2><a name="alternative"></a>Another approach</h2>
        <p>Some would say that using JavaScript loops and HTML together, as done above to dynamically build the unordered lists, is a poor practice because it mixes presentation and logic. An alternative approach, and some would say a better practice, is to use a templating engine. The following code block shows dynamically building the video information display using Handlebars, one of many templating engines.</p>
        <code data-gist-id="7041998" data-gist-hide-footer="true" data-gist-line="55, 69-70,73-83"></code><br />
        <p>If this looks like an interesting approach, check out <a href="http://handlebarsjs.com">Handlebars</a>.</p>
        <p>See the full code using Handlebars <a href="https://gist.github.com/bcls/7041998">here</a>.</p>
      </div><!-- div id="code" -->

  
    </div>
  </div>
  <!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
  <script src="/en/scripts/log.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site.js"></script>
    <script>
        $(document).foundation();
    </script>

    <script id="pageScript" type="text/javascript">

      <!-- custom scripts for this player and functionality -->

      var player,
        APIModules,
        videoPlayer;

      var onTemplateLoad = function(experienceID){
        player = brightcove.api.getExperience(experienceID);
        APIModules = brightcove.api.modules.APIModules;
      };

      var onTemplateReady = function(evt){
        videoPlayer = player.getModule(APIModules.VIDEO_PLAYER);
        videoPlayer.play();
        videoPlayer.getCurrentVideo( function(videoDTO){
          console.log(videoDTO);
          displayInfo.innerHTML += "<h3>About this video</h3>";
          displayInfo.innerHTML += "<p>Title: " + videoDTO.displayName + "</p>";
          displayInfo.innerHTML += "<p>Description: " + videoDTO.shortDescription +"</p>";

          // JavaScript to display tags
          var numTags = videoDTO.tags.length;
          displayInfo.innerHTML += "<p>Tags:</p><ul>";
          for (var i = 0; i < numTags; i++) {
            displayInfo.innerHTML += "<li>" + videoDTO.tags[i] + "</li>"; 
          };
          displayInfo.innerHTML += "</ul><br />";

          //Use JavaScript to display custom fields
          displayInfo.innerHTML += "<p>Custom Fields:</p><ul>";
          for (var key in videoDTO.customFields) {
            console.log(videoDTO.customFields);
            displayInfo.innerHTML += "<li><strong>" + key + "</strong>: " + videoDTO.customFields[key] + "</li>";
          }
          displayInfo.innerHTML += "</ul>";
        });
      };

      <!-- end custom scripts for this player and functionality -->

    </script>

    
    
	<div style="text-align:center">
    <iframe id="CSAT" src="//learning-services-media.brightcove.com/doc-assets/general/surveylink.html" style=" padding-bottom:20px;border:none"></iframe>
</div>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>
</html>