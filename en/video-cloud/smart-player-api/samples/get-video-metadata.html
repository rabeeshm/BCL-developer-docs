<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <!-- change title to match the h1 heading -->
    <title id="bclPageTitle">Smart Player API Sample: Get Video Metadata</title>
    <link href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" rel="stylesheet" type="text/css" />
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link href="//files.brightcove.com/proxima-nova/font-faces.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css" />
    <link href="/en/video-cloud/smart-player-api/samples/css/api-samples.css" rel="stylesheet" type="text/css" />
    <style id="pageStyles">
      /*********************************************
      styles for get video metadata sample
      *********************************************/
      #video-info {
        border: 1px #999 solid;
        border-radius: 5px;
        background-color: #F5F5F5;
        padding: 5px;
        width: 350px;
        margin-left: 10px;
        display: inline-block;
      }
      #video-info h3,#video-info h4 {
        margin-top: 3px;
        margin-bottom: 3px;
      }
      .float-right {
        float: right;
      }
      .float-left {
        float: left;
      }
    </style>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
  </head>

  <body>
  <!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
  <!-- search -->
  <div id="searchModal" class="reveal-modal" data-reveal></div>
  <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">

        <div id="top" class="section">
            <h1>Get Video Metadata</h1>
          <p>This simple example gets the metadata for the video currently in the player and displays some of it next to the player</p>
          <div class="text-warning">
            <h3>3rd party libraries used in this sample</h3>
            <p>Note: 3rd party libraries are used to simplify the JavaScript in the sample. These libraries are not supported by Brightcove. All functionality can be reproduced in ordinary JavaScript.</p>
            <ul>
              <li><a href="//jquery.org">jQuery</a></li>
              <li><a href="http://handlebarsjs.com/">Handlebars</a></li>
            </ul>
          </div>
        </div>
        <!-- every div class section must have an id -->
        <div class="section" id="resources">
          <h2><a name="resources"></a>API resources used</h2>
          <p>This sample uses the following API resources</p>
          <h4>Modules and methods</h4>
          <ul>
            <li>VIDEO_PLAYER
              <ul>
                <li>getCurrentVideo()</li>
                <li>getVideoDuration()</li>
              </ul>
            </li>
          </ul>
          <h4>Events</h4>
          <ul>
            <li>templateLoad</li>
            <li>templateReady</li>
            <li></li>
          </ul>
        </div>
        <div class="section" id="player">
          <!-- h2 contents will be in page navigation label - 21 characters (including spaces) maximum -->
          <h2><a name="player"></a>The Player</h2>
          <p>A standard Chromeless Video Player is used for this sample.</p>
          <p class="text-warning">Note: the buttons below are for development purposes only &mdash; do not use in production.</p>
          <!-- buttons to switch between HTML and Flash Players -->
          <div id="modeSwitch">
            <span class="button" id="switchToHTML5" style="margin-bottom: 20px;margin-right: 10px;">Switch to HTML5 Player</span>
            <span class="button" id="switchToFlash" style="margin-bottom: 20px;">Switch to Flash Player</span>
          </div>
          
          <div class="player-block">
            <div class="float-left">
              <script language="JavaScript" type="text/javascript" src="//sadmin.brightcove.com/js/BrightcoveExperiences.js"></script>
            <object id="myExperience921449663001" class="BrightcoveExperience">
              <param name="bgcolor" value="#FFFFFF" />
              <param name="width" value="480" />
              <param name="height" value="270" />
              <param name="playerID" value="2079935931001" />
              <param name="playerKey" value="AQ~~,AAAA1oy1bvE~,ALl2ezBj3WE0z3yX6Xw29sdCvkH5GCJv" />
              <param name="isVid" value="true" />
              <param name="isUI" value="true" />
              <param name="dynamicStreaming" value="true" />
              <param name="@videoPlayer" value="921449663001" />
              
              <param name="includeAPI" value="true" />
              <param name="templateLoadHandler" value="BCLS.onTemplateLoad" />
              <param name="templateReadyHandler" value="BCLS.onTemplateReady" />
            </object>
            <script src="//docs.brightcove.com/en/scripts/https-fix.js"></script><script type="text/javascript">brightcove.createExperiences();</script>
            <!-- End of Brightcove Player -->
            </div>
            <!-- Start of Brightcove Player -->
            <div id="video-info"></div>
          </div>
        </div>
        <div class="section" id="logic">
          <h2><a name="logic"></a>How it is done</h2>
          <p>Since we are getting the video metadata immediately, everything can be done in the <code>templateReady</code> handler. We get a reference to the VIDEO_PLAYER module, and then call <code>getCurrentVideo()</code>. Properties of the returned video DTO are injected into an empty <code>div</code> tag below the player. We then call the <code>getVideoDuration()</code> method to get the video duration and add that to the <code>div</code> &mdash; note that the video <code>length</code> was already there in the video DTO returned by <code>getCurrentVideo()</code>, but in milliseconds. The <code>getVideoDuration()</code> has an optional argument to format the duration, saving us from having to do that manually to the <code>length</code></p>
          <p>To create the HTML string containing the video DTO data, we use the Handlebars templating system &mdash; this is just a JavaScript library, so it is not essential to the functioning of the sample.</p>
          <p>See the full code in the <strong>Code</strong> section below.</p>
          <p class="text-warning">The JavaScript code for this sample is structured according to the Module pattern, explained in Stoyan Stefanov's <a href="http://oreilly.com/catalog/9780596806750"><em>JavaScript Patterns</em></a> and in many places on the Web.</p>
        </div>
        <div class="section" id="code">
          <h2><a name="code"></a>The Code</h2>
            <h3>Modifications to the player publishing code</h3>
<pre><code>
  &lt;!-- smart player api params --&gt;
  &lt;param name="includeAPI" value="true" /&gt;
  &lt;param name="templateLoadHandler" value="onTemplateLoad" /&gt;
  &lt;param name="templateReadyHandler" value="onTemplateReady" /&gt;
</code></pre>
            <h3>CSS used for this sample:</h3>
<pre><code id="css_code"></code></pre>
            <h3>JavaScript used for this sample:</h3>
<pre><code id="js_code"></code></pre>
        </div>
      </div>
    </div>
    <!-- bcl scripts -->
    <script src="/en/scripts/prefix.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
    
    <script src="/en/scripts/docs-nav-data.min.js"></script>
    <script src="/en/scripts/bcls-doc-site.js"></script>
    <script src="/en/scripts/flashHTMLswitch-nojQ.js"></script>
    <script>
        $(document).foundation();
    </script>
    <script id="pageScript" type="text/javascript">
      /******** Any scripts specific to page samples should go here *********/
      /**** Brightcove Learning Services Module ****/
      var BCLS = (function() {
        var videoInfoTemplate = "<h3>About this video:</h3><h4>Title: {{displayName}}</h4><p>Description: {{shortDescription}}</p><p>Tags:</p><ul>{{#tags}}<li>{{.}}</li>{{/tags}}</ul>",
            player,
            videoPlayer,
            APIModules,
            duration,
            template,
            data,
            results,
            $videoInfo = $("#video-info");
        // initial player event handlers must be public
        return {
          /**** template loaded event handler ****/
          onTemplateLoad : function (experienceID) {
            // get a reference to the player and API Modules and Events
            player = brightcove.api.getExperience(experienceID);
            APIModules = brightcove.api.modules.APIModules;
          },
          /**** template ready event handler ****/
          onTemplateReady : function (evt) {
            BCLSmain.bclslog("ready");
            // get references to modules
            videoPlayer = player.getModule(APIModules.VIDEO_PLAYER);
            videoPlayer.getCurrentVideo( function (videoDTO) {
             BCLSmain.bclslog(videoInfoTemplate);
             // merge video data into Handlebars template
             template = Handlebars.compile(videoInfoTemplate);
             BCLSmain.bclslog(template);
             data = videoDTO;
             results = template(data);
             // inject results
             $videoInfo.html(results);
            });
            // get the duration for the video
            videoPlayer.getVideoDuration( true, function(duration) {
              $videoInfo.append("<p>Duration: " + duration + "</p>");
            });
          }
        };
      }());
    </script>
    <script>
      $(document).ready(function(){
        $("#js_code").html(BCLSpreFix($("#pageScript").html()));
        $("#css_code").html(BCLSpreFix($("#pageStyles").html()));
      });
    </script>
      
    
	<div style="text-align:center">
    <iframe id="CSAT" src="//learning-services-media.brightcove.com/doc-assets/general/surveylink.html" style=" padding-bottom:20px;border:none"></iframe>
</div>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>
</html>
