<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
  <!-- change title to match the h1 heading -->
  <title id="bclPageTitle">Video Cloud Product Configurator</title>
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
  <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
  
  <style>
    fieldset {
      color: #63A7CE;
      border: 1px #63A7CE solid;
      border-radius: 5px;
      padding: 5px;
    }
    legend {
      color: #63A7CE;
      font-size: 16px;
      font-weight: bold;
    }
    input[type="checkbox"] {
      margin: 0;
      height: 20px;
      width: 20px;
    }
    .checkbox-label {
      margin-top: 8px;
      margin-left: 4px;
      padding-top: 16px;
    }
    .feature-checkbox input {
      margin-top: 0;
    }
    .superscript {
      text-decoration: underline;
      color: blue;
      cursor: pointer;
    }
    .note-highlight {
      color: #63A7CE;
    }
  </style>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
  </head>
  <body>
  <!-- content ============================================ -->
  <div class="container">
    <div class="row">
      <div class="span8 offset2">
        <h1>Video Cloud Product Configurator</h1>
        <p>Welcome to the Video Cloud product configurator. Here you can select needed features to see which editions and CDN account types will work.</p>
        <p class="text-warning">Note: most Video Cloud features not shown here &mdash; just those that are supported only by particular editions and CDN account types.</p>
      </div>
    </div>
    <div class="row">
      <div id="featureCheckboxes">
        <div class="span2">
          <fieldset>
            <legend>Adding Media</legend>
            <div id="addingMedia" class="feature-list"></div>
          </fieldset>
        </div>
        <div class="span2">
          <fieldset>
            <legend>Managing Media</legend>
            <div id="managingMedia" class="feature-list"></div>
          </fieldset>
        </div>
        <div class="span2">
          <fieldset>
            <legend>Player Features</legend>
            <div id="playerFeatures" class="feature-list"></div>
          </fieldset>
        </div>
        <div class="span2">
          <fieldset>
            <legend>Advertising</legend>
            <div id="ads" class="feature-list"></div>
          </fieldset>
        </div>
        <div class="span2">
          <fieldset>
            <legend>Media Delivery</legend>
            <div id="mediaDelivery" class="feature-list">
            </div>
          </fieldset>
        </div>
      </div>
      <div class="span2 cdnCheckboxesDisplay" id="cdnCheckboxesDisplay"  style="opacity:0">
        <fieldset>
          <legend>Content Security</legend>
            <div id="comboCheckboxes" class="feature-list">
                <div class="feature-checkbox"><input type="checkbox" id="RTMPe VOD Flash"><span class="checkbox-label">RTMPe VOD Flash</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="RTMPe Live Flash"><span class="checkbox-label">RTMPe Live Flash</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="TTL VOD Flash"><span class="checkbox-label">TTL VOD Flash</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="TTL Live Flash"><span class="checkbox-label">TTL Live Flash</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="TTL VOD HTML5"><span class="checkbox-label">TTL VOD HTML5</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="TTL Live HTML5"><span class="checkbox-label">TTL Live HTML5</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="SWFv VOD Flash"><span class="checkbox-label">SWFv VOD Flash</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="SWFv Live Flash"><span class="checkbox-label">SWFv Live Flash</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="FAXS VOD Flash"><span class="checkbox-label">FAXS VOD Flash</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="Widevine VOD Flash"><span class="checkbox-label">Widevine VOD Flash</span></div>
                <div class="feature-checkbox"><input type="checkbox" id="eHLS VOD HTML5"><span class="checkbox-label">eHLS VOD HTML5</span></div>
            </div>
        </fieldset>
      </div>
    </div>
    <div class="row">
      <div id="results" class="span8 offset2">
        <h2>Account Options</h2>
        <div id="accountOptions"></div>
      </div>
    </div>
    <div class="row">
      <div class="span3 offset2">
        <h3>Edition</h3>
        <div id="editionResults">
          Express Plan 1<br />
          Express Plan 2<br />
          Express Plan 3<br />
          Professional<br />
          Enterprise<br />
        </div>
      </div>
      <div class="span4">
        <h3>CDN</h3>
          <h4>Confirmed Configurations</h4> <br />
          <div id="cdnResultsConfirmed">
          </div>
          <br />
          <h4>Possible Configurations (not confirmed)</h4> <br />
          <div id="cdnResultsPossible">
          </div>
      </div>
      <div class="span3">
        <h3>Notes</h3>
        <div id="notesdiv">
          <ol>
            <!-- Dymanically add notes from CDNs here -->
          </ol>
        </div>
      </div>
    </div>
  </div>
  <!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="JSON_Editions_var.js"></script>
  <script src="JSON_CDN_Objects_var.js"></script>
  <script type="text/javascript">
    //The resultCDNs contains all resulting CDNs from all checked boxes
    //The shadowResults are the CDNs for a particular check of a box (it is shadowing the actual results)
    //Once all CDNs for a particular check are in the shadowResults, they are put into resultCDNs
    var BCLS = (function() {

      var resultEditions = [{edition:"Express Plan 1", value: true},
        {edition:"Express Plan 2", value: true},
        {edition:"Express Plan 3", value: true},
        {edition:"Professional", value: true},
        {edition:"Enterprise", value: true}],
        resultEditionsLength = resultEditions.length;

      var featuresLength = JSON_Editions.features.length,
        selectedDeliveryCombos = [],
        resultCDNs = [];

      removeSpaces = function( str ) {
        return str.replace(/\s+/g, '')
      };

      // Determines if an array contains an object, both passed to the function
      containsObject = function( existingArray, newObject ) {
        var existingArrayLength = existingArray.length;
        for (var i = 0; i < existingArrayLength; i++) {
          if ( existingArray[i].cdnIntegration == newObject.cdnIntegration && existingArray[i].actualCDN == newObject.actualCDN){
            return true;
          }
        }
        return false;
      };

      //Gets name and number of Content Security boxes checked
      determineSelectedDeliveryCombos = function(){
        selectedDeliveryCombos = $("#comboCheckboxes :checked").map(function(){
          return this.id;
        })
      };

      //Adds CDNs for a particular check of a box to the final results
      applyShadowToResultsCDN = function( shadowResults ){
        var shadowResultsLength = shadowResults.length;
        for (var i = shadowResultsLength - 1; i >= 0; i--) {
          if (shadowResults[i] == false) {
            resultCDNs.splice(i,1);
          }
        }
      };


      //Adds resulting CDNs to results array
      evaluateCDNs = function(){
        resultCDNs = [];
        var selectedDeliveryCombosLength = selectedDeliveryCombos.length,
          shadowResults = [],
          shadowing = false,
          shadowCounter = 0;

          for (var i = 0; i < selectedDeliveryCombosLength; i++) {
            //console.log( JSON_CDN.PlatformDeliverySecurity[selectedDeliveryCombos[i]]);
            var thisPDSGroup = JSON_CDN.PlatformDeliverySecurity[selectedDeliveryCombos[i]];
            var thisPDSGroupLength = thisPDSGroup.length;
            for (var j = 0; j < thisPDSGroupLength; j++) {
              //Retrieve a particular CDN, e.g. BC CDN Limelight Flash Streaming
              var thisCDN = thisPDSGroup[j];
              //Check if this is the first time building the results CDNs
              if (shadowing == false) {
                //Check if particular CDN already in results CDN
                if ( containsObject(resultCDNs,thisCDN) == false ) {
                  //If CDN not already in results CDN, push it into the results CDN array
                  resultCDNs.push(thisCDN);
                  //Place false into the corresponding shadow array for initialization
                  shadowResults[shadowCounter] = false;
                  //Increment shadow array counter
                  shadowCounter ++;
                }
              //If not the first time building the results CDNs must be sure that each CDN in results is also in the second set of results
              //For instance, if the initial results CDNs is for Flash-VOD-RTMPe, to stay in results each CDN must also be in
              //the results for Flash-Live-TTL
              }else{
                //
                for (var p = 0; p < shadowCounter; p++) {
                  //Check if the value in shadow array is already true, in which case do not check again for match
                  if ( shadowResults[p] == false) {
                    //Check if this CDN (e.g BC CDN-Limelight Flash Streaming) matches this element in results CDN array
                    //If there is a match set corresponding element in shadow array to true
                    //This element will not be checked again in this loop
                    if(resultCDNs[p].cdnIntegration == thisCDN.cdnIntegration && resultCDNs[p].actualCDN == thisCDN.actualCDN){
                      shadowResults[p]=true;
                      break;
                    }
                  }
                }
              }
            }
            shadowing = true;
            if (i > 0 ) {
              applyShadowToResultsCDN( shadowResults );
              shadowCounter = resultCDNs.length;
              shadowResults = [];
              for (var x = 0; x < shadowCounter; x++) {
                shadowResults[x] = false;
              }
            }
          }
      };

      //Displays CDNs from the resultsCDN
      displayCDNs = function(){
        $("#cdnResultsConfirmed").html("");
        $("#cdnResultsPossible").html("");
        $("#notesdiv ol").empty();
        var superscriptCount = 1,
          superscriptNeeded=false;
        if (selectedDeliveryCombos.length == 0) {
          displayAllCDNs();
        }else{
          resultCDNsLength = resultCDNs.length;
          for (var i = 0; i < resultCDNsLength; i++) {
            //Check if note exists, and if it does build li and insert in Notes ol
            if (resultCDNs[i].note != "") {
              var newLI = "<li>" + resultCDNs[i].note + "</li>";
              $("#notesdiv ol").append(newLI);
              var superscriptHTML = ' <span class="superscript"><sup id="' + superscriptCount + '">[' + superscriptCount + ']</sup></span>';
              superscriptNeeded = true;
              superscriptCount ++;
            }
            if ( resultCDNs[i].yesPossible == "yes") {
              if (superscriptNeeded) {
                $("#cdnResultsConfirmed").append(resultCDNs[i].cdnIntegration + " / " + resultCDNs[i].actualCDN + superscriptHTML + "<br />");
              }else{
                $("#cdnResultsConfirmed").append(resultCDNs[i].cdnIntegration + " / " + resultCDNs[i].actualCDN + "<br />");
              }
            }else{
              if (superscriptNeeded){
                $("#cdnResultsPossible").append(resultCDNs[i].cdnIntegration + " / " + resultCDNs[i].actualCDN + superscriptHTML +"<br />");
              }else{
                $("#cdnResultsPossible").append(resultCDNs[i].cdnIntegration + " / " + resultCDNs[i].actualCDN + "<br />");
              }
            }
            superscriptNeeded = false;
          }
        }
        $('span.superscript').on('click',clickOnSuperscript);
      };

      displayEditions = function(){
        $("#editionResults").html("");

        for (var i = 0; i < resultEditionsLength; i++) {
          if (resultEditions[i].value) {
            $("#editionResults").append(resultEditions[i].edition + "<br />");
          }
        }
      };

      evaluateEditions = function(){
        resultEditions = [{edition:"Express Plan 1", value: true},
          {edition:"Express Plan 2", value: true},
          {edition:"Express Plan 3", value: true},
          {edition:"Professional", value: true},
          {edition:"Enterprise", value: true}],
          resultEditionsLength = resultEditions.length;
        var selectedFeatures = $("#featureCheckboxes :checked").map(function(){
          return this.id;
        });
        var selectedFeaturesLength = selectedFeatures.length;
        for (var j = 0; j < selectedFeaturesLength; j++) {
          for (var i = 0; i < featuresLength; i++) {
            if ( removeSpaces(JSON_Editions.features[i].featurename) === selectedFeatures[j]) {
              var theFeatureEditionObject = JSON_Editions.features[i].edition;
              var editionsCounter = 0;
              for (var prop in theFeatureEditionObject) {
                if (resultEditions[editionsCounter].edition) {
                  if (theFeatureEditionObject[prop] == false) {
                    resultEditions[editionsCounter].value = false;
                  }
                  editionsCounter++;
                }
              }
            }
          }
        }
      };

      displayAllCDNs = function(){
        $("#notesdiv ol").empty();
        var uniqueCDNsForDisplay =[];
        $.each(JSON_CDN.PlatformDeliverySecurity,function(key,value){
          var thisSetLength = value.length;
          for (var i = 0; i < thisSetLength; i++) {
            if ( containsObject(uniqueCDNsForDisplay,value[i]) == false ) {
              uniqueCDNsForDisplay.push(value[i]);
            }
          }
        });
        uniqueCDNsForDisplay.sort(function(obj1,obj2){
          return [obj1.cdnIntegration,obj1.actualCDN] < [obj2.cdnIntegration,obj2.actualCDN] ? -1 : 1;
        });
        var uniqueCDNsForDisplayLength = uniqueCDNsForDisplay.length;
        for (var i = 0; i < uniqueCDNsForDisplayLength; i++) {
          $("#cdnResultsConfirmed").append(uniqueCDNsForDisplay[i].cdnIntegration + " / " + uniqueCDNsForDisplay[i].actualCDN + "<br />");
        }
      };

      controlCDNContentOpacity = function(){
        if( $('#cdnCheckboxesDisplay').attr('style') == 'opacity:0' ){
          $('#cdnCheckboxesDisplay').attr('style','opacity:1');
        }else{
          $('#cdnCheckboxesDisplay').attr('style','opacity:0');
        }
      };

      clickOnSuperscript = function(evt){
        $("#notesdiv ol li").removeClass("note-highlight");
        var superNumber = evt.target.textContent;
        superNumber = superNumber.replace (/[^\d]/g, '');
        //alert(superNumber);
        console.log($("#notesdiv ol li:nth-child(" + superNumber + ")"));
        $("#notesdiv ol li:nth-child(" + superNumber + ")").addClass("note-highlight");
      };

      return {

        prep : function(){
          resultCDNs = [];
          selectedDeliveryCombos = [];
          $('#ContentSecurity').on('change', controlCDNContentOpacity);
        },

        getFeaturesAndMakeCheckboxes : function(){
          for (var i = 0; i < featuresLength; i++) {
            var loopFeatureName = JSON_Editions.features[i].featurename;
            var dynamicCheckbox = $('<div class="feature-checkbox"><input type="checkbox" id="'+ removeSpaces(loopFeatureName) +'" /><span class="checkbox-label">'+ loopFeatureName +'</span></div>');
            dynamicCheckbox.appendTo('#'+JSON_Editions.features[i].group);
          }
          displayAllCDNs();
        },

        processEditions : function(){
          evaluateEditions();
          displayEditions();
        },

        processCDNs : function(){
          determineSelectedDeliveryCombos();
          evaluateCDNs();
          displayCDNs();
        }

      }; // end return section

    })();

      BCLS.getFeaturesAndMakeCheckboxes();
      BCLS.prep();
      $('#featureCheckboxes').on('change',BCLS.processEditions);
      $('#comboCheckboxes').on('change',BCLS.processCDNs);

    </script>
  <div style="text-align:center">
    <iframe id="CSAT" src="//learning-services-media.brightcove.com/doc-assets/general/surveylink.html" style=" padding-bottom:20px;border:none"></iframe>
</div>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>
  </html>
