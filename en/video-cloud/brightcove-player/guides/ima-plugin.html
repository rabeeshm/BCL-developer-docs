<!DOCTYPE html>
<html lang="en">

<head>


    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <title id="bclPageTitle">Advertising with IMA3 Plugin Guide</title>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css" />
    <link rel="stylesheet" type="text/css" href="/en/styles/anytime.5.0.0-1401232312.min.css" />
    <script type="text/javascript">
        <!--//--><![CDATA[//><!--
        var _gaq = _gaq || [];
        _gaq.push(
            ["_setAccount", "UA-2728311-23"], ["_setDomainName", ".brightcove.com"], ["_trackPageview"]);
        (function () {
            var ga = document.createElement("script");
            ga.type = "text/javascript";
            ga.async = true;
            ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(ga, s);
        })();
         //--><!]]>
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
    <style type="text/css">
     iframe {
       width: 640px;
       height: 360px;
     }
    .table-styles {
        width: 100%;
        border:solid 1px #D3D3D3;
    }
    .table-styles th{
        background-color: #D3D3D3;
    }
    .table-styles td {
        border:solid 1px #D3D3D3;
    }
  </style>


</head>

<body>
    <!-- header navbar -->
    <div id="navWrapper" class="fixed"></div>
    <!-- breadcrumbs -->
    <nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
    <!-- search -->
    <div id="searchModal" class="reveal-modal" data-reveal></div>
    <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
            <div id="top" class="section">
                <h1 id="bclPageHeading">Advertising with IMA3 Plugin Guide</h1>
                <!-- content starts here -->
              <p class="BCL-objective">This topic covers the use of the IMA plugin and how it can be implemented using <span class="video-cloud-only">Video Cloud Studio</span><span class="perform-only">Perform Studio</span> and through custom coding.</p>
              <p>The IMA plugin integrates the Brightcove player with Google&#39;s Interactive Media Ads (IMA) for HTML5 version 3. This allows you to request and track VAST ads for your player. For details about Google IMA, see the <a href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/">Using the IMA HTML5 SDK Version 3</a> document.</p>
              <p>The sample video below demonstrates the use of the IMA Plugin. Play the video to see a pre-roll, a skippable mid-roll at 5 seconds, then finally a post-roll.</p>
              <div><iframe src='//players.brightcove.net/1752604059001/63dd4825-e4fd-4cd7-a69f-7fd90e10cbd6_default/index.html?videoId=4607357817001' allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div>
              <p>This topic contains the following sections:</p>
              <ul>
                <li><a href="#testadserver">Testing the ad server</a></li>
                    <li><a href="#playersmodule">Implementing using Players module</a></li>
                <li><a href="#options">Options</a></li>
                <li><a href="#html5settings">HTML5 settings</a></li>
                <li><a href="#events">Events</a></li>
                <li><a href="#playbackmodes">Playback modes</a></li>
                <li><a href="#issues">Known issues</a></li>
              </ul>
              <p class="BCL-aside">Note: Initial behavior concerning the timing of loading of video advertisements is described in the <a href="#requestMode">requestMode</a> option. Be sure to check this as default behavior is undesirable for some types of ad servers/networks.</p>
           </div>
           <div id="testadserver" class="section">
            <h2>Testing the ad server</h2>
            <p>The first thing you should do is verify the validity of the ad tag you are planning to use. Be sure you have copied its URL and browse to the following page: <a href="//developers.google.com/interactive-media-ads/docs/vastinspector_dual" target="_blank">Video Suite Inspector</a> (clicking this link will cause the page to open in a new window or tab)</p>
            <p>Paste your ad tag URL into the <strong>Input type</strong> form input field. Click <strong>Test Ad</strong> and you will see your ad(s) play, with the Google supplied motorcycle race video interspersed. If your ad tag is not working in this test environment, it will not work with Brightcove Player.</p>

            <p class="BCL-aside">Note: The VAST ad tag can be hosted by your ad provider, or you can copy the XML and host it on your own URL.</p>

           <!-- <p>You may wish to confirm your ad server works with the Brightcove Player. We have found that most of the issues around ads not playing are due to problems with the ad tag itself. To verify that your ad server works with the Brightcove player, use the  <a href="//players.brightcove.net/2549849259001/bc-ima3-demo/">Brightcove Player with Advertisements</a> testing page. This page allows you to easily test out  ad servers in the new player. A screenshot of the testing page follows:</p>
            <div><img src="/en/video-cloud/brightcove-player/guides/assets/ima-plugin-tester-screenshot.png"></div>
          -->

          </div>
          <div id="playersmodule" class="section">
              <h2>Implement using Players module</h2>
                  <div id="player" class="video-cloud-only">
                    <video
                      data-account="20318290001"
                      data-player="6eca8a74-a16d-487b-9f15-8b40c3df5ec0"
                      data-embed="default"
                      data-video-id="4043519495001"
                      class="video-js" controls crossorigin="anonymous" width="640" height="360">
                      </video>
                    <script src="//players.brightcove.net/20318290001/6eca8a74-a16d-487b-9f15-8b40c3df5ec0_default/index.min.js"></script>
                </div>

              <p>To implement the IMA Plugin using the Players module, follow these steps:</p>
              <ol>
                  <li>Click <strong>Players</strong> in the navigation header to open the Players module.</li>
                  <li>Click the link for the player you want to configure.</li>
                  <li>Locate the <strong>Advertising</strong> section and click <strong>Edit</strong></li>
                  <li>Click <strong>Yes</strong> to enable IMA ads.</li>
                  <li>Enter the <strong>Server URL</strong> for the ad server.</li>
                  <li>Select the <strong>Request Ads</strong> setting. </li>
                  <ul>
                    <li><strong>On load -</strong> Ads are requested immediately when the player loads (this is normally the best experience for DFP / VPAID)</li>
                    <li><strong>On play -</strong> The first ad request is delayed until playback is initiated</li>
                    <li><strong>On demand -</strong> All ad requests will be initiated programmatically using the <code>player.ima3.adrequest()</code> method</li>
                  </ul>
                  <li>Select the ad <strong>Content Type</strong>.    The Content Type determines the ad integration technologies to attempt to use. The player  will test each ad technology on initialization and use the first supported one for the lifetime of the player.</li>
                  <ul>
                    <li><strong>Flash preferred -</strong> Use Flash-based ads, if not available, use HTML5-based ads</li>
                    <li><strong>HTML5 preferred -</strong> Use HTML5-based ads, if not available, use Flash-based ads</li>
                    <li><strong>HTML5 only -</strong> Use only HTML5-based ads</li>
                  </ul>
                  <li>Set the <strong>Timeout</strong> values.
                    <ul>
                      <li><strong>Initialization -</strong> The maximum amount of time to wait, in milliseconds, for an ad  to initialize before playback</li>
                      <li><strong>Pre-roll -</strong> The maximum amount of time to wait for an ad  to initiate a preroll, in milliseconds</li>
                      <li><strong>Post-roll -</strong> The maximum amount of time to wait for an ad  to initiate a postroll, in milliseconds</li>
                    </ul>
                    <div><img alt="" src="assets/studio-ad-props.png" /></div>
                  </li>
                  <li>Click <strong>Save</strong> to save the changes.</li>
              </ol>
              <p>When  the changes to the advertising properties are saved, the IMA plugin will be configured as part of the Plugin settings.</p>
              <div><img alt="" src="assets/studio-ima-plugin-props.png" /></div>
              <p>The IMA plugin does support additional properties that are not available in the UI. If needed, modify the IMA plugin JSON to include any other options you may need.</p>
              <p class="BCL-aside">Note: You may want to dynamically build the <code>serverURL</code> at the client (which means the IMA3 plugin would already be initialized), for example after a user login. You can do this by setting that value to an empty string in the <strong>options</strong> <code>{ serverUrl: '' }</code>, then later assign the value programmatically.</p>
            </div>
            <div id="options" class="section">
                <h2>Options</h2>
                    <p>The video.js IMA3 plugin is built on top of the <a href="https://github.com/brightcove/videojs-ads">video.js ads framework</a> and accepts any options
                        that the ad framework provides. Take a look at the ad framework <a href="https://github.com/brightcove/videojs-ads/blob/master/README.md">README</a> for
                        details on the current set of overrideable settings. Both the IMA plugin specific options and ad framework options are documented here.</p>

                    <h3>adControlBar</h3>
                    <p>Type: <code>object</code> Default Value: identical to the player control bar options</p>
              <p>When using the Flash ad tech, a separate set of controls are created to manage interaction with the ad SWF. When those controls are created,
                      these options will be used during their initialization. If no value is specified, the configuration settings for the regular control bar
                      will be used.</p>

                    <h3>adSwf</h3>
                    <p>Type: <code>string</code> Default Value: <code>videojs.ima3.swf</code></p>
              <p>The path to the videojs IMA3 swf. A debugging option for development.</p>
                    <h3>adTechOrder</h3>
                    <p>Type: <code>array</code> Default Value: [ &#39;flash&#39;, &#39;html5&#39;]</p>
              <p>The ad integration technologies to attempt to use, in order of descending precedence. videojs-ima3 will test each ad tech in order on initialization
                      and use the first supported one for the lifetime of the player. </p>
                    <p>This option is part of the ad framework is configured as follows:</p>
<pre><code>player.ima3({
  adSwf: 'http://example.com/custom.swf'
});</code></pre>

                    <h3>clickTrackingElement</h3>
              <p>Type: <code>HTMLElement</code> Default Value: undefined</p>
                    <p>If the HTML ad tech is being used in <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/guides/custom_playback">custom ad playback</a> mode, this specifies an alternative HTML element to be used to track advertisement taps on devices that don't support input events over the video element. More details are available in the parameter documentation for the <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdDisplayContainer">IMA AdDisplayContainer</a>. If you provide a click tracking element, it is your responsibility to show and hide it at the appropriate times on the appropriate platforms. In most cases, it's best to leave this setting undefined and allow the the plugin and IMA to manage ad interaction.</p>
                    <h3>debug</h3>
                    <p>Type: <code>boolean</code> Default Value: <code>false</code></p>
                    <p>If debug is set to true, the ads framework will output additional information about its current state during playback. This can be handy for diagnosing issues or unexpected behavior in an ad integration.</p>
                    <p>This option is part of the ad framework is configured as follows:</p>
                    <pre><code>player.ads({
  debug: true
});</code></pre>

                    <h3>ima3SdkSettings</h3>
                    <p>Type: <code>object</code> Default Value: undefined</p>
                    <p>If provided, the properties of this object are used to set the page-level <a href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.ImaSdkSettings">Ima3SdkSettings</a> when
                        the IMA SDK has finished loading. The properties of this object are expected to be the camel-cased equivalent of setter methods on the SDK
                        settings object, minus the &#39;set&#39; prefix. For example, if you provided this object when initializing the plugin:</p>
<pre><code class="js">{
  &#39;numRedirects&#39;: 3,
  &#39;ppid&#39;: &#39;publisher-id&#39;,
}
</code></pre>
                    <p class="BCL-aside">Note: When using the Flash playback technology, the <code>numRedirects</code> value is not settable, and defaults to Google's default value of 4 permissible redirects.</p>
                    <p>Then the video.js IMA plugin would run code that looks something like this when IMA had loaded:</p>
<pre><code class="js">window.google.ima.ImaSdkSettings.setNumRedirects(3);
window.google.ima.ImaSdkSettings.setPpid(&#39;publisher-id&#39;);
</code></pre>

                    <h3>loadingSpinner</h3>
                    <p>Type: <code>boolean</code> Default Value: <code>false</code></p>
                    <p>When set to true, the <code>vjs-loading-spinner</code> is displayed while an ad loads.</p>

                    <h3>postrollTimeout</h3>
                    <p>Type: <code>number</code> Default Value: <code>100</code> milliseconds</p>
                    <p>The maximum amount of time to wait for an ad implementation to initiate a postroll, in milliseconds. If <code>contentended</code> has been fired and the ad implementation does not call <code>startLinearAdMode()</code> before <code>postrollTimeout</code> expires, the content video will end playback.</p>
                    <p>This option is part of the ad framework and is configured as follows:</p>
                    <pre><code>player.ads({
  postrollTimeout: 1000
});</code></pre>
                    <p>Once the ad dispatches the <code>contentended</code> event one of these things will happen:</p>
              <ul>
                      <li><code>startLinearAdMode()</code> is called within the timeout: Postroll(s) will play without the user seeing any content video first.</li>
                      <li><code>skipLinearAdMode()</code> is called within the timeout: Content video stops.</li>
                      <li><code>startLinearAdMode()</code> is never called: Content video stops.</li>
                      <li><code>startLinearAdMode()</code> is called, but after the postrollTimeout expired: Content video stops.</li>
                    </ul>
              <p>The <code>postrollTimout</code> should be as short as possible so that the viewer does not have to wait unnecessarily if no postroll is scheduled for a video. Make this longer if your ad integration needs a long time to decide whether it has postroll inventory to play or not. Ideally, your ad integration should already know if it wants to play a postroll before the <code>contentended</code> event.
              </p>


                    <h3>prerollTimeout</h3>
                    <p>Type: <code>number</code> Default Value: <code>1000</code> milliseconds</p>
                    <p>The maximum amount of time to wait for an ad implementation to initiate a preroll, in milliseconds. If <code>readyforpreroll</code> has been fired and the ad implementation does not call <code>startLinearAdMode()</code> before <code>prerollTimeout</code> expires, the content video will begin playback. The <code>prerollTimeout</code> option is cumulative with the standard timeout parameter.</p>
                    <p>This option is part of the ad framework and is configured as follows:</p>
                    <pre><code>player.ads({
  prerollTimeout: 1000
});</code></pre>
                    <p>Once the ad dispatches the <code>readyforpreroll</code> event one of these things will happen:</p>
              <ul>
                      <li><code>startLinearAdMode()</code> is called within the timeout: Preroll(s) will play without the user seeing any content video first.</li>
                      <li><code>startLinearAdMode()</code> is never called: Content video plays without preroll(s).</li>
                      <li><code>startLinearAdMode()</code> is called, but after the prerollTimeout expired: Bad user experience; content video plays a bit, then preroll(s) cut in.</li>
                    </ul>
              <p>The <code>prerollTimout</code> should be as short as possible so that the viewer does not have to wait unnecessarily if no preroll is scheduled for a video. Make this longer if your ad integration needs a long time to decide whether it has preroll inventory to play or not. Ideally, your ad integration should already know if it wants to play a preroll before the <code>readyforpreroll</code> event.
              </p>

              <h3 id="requestMode">requestMode</h3>
                    <p>Type: <code>string</code> Default Value: <code>onload</code></p>
                    <p>There are three possible values for this option:</p>
                    <ul>
                      <li><code>onload</code>: Ads are requested immediately when the player loads. This is normally the best experience for DFP / VPAID.</li>
                      <li><code>onplay</code>: The first ad request is delayed until playback is initiated. This is important for ad networks which consider ad requests made without corresponding ad plays, which can  happen on a poorly performing site. This will cause ads trafficked to eventually drop, or the customer will receive less for the ads shown.</li>
                      <li><code>ondemand</code>: All ad requests will be initiated using the <code>player.ima3.adrequest()</code> method manually</li>
                    </ul>
                    <p>Note: All <code>requestMode</code> values make <code>ondemand</code> requests immediately.</p>
                    <p>This option is part of the ad framework is configured as follows:</p>
<pre><code>player.ima3({
  requestMode: 'onplay'
});</code></pre>

              <h3>serverUrl</h3>
                    <p>Type: <code>string</code> Default Value: <code>undefined</code></p>
                    <p>This is the only option that is <strong>required</strong>. Here, you will provide the URL to your ad server. Remember, you can <a href="#testadserver">test the ad tag</a> on your server before trying to use it in the plugin.</p>
  <p>This option is part of the <code>ima3</code> plugin and can be configured in Brightcove Studio as shown <a href="#playersmodule">above</a>, or in the embed-in-page code as follows:</p>
                    <pre><code>player.ima3({
"serverUrl": "your ad server"
});</code></pre>
                </div>
                <div id="adMacros" class="section">
                    <h2>Ad macros and the serverURL</h2>
                    <p>There are ad macros available to make you job easier when creating the ad server URL. These macros enable you to use variables in the server URL for which the IMA3 plugin will substitute appropriate values. For instance, the following server URL contains some of the variables: </p>
                    <pre><code>{"serverUrl": "http://myadserver.com/ad/?video={mediainfo.id}&duration={player.duration}"}</code></pre>
                    <p>The IMA3 plugins would substitute in the appropriate values, and the server URL actually used would appear as follows:</p>
                    <pre><code>{"serverUrl": "http://myadserver.com/ad/?video=12340001&duration=60"}</code></pre>
                    <p>The following is the complete list of variable for which substituted values will be used:</p>
                    <table class="table-styles">
                      <thead>
                        <tr>
                          <th style="width:30%">Macro</th>
                          <th style="width:60%">Description</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>{player.id}</td>
                          <td>Player ID</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.id}</td>
                          <td>Video ID</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.name}</td>
                          <td>Video title</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.description}</td>
                          <td>Short description (250 chars max)</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.tags}</td>
                          <td>Tags (metadata) associated with the video</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.reference_id}</td>
                          <td>Reference ID</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.duration}</td>
                          <td>Duration of the video as reported by Video Cloud</td>
                        </tr>
                        <tr>
                          <td>{player.duration}</td>
                          <td>Duration of video as measured by player (possibly slightly different from <code>mediainfo.duration</code> and probably more accurate)</td>
                        </tr>
                          <td>{document.referrer}</td>
                          <td>Referring page URL</td>
                        </tr>
                        <tr>
                          <td>{window.location.href}</td>
                          <td>Current page URL</td>
                        </tr>
                        <tr>
                          <td>{player.url}</td>
                          <td>URL of the player</td>
                        </tr>
                        <tr>
                          <td>{timestamp}</td>
                          <td>Current local time in milliseconds since 1/1/70</td>
                        </tr>
                        <tr>
                      </tbody>
                    </table>

              <h3>timeout</h3>
                    <p>Type: <code>number</code> Default Value: <code>5000</code></p>
                    <p>The maximum amount of time to wait, in milliseconds, for an ad implementation to initialize before playback. If the viewer has requested playback and the ad implementation does not dispatch the <code>adsready</code> event before this timeout expires the content video will begin playback. It's still possible for an ad implementation to play ads after this waiting period has finished, but video playback will already be in progress.</p>
                    <p>This option is part of the ad framework is configured as follows:</p>
<pre><code>player.ads({
  timeout: 5000
});</code></pre>
                    <p>Once the ad plugin starts waiting for the <code>adsready</code> event, one of these things will happen:</p>
                    <ul>
                        <li>Integration ready within the timeout: This is the best case, preroll(s) will play without the user seeing any content video first.</li>
                        <li>Integration ready, but after timeout has expired: Preroll(s) still play, but the user will see a bit of content video.</li>
                        <li>Integration never becomes ready: Content video starts playing after timeout.</li>
                    </ul>
                    <p>This timeout is necessary to ensure a good viewer experience in cases where the ad implementation suffers an unexpected or irreparable error and never fires an <code>adsready</code> event. Without this timeout, the ads plugin would wait forever, and neither the content video nor ads would ever play.</p>
                    <p>If the ad implementation takes a long time to initialize and this timeout is too short, then the content video will begin playing before the first preroll opportunity. This has the jarring effect that the viewer would see a little content before the preroll cuts in.</p>
                    <p>In internal Brightcove testing it was found that five seconds seemed to be long enough to accommodate slow initialization in most cases, but still short enough that failures to initialize didn't look like failures of the player or content video.            </p>
            </div>
          <div id="methods" class="section">
            <h2>Methods</h2>
            <h3>player.ima3.adrequest( )</h3>
            <p>Calling this method will create an on-demand adrequest immediately upon receiving an ad response. Invoking this method creates a new IMA adManager which means that any previous ad response information (for instance, a postroll ad returned in a previous VAST response) will be lost. Brightcove recommends that you only use this method in cases where up-front knowledge of ad timings isn't known or you will be making all ad calls on-demand. In all other cases, it makes sense to put all ad data in the initial VAST call on plugin initialization.</p>
            <h5>Parameters</h5>
            <ul>
                <li><strong>adRequestUrl</strong> <code>String</code> Path to a VAST ad tag. You can and should pass relative URLs.</li>
            </ul>
            <h5>Returns:</h5>
            <ul>
            <li>Nothing</li>
            </ul>
            <p>Example</p>
            <pre><code>player.ima3.adrequest('http://pubads.g.doubleclick.net/gampad/ads?sz=640x360&iu=/6062/iab_vast_samples/skippable&ciu_szs=300x250,728x90&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]');</code></pre>

            <h3>player.ima3.ready()</h3>
            <p>Similar to the <code>vjs.ready()</code> method, any callbacks passed into this method will only be invoked when the ima3 plugin is ready. Since the loading of the ima3 swf can take some time, it is sometimes desirable to use this function to delay calling your methods until the swf is ready to handle them. For example, you use this method to delay and calls to <code>player.ima3.adrequest()</code> that might be made before the the player can handle them.</p>
            <h5>Parameters</h5>
            <ul>
                <li><strong>callback</strong> <code>function</code></li>
            </ul>
            <h5>Returns:</h5>
            <ul>
            <li>Nothing</li>
            </ul>
          </div>
          <div id="runtimesettings" class="section">
              <h2>Runtime settings</h2>
              <p>The following methods are available for both the HTML5 and Flash ad playback technologies.</p>
              <h3>AdsManager.destroy</h3>
              <p>Type: <code>google.ima.AdsManager.destroy</code></p>
              <p>Calling this method destroys the current ads manager. For more information see Google's <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdsManager.destroy">document</a> on the method.</p>
              <h3>AdsManager.getRemainingTime</h3>
              <p>Type: <code>google.ima.AdsManager.getRemainingTime</code></p>
              <p>Calling this method returns the amount of time remaining for the current ad. If an ad isn't available or has finished playing, it returns -1. For more information see Google's <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdsManager.getRemainingTime">document</a> on the method.</p>
              <h3>ImaSdkSettings.setAutoPlayAdBreaks</h3>
              <p>Type: <code>google.ima.ImaSdkSettings.setAutoPlayAdBreaks</code></p>
              <p>This method takes a boolean representing whether VMAP and ad rules are automatically played. For more information see Google's <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.ImaSdkSettings.setAutoPlayAdBreaks">document</a> on the method.</p>
            </div>
          <div id="html5settings" class="section">
            <h2>HTML5 settings</h2>
            <p>If the HTML5 ad tech is in use, a number of IMA settings are available on the plugin object at runtime. For instance, to determine the ad ID you you would use:</p>
<pre><code>var adId = player.ima3.currentAd.getAdId();</code></pre>
            <p>Be careful interacting directly with these properties. Calling the wrong method can lead to unexpected results and failure of advertisements to play properly.</p>
            <h3>adsLoader</h3>
            <p>Type: <code>google.ima.AdsLoader</code></p>
            <p>The object used to create ads requests. See ima.AdsLoader. The Ads Loader may not be available until adsready has been fired by the plugin.</p>
            <h3>adsManager</h3>
            <p>Type: <code>google.ima.AdsManager</code></p>
            <p>The object responsible for playing ads. See ima.AdsManager. The Ads Manager is not available until adsready has been fired by the plugin.</p>
            <h3>adDisplayContainer</h3>
            <p>Type: <code>google.ima.AdDisplayContainer</code></p>
            <p>The object responsible for managing the display elements for ads. See ima.AdDisplayContainer. The Ads Display container may not be available until adsready has been fired by the plugin.            </p>
            <h3>currentAd</h3>
            <p>Type: <code>google.ima.Ad</code></p>
            <p>When an ad is playing, an object that encapsulates information about the current ad. See ima.Ad.          </p>
          </div>

            <div id="events" class="section">
                <h2>Events</h2>
                    <p>The plugin emits some custom event types during loading, initialization, and playback. You can listen for IMA3 and ad framework events just like you would any other event:</p>
<pre><code class="js">player.on(&#39;ima3error&#39;, function(event) {
  console.log(&#39;event&#39;, event);
});
</code></pre>
                <table class="table-styles">
                  <thead>
                    <tr>
                      <th style="width:35%">Event</th>
                      <th style="width:65%">Dispatched when:</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>ima3-ready</td>
                      <td>The ima3 plugin code has loaded and is ready load the IMA SDK.</td>
                    </tr>
                    <tr>
                      <td>ima3error</td>
                      <td>There was an error loading the IMA3 SDK from Google. If it occurs, no ads will be displayed.</td>
                    </tr>
                    <tr>
                      <td>ima3-ad-error</td>
                      <td>An error has occurred in the IMA3 SDK. You should verify your ad configuration and settings to be sure your DoubleClick account is correctly configured. You can find common troubleshooting tasks at the <a href="https://support.google.com/dfp_premium/">DoubleClick support site</a> or talk to your DoubleClick account representative.</td>
                    </tr>
                    <tr>
                      <td>ads-request</td>
                      <td>Upon request ad data.</td>
                    </tr>
                    <tr>
                      <td>ads-load</td>
                      <td>When ad data is available following an ad request.</td>
                    </tr>
                    <tr>
                      <td>ads-ad-started</td>
                      <td>An ad has started playing.</td>
                    </tr>
                    <tr>
                      <td>ads-ad-ended</td>
                      <td>An ad has finished playing.</td>
                    </tr>
                    <tr>
                      <td>ads-pause</td>
                      <td>An ad is paused.</td>
                    </tr>
                    <tr>
                      <td>ads-play</td>
                      <td>An ad is resumed from a pause.</td>
                    </tr>
                    <tr>
                      <td>ads-first-quartile</td>
                      <td>The ad has played 25% of its total duration.</td>
                    </tr>
                    <tr>
                      <td>ads-midpoint</td>
                      <td>The ad has played 50% of its total duration.</td>
                    </tr>
                    <tr>
                      <td>ads-third-quartile</td>
                      <td>The ad has played 75% of its total duration.</td>
                    </tr>
                    <tr>
                      <td>ads-click</td>
                      <td>A viewer clicked on the playing ad.</td>
                    </tr>
                    <tr>
                      <td>ads-volumechange</td>
                      <td>The volume of the playing ad has been changed.</td>
                    </tr>
                    <tr>
                      <td>ads-pod-started</td>
                      <td>The first ad in a linear ad pod (a sequenced group of ads) has started.</td>
                    </tr>
                    <tr>
                      <td>ads-pod-ended</td>
                      <td>The last ad in a linear ad pod (a sequenced group of ads) has finished.</td>
                    </tr>
                    <tr>
                      <td>ads-allpods-completed</td>
                      <td>All linear ads have finished playing.</td>
                    </tr>
                  </tbody>
                </table>
            </div>
          <div id="playbackmodes" class="section">
            <h2>Playback modes</h2>
            <p>The IMA3 HTML5 SDK has two separate modes of operation: standard and custom playback mode. In standard mode, IMA3 will create a video element inside of the AdDisplayContainer iframe to play linear ads. Custom playback mode shares the video element with the content player and is intended for mobile devices that do not support multiple simultaneous video elements well. The videojs-ima3 plugin chooses which HTML5 playback mode to use by querying the content player's techOrder property and determining if any of the other content techs are supported. If multiple techs are supported, sharing the content video element isn't safe because it would be disposed if the current tech is unloaded. In practice, this means desktop machines with Flash installed will operate in standard playback mode and mobile devices without Flash will use custom playback mode.</p>
          </div>
          <div id="issues" class="section">
            <h2>Known issues</h2>
                    <h3>Supported environments</h3>
                    <p>To check for supported combinations of platforms, advertising standards and video media, see Google's <a href="https://developers.google.com/interactive-media-ads/video_features_and_sdk_versions">Video Feature and SDK compatibility</a> document. That document and the <a href="https://developers.google.com/interactive-media-ads/docs/vastinspector_dual">Video Suite Inspector</a> will help you diagnose attempted IMA3 advertisement configurations that simply will not function.</p>
                    <p class="BCL-aside">Note: To use the Video Suite Inspector you will need your VAST ad tag or VAST ad response. You can then paste it into the given text field and then click the <strong>Test Ad</strong> button.</p>
                    <h3>Resizing the Player During Ad or Video Playback</h3>
                  <p>If the player is resized during ad or video playback, ad content will not resize unless the player's dimensions function is called to resize the player. Resizing the player using other methods (style width and height, for example) will not resize the ad.</p>
                    <h3>Click Handling</h3>
                    <p>The IMA3 ad display is overlaid on top of the video player during playback. By default, that would prevent click or touch events from reaching
                        the player. This is not normally desirable so the default CSS only allows pointer events to reach the IMA SDK when at least one of the following
                    conditions is true:</p>
                    <ul>
                      <li>When the flash ad tech is active and an ad is playing</li>
                      <li>When the user&#39;s browser does not support touch events, the HTML ad tech is active and an ad is playing</li>
                      <li>When the the user&#39;s browser supports touch event, player controls are visible and an ad is playing</li>
                    </ul>
                    <h3>Exceptions Generated by Overlay Ads</h3>
                    <p>On Chrome 30, an exception is thrown from the IMA bridge when &quot;fading out&quot; an overlay ad:</p>
<pre><code>Uncaught NotFoundError: An attempt was made to reference a Node in a context where it does not exist. bridge3.1.33.html:46
ae bridge3.1.33.html:46
Pi.I bridge3.1.33.html:121
(anonymous function) bridge3.1.33.html:93
</code></pre>
                    <p>This issue is evident in the <a href="https://developers.google.com/interactive-media-ads/docs/vastinspector_dual">IMA VAST inspector</a> as well.</p>
                    <h3>Overlays and Fullscreen Transitions</h3>
                    <p>video.js uses the <a href="http://www.w3.org/TR/fullscreen/">fullscreen API</a> where available. Different browsers implement the transition to
                        fullscreen differently and that can produce discrepancies in appearance when transitioning into and out of fullscreen mode. In most implementations,
                        the element that is being taken into fullscreen is geometrically scaled (i.e. zoomed) from its original to the target size. Most overlay
                        advertisements are designed to be displayed at a fixed size, however, and so they may appear distorted until the animation completes.</p>
                    <h3>Midrolls and live streams</h3>
                    <p>Midrolls play immediately if they are configured for live streams.</p>
                    <h3>Control bars</h3>
                    <p>You will see that the advertisement and video that plays after advertisement completion can have different control bars. IMA creates a separate video element under most circumstances and exposes information about the ad playback state through non-standard methods. The control bar in the Brightcove Player is associated with different playback technology, and it is non-trivial to have the same control bar for both technologies.</p>
                    <h3>Skippable ads on iPhones</h3>
                    <p>Skippable ads are not supported by IMA3 on iPhones and such ads will not be shown at all.</p>
                    <h3>Ads Free Setting from Studio</h3>
                    <p>If you use Studio to set your video as ads free, this will no work. Brightcove Player does not respect this setting. To get the behavior you want you currently have to configure two separate players or write a plugin that updates the ad configuration dynamically.</p>
                    <h3>Conflict with gpt_proxy.js</h3>
                    <p>If using the GPT proxy script with IMA3, and the <strong>adTechOder</strong> is <strong>HTML5</strong> first, playback issues can occur. The IMA3 plugin will be affected when using any script that uses <strong>window.google</strong> or <strong>window.google.ima</strong>. It is suggested that you check if you're using Brightcove Player, and if so, don't load the proxy on those occasions.</p>
            </div>
            <div id="contribads" class="section">
              <h2>Player Ad Libraries</h2>
              <p>The <a href="https://github.com/videojs/videojs-contrib-ads">videojs/videojs-contrib-ads</a> GitHub repository contains a plugin which provides common functionality needed by video advertisement libraries working with Brightcove Player. The plugin provides common functionality needed by video ad integrations and takes care of a number of concerns for ad integrators, reducing the code you have to write for your ad integration.</p>
              <p>For instance, the functionality in <a href="https://github.com/videojs/videojs-contrib-ads">videojs/videojs-contrib-ads</a> allows you to check the current <strong>state</strong> property on a player to determine whether an ad is playing or not. States change frequently during the pre-roll "handshake"  but are otherwise usually one of <code>content-playback</code> or <code>ad-playback</code>, defined by:</p>
              <ul>
                  <li><code>player.ads.state === 'ad-playback'</code> (this is the state when <code>adstart</code> is called)</li>
                  <li><code>player.ads.state === 'content-playback'</code> (this is the state when <code>adend</code> is called)</li>
              </ul>
              <p>The readme for the repository contains a state diagram on the README which covers the details of the pre-roll states.</p>
              <p>See the <a href="contrib-ads-migration-guide.html">Migration Guide</a> for information on the latest version of videojs-contrib-ads.</p>
            </div>
            <div id="adnetworkflow" class="section">
              <h2>Ad network flow</h2>
              <p>For those wishing to see a bit more "under the hood", a browser's development tools Network tab can reveal interesting details about the key files being downloaded as part of the ad process.</p>
              <p>In this example using the IMA3 plugin, you first see the the plugin's SWF version being downloaded. Note that the screenshots are from a desktop, so the browser is getting the Flash version of the plugin.</p>
              <div><img src="/en/video-cloud/brightcove-player/guides/assets/ads-learning-guide-network-plugin-swf.png"></div>
              <p>The next ads related file to download is the VMAP document.</p>
              <div><img src="/en/video-cloud/brightcove-player/guides/assets/ads-learning-guide-network-vmap.png"></div>
              <p>Last to load is a VAST document for a particular ad.</p>
              <div><img src="/en/video-cloud/brightcove-player/guides/assets/ads-learning-guide-network-vast.png"></div>
            </div>

           <div id="implementcode" class="section">
             <h2 id="expanderHead">Implement using code</h2>
             <div id="expanderContent" style="display:none">
                  <p>To implement a plugin the player needs to know the location of the plugin code, a stylesheet if needed, the plugin name and plugin configuration options. The location of the plugin code and stylesheet are as follows:</p>
                    <ul>
                      <li>http://players.brightcove.net/videojs-ima3/videojs.ima3.min.js</li>
                        <li>http://players.brightcove.net/videojs-ima3/videojs.ima3.min.css</li>
              </ul>
                    <p>The name of the plugin is <code>ima3</code>, and an example set of options is:</p>
                    <p><code data-gist-id="6edffc8c896381fb71e9" data-gist-hide-footer="true" data-gist-line="1-5"></code></p>
                    <p>The following shows using the In-Page Embed implementation of the player to associate the IMA Plugin with a single instance of a player.</p>
                      <ul>
                          <li>Line 31: Uses a <code>link</code> tag to include the plugin's CSS in the <code>head</code> of the HTML page.</li>
                          <li>Line 38: Gives the <code>video</code> tag an <code>id</code> attribute, with some value, in this case <strong>video_1</strong>.</li>
                          <li>Line 46: Uses a <code>script</code> tag to include the plugin's JavaScript in the <code>body</code> of the HTML page.</li>
                          <li><p>Line 51-57: Initializes the plugin and passes in custom options. Here, we listen for the first <code>loadedmetadata</code> event, which is fired when the player content, including ads, is loaded in the player.</p>
                  <p class="BCL-aside">NOTE: While the <code>ready()</code> method is used to indicate that the player is loaded and ready, the <code>loadedmetadata</code> event is used to indicate that the player content, like ads, is ready to interact with. Here, we are also using the <code>one()</code> method so that our function is executed the first time the plugin is loaded and not every time a video is loaded. For details, see the <a href="../../brightcove-player/guides/events.html">Understanding Player Events</a> document.</p></li>
                          <li>Line 53: Creates a reference to the player.</li>
                      </ul>
                      <p><code data-gist-id="6edffc8c896381fb71e9" data-gist-hide-footer="true" data-gist-line="31,37-58"></code></p>
            </div>
          </div>


            <div class="section" id="BCLreferences">
                <h2>Related Topics</h2>
                <ul>
                    <!-- <li><a href="//docs.brightcove.com/en/video-cloud/brightcove-player/guides/bc-analytics-plugin.html">New Player Plugin: Analytics</a> -->
                    <li><a href="../../brightcove-player/guides/ad-events.html">Ad Events and Ad Objects</a>
                    </li>
                    <li><a href="hls-plugin.html">Brightcove Player Plugin: HLS</a>
                    </li>
                    <li><a href="plugin-dev-quick-start.html">Quick Start to Plugin Development</a>
                    </li>
                    <li><a href="../../player-management/getting-started/player-mgmt-quick-start.html">Quick Start to Player Management</a>
                    </li>
                </ul>
            </div>
        </div>

    <!-- bcl scripts============================================================-->
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.2/gist-embed.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
    <script src="/en/scripts/docs-nav-data.min.js"></script>
    <script src="/en/scripts/bcls-doc-site-v1.js"></script>
    <script src="/en/scripts/expander.js"></script>
    <script>
        $(document).foundation();
    </script>
    <script id="pageScript" type="text/javascript">
        /******** Any scripts specific to page samples should go here *********/
    </script>
    </div>
    <div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
    <script>
    var feedbackMail = document.getElementById("feedbackMail");
    feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
    </script>
    </body>

</html>
