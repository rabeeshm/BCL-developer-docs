<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
  <!-- change title to match the h1 heading -->
  <title>Advertising with the Once UX Plugin</title>
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
  <script src="//use.edgefonts.net/source-code-pro.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

  <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
      m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-2728311-29', 'auto');
    ga('send', 'pageview');
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
  <!-- Page styles -->
  <style>
    .player-block iframe {
      width: 640px;
      height: 360px;
    }
  </style>
</head>

<body>
  <!-- header navbar -->
  <div id="navWrapper" class="fixed"></div>
  <!-- breadcrumbs -->
  <nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
  <!-- search -->
  <div id="searchModal" class="reveal-modal" data-reveal></div>
  <!-- content -->
  <!-- content -->
  <div class="row">
    <div class="sidebar large-2 columns show-for-large-up">
      <div id="sidenav" class="side-nav"></div>
    </div>
    <div id="main" class="large-10 small-12 columns">
      <div id="top" class="section">
        <h1>Advertising with the Once UX Plugin</h1>
        <!-- Place document intro sentence(s) here -->
        <p class="BCL-aside">The features in this plugin are not yet supported in Brightcove Player version 5.0. <a href="https://support.brightcove.com/en/video-cloud/docs/setting-player-update-mode-and-version">Please select and lock your player version by selecting manual update mode in the studio</a> or via API. Locking your player on version 1.x will ensure continued successful playback when using this plugin.</p>
        <p>Using the Once UX plugin with your Brightcove player, you can play any Brightcove Once video.</p>
        <p>By default, the plugin enforces that all advertisements are watched and displays an ad count-down timer while they play. You can easily customize this plugin to use your own overlays and allow users to skip advertisements.</p>
        <div class="text-warning"
        style="padding-left:1em;padding-right:1em;">
          <h4>Other plugins used</h4>
          <p>Note: This example uses two other open source video.js plugins:</p>
          <ul>
            <li><a href="https://github.com/videojs/videojs-contrib-ads">videojs-contrib-ads</a> : Allows you to listen for <code>adstart</code> and <code>adend</code> events. You can listen for these events to know when an <code>adRoll</code> starts and ends respectively. Be aware, however, that these events can fire in rapid succession when scrubbing. They should always accurately reflect the <code>currentTime</code> of the playhead and states of the player. See the <a href="contrib-ads-migration-guide.html">Migration Guide</a> for information on the latest version of videojs-contrib-ads.</li>
            <li><a href="https://github.com/brightcove/videojs-overlay">videojs-overlay</a> : For details, refer to the <a href="overlay-plugin.html">Display Overlay Plugin</a> document.</li>
          </ul>
        </div>
      </div>
      <div id="player" class="section">
        <h2>The player</h2>
        <p>This example enforces the playback of an advertisement before the main subject video. An overlay is displayed with an ad count-down timer.</p>
        <div class="player-block">
          <iframe style='width: 640px;height: 360px;' src='//players.brightcove.net/3676484086001/b27063ca-8d5f-4992-a740-84b54034beb2_default/index.html' allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe>
        </div>
      </div><!-- id="player" -->

      <div id="implementplayersmodule" class="section">
        <h2>Implement using Players module</h2>
        <p>To implement the Once UX Plugin using the Players module, follow these steps:</p>
          <ol>
              <li>Open the <strong>Players</strong> module and locate the player.</li>
            <li>Click the link for the player to open the player properties.</li>
            <li>Locate the <strong>Plugins</strong> section and click <strong>Edit</strong>.</li>
            <li>The JavaScript for the plugin is provided and will not change for different plugin implementations. For the <strong>JavaScript URL</strong>, enter:
                  <pre>https://players.brightcove.net/videojs-onceux/videojs-onceux.min.js</pre></li>
                <li>The CSS for the plugin is provided and will not change for different plugin implementations. For the <strong>CSS URL</strong>, enter:<br/>
      <pre>https://players.brightcove.net/videojs-onceux/videojs-onceux.min.css</pre></li>
      <li>For the plugin name, enter <strong>onceux</strong>.</li>
              <li>The <strong>Options</strong> provided in the form specifies the URI to call to get your Once VMAP data. A stub example is shown here:<br/>
<pre><code>{
"metadataUri" : "http://onceux.unicornmedia.com/now/ads/vmap/od/auto/f1e8b045-e52e-4636-9459-818da5f90bab/3aaf99a3-57d7-4a8d-8dd9-2c6f671d77e1/825a2774-b49d-11e3-87e6-005056835b09/0a10b34f-85e7-44a8-a4fb-4a1b7c9e97ac/content.once"
}</code></pre>
          <div><img alt="OnceUX Plugin Studio" src="/en/video-cloud/brightcove-player/guides/assets/onceux-options.png"></div>
        </li>
        <li>Click <strong>Save</strong> and then <strong>Publish</strong> the player.</li>
      </ol>

        <h3>Initialize options</h3>
        <p>When you add the OnceUX plugin to your player, as shown above, you must pass an <code>options</code> object to the plugin to initialize it. This object must contain a <code>metadataUri</code> string or a VMAP object, along
          with any of the other optional properties:</p>
        <ul>
          <li><code>metadataUri</code>
          <ul>
            <li>Required</li>
            <li>Type: String</li>
            <li>Default: undefined</li>
            <li>Description: The URI to call for the VMAP data.</li>
            <li>Example: "http://onceux.unicornmedia.com/now/ads/vmap/od/auto/1234"</li>
          </ul></li>
          <li><code>vmap</code>
          <ul>
            <li>Optional</li>
            <li>Type: Object</li>
            <li>Default: none</li>
            <li>Description: If supplied, the plugin will use this VMAP object instead of calling the metadata URL to get the VMAP data.</li>
            <li>Example: see this <a href="//solutions.brightcove.com/bcls/brightcove-player/onceux-plugin/vmap-example.json">VMAP object</a>
            </li>
          </ul></li>
          <li><code>hideOverlay</code>
          <ul>
            <li>Optional</li>
            <li>Type: Boolean</li>
            <li>Default: false</li>
            <li>Description: If true, the countdown timer and the <strong>Learn More</strong> click through overlays will not be shown while ads are playing.</li>
            <li>Example: true (hides default overlays)</li>
          </ul></li>
          <li><code>timeout</code>
          <ul>
            <li>Optional</li>
            <li>Type: Number</li>
            <li>Default: 45000</li>
            <li>Description: The time in milliseconds to wait for the Once URI to respond.</li>
            <li>Example: 10000 (wait 10 seconds)</li>
          </ul></li>
          </ul>

          <h3>Use iframe</h3>
          <p>It is a best practice to use the iframe player implementation.</p>
          <p>Here is the complete code:</p>
          <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="173-195"></code>
          </p>

          <h3>Use embed_in_page</h3>
          <p>If you choose to use the embed_in_page implementation, you can add the OnceUX plugin right in the page code. Just remember that using the embed_in_page implementation only affects the player instance
            on the page, while the iframe implementation affects all instances of your player.</p>
          <p>Here is the complete code:</p>
          <div class="video-cloud-only">
              <p><script src="https://gist.github.com/552369a8c35afcd32c2c.js"></script>
              </p>
          </div>
          <div class="perform-only">
              <p>
                  <script src="https://gist.github.com/74502a9cac1457153bcc.js"></script>
              </p>
          </div>
          <!-- <p class="BCL-aside">NOTE: While the <code>ready()</code> method is used to indicate that the player is loaded and ready, the <code>loadedmetadata</code> event is used to indicate that the player content, like ads, is ready to interact with. Here, we are also using the <code>one()</code> method so that our function is executed the first time the plugin is loaded and not every time a video is loaded. For details, see the <a href="../../brightcove-player/guides/events.html">Understanding Player Events</a> document.</p> -->
      </div>
      <div id="methods" class="section">
        <h2>Methods</h2>
        <p>The OnceUX plugin has the following methods:</p>
        <ul>
          <li><code>player.onceux.absoluteTimeAt(timeInSeconds)</code>
              <ul>
                  <li>A function that takes the content time and returns the absolute time in the entire stream, including ads. </li>
                  <li>Parameters: A Number for the content time in seconds.</li>
                  <li>Returns: <code>Number</code></li>
                  <li>Example: You can use the following code to seek 5 seconds into the video content.
                  <pre><code>myPlayer.currentTime(myPlayer.onceux.absoluteTimeAt(5)))</code></pre></li>
              </ul>
          </li>
          <li><code>player.onceux.currentTime()</code>
              <ul>
                  <li>A function that returns the current time within the playing ad or content.</li>
                  <li>Parameters: none</li>
                  <li>Returns: <code>Number</code></li>
              </ul>
          </li>
          <li><code>player.onceux.duration()</code>
              <ul>
                  <li>A function that returns the current duration of the playing ad or content.</li>
                  <li>Parameters: none</li>
                  <li>Returns: <code>Number</code></li>
              </ul>
          </li>
          <li><code>player.onceux.timeline.pathAtAbsoluteTime(timeInSeconds)</code>
              <ul>
                <li>A function which takes a Number and provides a "path" into the timeline at any given point between <code>0</code> and the <code>absoluteDuration</code> of the stream.</li>
                <li>Parameters: A Number for the absolute time in seconds to provide a "path" for.</li>
                <li>Returns: A JSON object for the <code>path</code> representing the timeline. For details, see the <a href="#pathproperties">path object properties</a>.</li>
              </ul>
          </li>
          <li><code>player.onceux.seekAds(timeInSeconds)</code>
              <ul>
                <li>A function that takes a time (in seconds) to seek to without the default seek handling behavior enforcing that ads are not skipped.</li>
                <li>Parameters: A Number for the absolute time in seconds to seek to.</li>
                <li>Returns: None</li>
              </ul>
          </li>
        </ul>
      </div>
      <div id="events" class="section">
        <h2>Events</h2>
        <p>The OnceUX plugin events are triggered when the <code>timeupdate</code> event occurs. Both the <code>linearAd</code> and <code>adRoll</code> objects are passed in these events.</p>
        <p>Here is an example of an event object returned:</p>
        <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="46-49"></code>
        </p>
        <p>Here are the available events:</p>
        <ul>
          <li>
            <p><code>onceux-linearad-start</code> : The linear ad starts playing.</p>
          </li>
          <li>
            <p><code>onceux-linearad-impression</code> : The linear ad impression URL has been pinged.</p>
          </li>
          <li>
            <p><code>onceux-linearad-firstQuartile</code> : The linear ad playhead crosses first quartile.</p>
          </li>
          <li>
            <p><code>onceux-linearad-midpoint</code> : The linear ad playhead crosses midpoint.</p>
          </li>
          <li>
            <p><code>onceux-linearad-thirdQuartile</code> : The linear ad playhead crosses third quartile.</p>
          </li>
          <li>
            <p><code>onceux-linearad-complete</code> : The linear ad completes playing. The <code>playCount</code> property of linear ad is incremented.</p>
          </li>
          <li>
            <p><code>onceux-adroll-start</code> : The ad roll starts playing.</p>
          </li>
          <li>
            <p><code>onceux-adroll-complete</code> : The ad roll completes playing. The <code>playCount</code> property of the ad roll is incremented.</p>
          </li>
          <li>
            <p><code>onceux-ads-complete</code> : All the ads have been played.</p>
          </li>
          <li>
            <p><code>onceux-linearad-skipped</code> : The linear ad is skipped by the user. Ads can be skipped only when multiple ad rolls are seeked over or by invoking the <code>seekAds()</code> function.</p>
          </li>
          <li>
            <p><code>onceux-linearad-mute</code> : The linear ad is muted by the user.</p>
          </li>
          <li>
            <p><code>onceux-linearad-unmute</code> : The linear ad is unmuted by the user.</p>
          </li>
          <li>
            <p><code>onceux-linearad-pause</code> : The linear ad is paused by the user.</p>
          </li>
          <li>
            <p><code>onceux-linearad-resume</code> : The linear ad is resumed by the user.</p>
          </li>
          <li>
            <p><code>onceux-companionad-creativeView</code> : The companion ad creative view event fired.</p>
          </li>
        </ul>
      </div>
      <div id="properties" class="section">
        <h2>Properties</h2>
        <p>You can view the values of runtime properties for the <code>onceux</code> object. Not all properties are currently parsed from the VMAP. See the <a href="//solutions.brightcove.com/bcls/brightcove-player/onceux-plugin/properties-example.json">properties example</a> for
          the current objects that are returned.</p>
        <h3>Once object properties</h3>
        <p>Here are the properties included in the <code>onceux</code> object:</p>
        <ul>
          <li><code>player.onceux.timeline</code>
          <ul>
            <li>Type: Object</li>
            <li>Description: An object providing the essential parsed "absolute" timeline information from the VMAP.</li>
            <li>Example:
            <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="34-42"></code>
            </p></li>
          </ul></li>
          <li><code>player.onceux.timeline.contenturi</code>
          <ul>
            <li>Type: String</li>
            <li>Description: The content URI parsed from the VMAP.</li>
          </ul></li>
          <li><code>player.onceux.timeline.absoluteDuration</code>
          <ul>
            <li>Type: Number</li>
            <li>Description: The total duration of the content including all Linear advertisements.</li>
          </ul></li>
          <li><code>player.onceux.timeline.contentDuration</code>
          <ul>
            <li>Type: Number</li>
            <li>Description: The duration of the content excluding all Linear advertisements.</li>
          </ul></li>
          <li><code>player.onceux.timeline.adRolls</code>
          <ul>
            <li>Type: Array</li>
            <li>Description: An Array of JSON objects representing the unmodified VAST 'AdBreak' info parsed from the Once VMAP XML file.</li>
          </ul>
        </ul>
        <h3>Ad roll properties</h3>
        <p>Here are the properties included in the <code>adRoll</code> object:</p>
        <ul>
          <li>
            <p><code>adRoll.absoluteBeginTime</code> : Indicates the absolute time at which the adRoll will begin.</p>
          </li>
          <li>
            <p><code>adRoll.absoluteEndTime</code> : Indicates the absolute time at which the adRoll will end.</p>
          </li>
          <li>
            <p><code>adRoll.index</code> : Indicates the position of the adRoll with respect to the other adRollsIndicates the absolute time at which the adRoll will end.</p>
          </li>
          <li>
            <p><code>adRoll.playCount</code> : Indicates the number of times the adRoll has completed. Value 0 means that it has not been played.</p>
          </li>
        </ul>
        <h3>Linear ad properties</h3>
        <p>Here are the properties included in the <code>linearAd</code> object:</p>
        <ul>
          <li>
            <p><code>linearAd.absoluteBeginTime</code> : Indicates the absolute time at which the linear ad will begin.</p>
          </li>
          <li>
            <p><code>linearAd.absoluteEndTime</code> : Indicates the absolute time at which the linear ad will end.</p>
          </li>
          <li>
            <p><code>linearAd.index</code> : Indicates the position of the linear ad within the adRoll.</p>
          </li>
          <li>
            <p><code>linearAd.playCount</code> : Indicates the number of times the linear ad has been played. Value 0 means that it has not been played.</p>
          </li>
          <li>
            <p><code>linearAd.skipOffset</code> : Indicates the time after which the linear ad can be skipped. Value 0 means that the linear ad is not skippable.</p>
          </li>
          <li>
            <p><code>linearAd.companionAd</code> : An object representing the unmodified VAST companionAd info.</p>
          </li>
        </ul>
        <h3 id="pathproperties">Path properties</h3>
        <p>Here are the properties included in the <code>path</code> object:</p>
        <ul>
          <li>
            <p><code>path.absoluteTime</code> : This is the time in the stream relative to the absolute total time. This will always match what is passed into the function and provided just for convenience.</p>
          </li>
          <li>
            <p><code>path.contentTime</code> : This is the time in the stream relative to the currently playing linear advertisement or content.</p>
          </li>
          <li>
            <p><code>path.adRoll</code> : This value is null if no ad should be playing at the passed absolute time or if an ad should be playing, a JSON Object with the linear advertisement absolute begin/end time info from the timeline.</p>
          </li>
          <li>
            <p><code>path.linearAd</code> : This value is null if no ad should be playing at the passed absolute time or if an ad should be playing, a JSON Object with the linear advertisement <code>AdBreak</code> info from the timeline.</p>
          </li>
        </ul>
        <p>Here is an example of a <code>path</code> object without an ad.</p>
        <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="54-59"></code>
        </p>
        <p>Here is an example of a <code>path</code> object with an ad.</p>
        <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="64-169"></code>
        </p>
      </div>

      <div id="seekhandling" class="section">
        <h2>Seek handling</h2>
        <p>By default, the plugin enforces a "must-watch" ad policy. All advertisements must be watched in their entirety and <code>adRolls</code> cannot be skipped over or into part way. The only exception is when a seek is performed over multiple <code>adRolls</code>,
          where the plugin enforces that only the last <code>adRoll</code> that was seeked over is watched.</p>
        <p>Here are some examples:</p>
        <ul>
          <li>
            <p>Seek out of an ad : Returns the user to where they seeked from.</p>
          </li>
          <li>
            <p>Seek into an ad break : Returns the user to the start of the <code>adRoll</code> containing the <code>adBreak</code>.
            </p>
          </li>
          <li>
            <p>Seek over an ad : Returns the user to the start of the <code>adRoll</code> seeked over. When the ad finishes playing, the user is returned to the point they initially requested.</p>
          </li>
          <li>
            <p>Seek over multiple ad rolls : Returns the user to the start of the last <code>adRoll</code> seeked over. When the ad finishes playing, the user is returned to the point they initially requested.</p>
          </li>
          <li>
            <p>Seek backwards : No default handling</p>
          </li>
        </ul>
      </div>
      <div id="glossary" class="section">
        <h2>Glossary</h2>
        <p>This plugin distinguishes the concepts of <strong>absolute</strong> and <strong>content</strong> time within a OnceUX stream. Traditional video players only have a concept of <strong>content</strong> time; times between start and end of the URI it is currently playing. Because a OnceUX stream is essentially a number of <strong>content</strong> streams stiched together we've introduced the concept of <strong>absolute</strong> time which takes into account the complete stitched stream including the video advertisements.</p>
        <p>When you see the prefix <strong>absolute</strong> on a property or method, the times expected/returned are relative to the entire stitched stream. When you see the prefix <strong>content</strong>, the times expected/returned are relative only to a particular piece of content that was stitched into the stream (the main content or single linear advertisement).</p>
        <ul>
          <li>
            <p><code>timeline</code> : A JSON representation of the information in the Once VMAP XML. The timeline describes the stream and is referenced during playback constantly to ensure the UI is adapting to the currently playing content.</p>
          </li>
          <li>
            <p><code>path</code> : A snapshot of the timeline at any given second with information that is relavant only to that point in time within the stream.</p>
          </li>
          <li>
            <p><code>absoluteDuration</code> : The total duration of the stream including the linear ads.</p>
          </li>
          <li>
            <p><code>contentDuration</code> : The total duration of the stream excluding the linear ads.</p>
          </li>
          <li>
            <p><code>absoluteTime</code> : The time within the stream relative to absolute time.</p>
          </li>
          <li>
            <p><code>contentTime</code> : The time within the stream relative to the stitched content segement.</p>
          </li>
          <li>
            <p><code>absoluteStartTime</code> : The start time for stitched content in absolute time.</p>
          </li>
          <li>
            <p><code>absoluteEndTime</code> : The end time for stitched content in absolute time.</p>
          </li>
          <li>
            <p><code>adRoll</code> : A collection of one or more linear ads and non-linear ads.</p>
          </li>
          <li>
            <p><code>linearAd </code> : An <code>adBreak</code> which replaces the main video content. For example, video ads.</p>
          </li>
          <li>
            <p><code>companionAd</code> : An <code>adBreak</code> accompanying the linear ad or nonlinear ad which will be displayed outside the player screen. For example, ad banners.</p>
          </li>
          <li>
            <p><code>nonLinerAd</code> : An <code>adBreak</code> which will not replace the main video content. For example, overlay ads. These are not yet supported.</p>
          </li>
        </ul>
      </div>
      <div class="section" id="BCLreferences">
        <h2>Related Topics</h2>
        <ul>
          <li> <a href="plugin-dev-quick-start.html">Quick Start to Plugin Development</a>
          </li>
          <li> <a href="../../player-management/getting-started/player-mgmt-quick-start.html#customizePlayer">Quick Start to Player Management - Plugin Section</a>
          </li>
          <li> <a href="plugin-guide.html">Player Plugin Overview</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.2/gist-embed.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.0/fastclick.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
  <script src="/en/scripts/log.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site-v1.js"></script>
  <script src="/en/scripts/bc-mapi.js"></script>
  <script>
    $(document).foundation();
  </script>
  <script type="text/javascript">
    /******** Any scripts specific to page samples should go here *********/
  </script>
  <div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a>
  </div>
  <script>
    var feedbackMail = document.getElementById("feedbackMail");
    feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
  </script>
</body>

</html>
