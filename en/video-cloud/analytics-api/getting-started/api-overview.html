<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <title>Analytics API Overview</title>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css" />
    <style>
    .fields-list {
        display: inline-block;
        padding: .5em;
        vertical-align: top;
    }
    textarea#apiRequest {
        width: 95%;
        height: 10em;
        max-width: 1000px;
        font-family: hack, monospace;
        font-size: .8em;
    }
    </style>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
  </head>

<body>
    <!-- header navbar -->
    <div id="navWrapper" class="fixed"></div>
    <!-- breadcrumbs -->
    <nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
    <!-- search -->
    <div id="searchModal" class="reveal-modal" data-reveal></div>
    <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
            <div class="section" id="top">
                <h1>Analytics API v1 Overview</h1>
                <p>The Analytics API allows you to obtain analytics data for your Video Cloud accounts directly. You can also view the built-in analytics reports in the Analytics Module of <a href="//videocloud.brightcove.com">Video Cloud Studio</a>. Accessing the data programmatically gives you additional flexibility for such purposes as:</p>
                <ul>
                    <li>Creating custom charts and displays</li>
                    <li>Working with multiple APIs together - for example, getting video data using the CMS API for videos with the most views over the previous week</li>
                    <li>Combining your video analytic data with other site analytics data</li>
                    <li>For some sample solutions, see
                        <ul>
                            <li><a href="//solutions.brightcove.com/bcls/analytics-api/most-popular-videos.html">Most Popular Videos</a>
                            </li>
                            <li><a href="//solutions.brightcove.com/bcls/analytics-api/analytics-by-playlist.html">Analytics for Playlists</a>
                            </li>
                            <li><a href="//solutions.brightcove.com/bcls/analytics-api/video-views-by-country-and-day/video-views-by-country-and-day.html">Analytics by Country and Day</a>
                            </li>
                        </ul>
                    </li>
                </ul>
                <p class="BCL-aside">Note: if you have been using the Limited Availability version of the Analytics API, we strongly encourage you to upgrade your apps to the current version. If you still need the documentation for the Limited Availability version, you can find it <a href="//docs.brightcove.com/en/video-cloud/analytics-api-v0/index.html">here</a>.</p>
            </div>
            <div class="section" id="baseURL">
                <h2>Base URL</h2>
                <p>The base URL for the Analytics API is:</p>
<pre><code>https://analytics.api.brightcove.com/v1</code></pre>
            </div>
            <div class="section" id="headers">
                <h2>Headers</h2>
                <h3>Authentication (required)</h3>
                <p>The Analytics API uses the Brightcove <a href="../../oauth-api/index.html">OAuth Service</a> to authenticate calls.</p>
                <p>You will first need to obtain client credentials (a <code>client_id</code> and <code>client_secret</code>). This is a one-time operation that can be performed using the <a href="../guides/managing-api-credentials.html">OAuth Credentials UI</a>. You can get client credentials directly from the Brightcove OAuth Service using <a href="../../oauth-api/guides/get-client-credentials.html">CURL</a> or <a href="../..//oauth-api/guides/get-client-credentials-postman.html">Postman</a>.</p>
                <p>You will also need an <code>access_token</code>, which is obtained using the <code>client_id</code> and <code>client_secret</code> and passed in an Authorization header with your API request:</p>
<pre><code>Authorization: Bearer {access_token}</code></pre>
                <p>The <code>access_token</code> expires after five minutes, so you must obtain one for each request, or check to make sure that your token is still valid. See <a href="../../oauth-api/guides/get-token.html">Getting Access Tokens</a> for a detailed explanation of how to get access tokens, including code samples.</p>
                <h3>Accept-Encoding: gzip (optional)</h3>
                <p>Passing this header will cause the response to be returned in compressed form. This may improve performance for large reports.</p>
                <p class="BCL-aside">Note: the permanent Analytics API tokens issued during the Limited Availability program are no longer supported. Access tokens must be acquired from the Brightcove OAuth Service.</p>
            </div>
            <div class="section" id="caching">
                <h2>Caching</h2>
                <p>For performance reasons, API responses are cached for varying periods of time. For any Analytics API query, you can get information about the cache from the response headers:</p>
                <p>
                    <img src="./assets/aapi-cach-headers.png" alt="cach control headers">
                </p>
                <p>
                    The <code>Cache-Control</code> tells you the maximum time the results will be cached for in seconds (in the example above, 24 seconds). The <code>Last-Modified</code> and <code>Expires</code> headers tell you when the current cache was created and when it will expire.
                </p>
                <p>
                    In most cases this is probably not an issue, but if the freshness of analytics data is of critical importance, you should know that the longer a query runs, the longer it will be cached, and reports that fetch realtime (unreconciled hourly) data only will not be cached as long as those that fetch reconciled data (only, or in addition to realtime data). Find a <a href="http://support.brightcove.com/en/video-cloud/docs/faq-analytics-module#26">full explanation of realtime and reconciled data</a> if you like; the short version is that the Analytics API relies on two data buckets:
                </p>
                <ul>
                    <li>realtime, or hourly unreconciled data, which is made available immediately and stored for 32 days</li>
                    <li>reconciled data, which is stored permanently; realtime data is reconciled to improve accuracy and stored in the reconciled data repository every 24 hours</li>
                </ul>
                <p>
                    You can limit the results to reconciled or realtime data using the <a href="#reconciled">reconciled</a> parameter.
                </p>
                <p>
                    To minimize caching:
                </p>
                <ul>
                    <li>Use the <code><a href="#reconciled">reconciled=false</a></code> parameter to limit results to realtime data</li>
                    <li>Use a small <a href="#dateRanges">date range</a>, and be sure that the entire range falls within the past 32 days</li>
                </ul>
            </div>
            <div class="section" id="concurrency">
                <h2>Concurrent Requests</h2>
                <p>A single account is limited to one request at a time. Multiple concurrent requests will execute in series.</p>
                <p>For example:
                <ol>
                    <li>Start an API request "A".</li>
                    <li>Start API request "B" for the same account.</li>
                    <li>Request "B" will not complete until "A" completes.</li>
                    <li>If request "A" takes too long, request "A" will receive an error saying "your request is pending try again".</li>
                    <li>If request "A" takes too long, it may cause request "B" to receive the same error. Note that request "B" will get an error if the time to complete A + B is greater than our timeout value. </li>
                </ol>
                <p>If you make multiple concurrent requests, we will handle them roughly one at a time.</p>
                <p>Requests that return with a “pending error” will eventually complete and be saved to our cache. This means that future requests for the same data will return almost instantly, but only if the request is made before the five minute cache expires.</p>
                <p>Your systems should handle the pending error by waiting 2-4 minutes and making the same request again.</p>
            </div>
            <div class="section" id="requestTypes">
                <h2>Request types</h2>
                <p>The Analytics API accepts three request types</p>
                <dl>
                    <dt>Data (also called a Report)</dt>
                    <dd>
                        A report on one or more <a href="#metrics">dimensions</a>. The endpoint for a report request is:
<pre><code>https://analytics.api.brightcove.com/v1/data?accounts={account_id(s)}&amp;dimensions={dimensions}</code></pre>
                    </dd>
                    <dt>Engagement report</dt>
                    <dd>Detailed engagement data that is available for periods within the past 32 days. See <a href="#engagement">the engagement section</a> for more details.</dd>
                    <dt>Video information endpoint</dt>
                    <dd>
                        A specific piece of analytics data served with minimal latency. See <a href="../guides/video-information-endpoint.html">Video Data Endpoint</a> for more information.
                    </dd>
                </dl>
                <p><a href="#filterValues">Where filters</a> and <a href="#dateRanges">date ranges</a> can be applied to reports. Report requests can have additional parameters detailed below.</p>
            </div>
            <div class="section" id="accounts">
                <h2>Accounts</h2>
                <p>The Video Cloud account(s) that you want a report for are specified using the <code>accounts</code> parameter. For example:</p>
<pre><code>https://analytics.api.brightcove.com/v1/data?accounts={account_id(s)}</code></pre>
            </div>
            <div class="section" id="metrics">
                <h2>Dimensions and fields</h2>
                <p>Select dimension(s) below to see the fields that can be returned for it. You can also click the <strong>Make a Request</strong> button to make a sample request and see the results.</p>
                <fieldset>
                    <legend>Input</legend>
                    <input id="account_id" type="hidden" value="1752604059001">
                    <h5>Select Dimension(s) to report on:</h5>
                    <div id="dimensionsCol1" class="fields-list"></div>
                    <div id="dimensionsCol2" class="fields-list"></div>

                    <h5>Fields to return: <button id="fieldsButton" class="bcls-button">Select All</button> <button id="deselectFieldsButton" class="bcls-button">Deselect All</button></h5>
                    <div id="fieldsCol1" class="fields-list"></div>
                    <div id="fieldsCol2" class="fields-list"></div>
                <p><button id="getData" class="bcls-button" style="color:#FFFFFF;font-weight:bold">Make a Request with these Options</button> (uses a sample Brightcove account)</p>
                </fieldset>
                <fieldset>
                    <legend>Output</legend>
                    <h5>Earliest <code>from</code> date for this dimension combination: <span style="color:#FF6600" id="fromDisplay"></span></h5>
                    <h5 id="logger"></h5>
                    <h5>Sample API request:</h5>
                    <textarea id="apiRequest"></textarea>
                    <h5>Response data</h5>
                    <pre id="responseData"></pre>
                </fieldset>

                <h3>Notes</h3>
                <ol>
                    <li>By default, <code>video_view</code> is the only field returned - other fields will be returned only if they are specified in the value of the <code>fields</code> parameter.</li>
                    <li>If you specify a field to return that is not supported for the dimension or dimension combination, an <code>UNSUPPORTED_FIELD_COMBINATION_ERROR</code> error will be returned.</li>
                    <li>The <code>bytes_delivered</code> field includes all data delivered by Video Cloud to clients, including video data, images, text tracks and other assets, as well as the player code itself. Some of this data is obtained from CDNs, and may not be available for up to 3 days.</li>
                </ol>
                <h3>Example</h3>
                <p>A typical use case for getting a report on multiple dimensions: you want a breakdown of video views between desktop and mobile devices, and also want to know how many of the mobile device views were on iOS versus Android devices, and how many of the desktop views were on Macs versus Windows machines. Currently there is no standard report in the Studio Analytics Module that provides this information, but you can obtain it via this Analytics API call:</p>
<pre><code>https://analytics.api.brightcove.com/v1/data?accounts=57838016001&amp;dimensions=video,device_type,device_os&amp;from=2014-01-01&amp;to=2014-04-01&amp;fields=video_view</code></pre>
                <p>(In this case we are requesting video views for the period from January 1 to April 1 in 2014.)</p>

            </div>
            <div class="section" id="params">
                <h2>Parameters</h2>
                <p>Below is a table summarizing the parameters available in the Analytics API. The use of the parameters is discussed in more detail in the sections that follow.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Required</th>
                            <th>Description</th>
                            <th>Values</th>
                            <th>Default</th>
                        </tr>
                    </thead>
                    <tbody id="paramTable"></tbody>
                </table>
            </div>
            <div class="section" id="filterValues">
                <h2>Where filters</h2>
                <p>The general syntax for filters is:</p>
<pre><code>where=dimension1==value1;dimension2==value2</code></pre>
                <p>For example:</p>
<pre><code>where=video==123456789;device_type==tablet</code></pre>
                <p>Commas are treated as logical ORs, and semicolons as logical ANDs. For example, <code>where=video==1234,5678;player=9876</code> is interpreted as "where video = 1234 <strong>OR</strong> 5678 <strong>AND</strong> player = 9876"</p>
                <h3>Spaces and special characters</h3>
                <p>String values should be URI encoded. You can also escape special characters using a "\":</p>
<pre><code>where=search_terms==boston\,%20ma</code></pre>
                <p>You can use the following dimensions as filters:</p>
                <h3>Filtering by video properties</h3>
                <p>Using the special <code>where=video.q=={property}:{value}</code> filter, you can limit your report to a specific set of videos based on a variety of properties, including:</p>
                <ul>
                    <li>tags</li>
                    <li>reference_id</li>
                    <li>custom_fields</li>
                    <li>{a_specific_custom_field}</li>
                    <li>published_at</li>
                </ul>
                <p>For a complete explanation of this query syntax, see <a href="http://docs.brightcove.com/en/video-cloud/cms-api/guides/search-videos.html">Using the CMS API: Search for Videos</a>.</p>
                <div class="BCL-aside">
                    <p>Note: the data fetched using this filter is cached for 24 hours, and so will not reflect changes made in the past day</p>
                </div>
                <h3>Summary of filters and allowable values</h3>
                <ul id="filtersList">
                </ul>
                <p>The following table shows allowable values for each dimension used as a filter:</p>
                <table>
                    <thead>
                        <tr>
                            <th>Dimension Filter</th>
                            <th>Allowable Values</th>
                        </tr>
                    </thead>
                    <tbody id="filterAllowableValues"></tbody>
                </table>
            </div>
            <div class="section" id="dateRanges">
                <h2>Date ranges</h2>
                <p>Date ranges, specified in <code>from</code>and <code>to</code>parameters for all types of reports, can be indicated in different formats:</p>
                <ul>
                    <li>Text values:
                        <ul>
                            <li><code>from=alltime</code></li>
                            <li> <code>to=now</code> (available and the default value for all requests)</li>
                        </ul>
                    </li>
                    <li>Epoch time values in milliseconds, such as <code>1377047323000</code>
                    </li>
                    <li>Dates expressed in ISO 8601 standard international date format: <code>YYYY-MM-DD</code>format, such as <code>2013-09-12</code>. For dates expressed in this format:
                        <ul>
                            <li>Any date range specified will be interpreted <em>in the current timezone</em>for the user</li>
                            <li>The time for the date give will be interpreted as midnight ( <code>00:00:00</code>) on the date specified <em>in the user's timezone</em>
                            </li>
                        </ul>
                    </li>
                    <li>Relative dates: you can express either of the <code>to</code> and <code>from</code> values relative to the other one in d (days) or h (hours). For example:
                    <ul>
                        <li>from=2015-01-01&amp;to=31d</li>
                        <li>from=-48h&amp;to=now</li>
                        <li>from=-2d&amp;to=now (will give the same results as the previous example)</li>
                        <li>from=-365d&to=2014-12-31</li>
                    </ul>
                    <p>Note that negative numbers (-2d) are interpreted as "before" (the other value) and positive numbers (48h) are treated as "from" (the other value)</p>
                    </li>
                </ul>
                <p>To generate a report on some dimension like "video" for a single day, set the to and from values to that date:</p>
<pre><code>...?dimensions=video&amp;from=2013-11-01&amp;to=2013-11-01</code></pre>
                <div class="BCL-aside">Notes:
                <ul>
                    <li>If you are trying to return all analytics data, use <code>from=alltime</code> rather than setting <code>from</code> equal to a date</li>
                    <li>You can get the available date range for any report by using the endpoint <code>/data/status</code> - see the <a href="../references/versions/v1/index.html#api-Report-Get_Available_Date_Range">API Reference</a> for details</li>
                </ul>
                </div>
            </div>
            <div class="section" id="limit">
                <h2>Limit and offset</h2>
                <p>The <code>limit</code> is the number of items to return (default: 10). To return all items, use <code>limit=all</code>. <code>offset</code> is the number of items to skip (default: 0). You can use <code>limit</code> and <code>offset</code> together to create an app that pages through the results.</p>
            </div>
            <div class="section" id="reconciled">
                <h2>Reconciled data</h2>
                <p>The <code>reconciled</code> parameter is a boolean. If it is set to <code>true</code>, the results will be limited to reconciled data. If <code>false</code>, results will be limited to realtime (hourly unreconciled) data.</p>
                <p class="BCL-aside">Note: realtime data is only available for the previous 32 days. If you set <code>reconciled=false</code> and the <code>from</code> date earlier than 32 days ago, the API will return an error.</p>
            </div>
            <div class="section" id="geoReports">
                <h2>Geographical reports</h2>
                <h3>Dimensions for geographical analytics</h3>
<pre><code>country - As the ISO-3611-1 country code. eg: 'US'
region - As the ISO-3611-2 region code. eg: 'US-WA'
city - City name. eg: Seattle</code></pre>
                <p>Note: For unknown country or region the API returns "ZZ" as the code (As per ISO-3611-alpha2).</p>
            </div>
            <div class="section" id="fieldsAndSorting">
                <h2>Fields and Sorting</h2>
                <p>Use the <code>fields</code> parameter to specify the fields you want to return. By default, <code>video_view</code> is returned and the field corresponding to the dimension you are reporting on (e.g. <code>destination_domain</code>) are returned. See <a href="../getting-started/api-overview.html#metrics">dimensions and fields</a> for more details.</p>
                <p>Use the <code>sort</code> parameter to specify which metric field is used to sort the returned items; for example: <code>sort=video_view</code>. You can reverse the sort order by negating the sort field: <code><span>sort=<span style="color:#CC0000;font-weight: bold" class="bcls-highlight">-</span>video_view</span></code>.</p>
                <div class="BCL-aside">
                <p>Note: the fields available to return or sort on depend on the <a href="#metrics">metrics</a> returned for the dimension(s) you are reporting on. These parameters are strictly validated, and your request will return an error if the <code>fields</code> or <code>sort</code> parameter points to a field not valid for the request.</p>
                <p>For video dimension reports, valid sort values include video metadata fields: <code>video.name</code> and <code>video.reference_id</code>.</p>
                </div>
            </div>
            <div class="section" id="engagement">
                <h2>Engagement reports</h2>
                <p>Detailed engagement reports showing views for each 100th part of videos (or the averages across all videos for an account or player) are available for periods within the past 32 days. (Requests for date ranges outside the past 32 days will return and error.)</p>
                <div class="BCL-aside">
                    <p>Note: there are several limitations on requests to the engagement endpoints:</p>
                    <ul>
                        <li>Reports are available only for a single account, player, or video</li>
                        <li><code>where</code> filters are not supported</li>
                        <li>The only parameters supported are <code>from</code> and <code>to</code></li>
                        <li>If you provide <code>from</code> and <code>to</code> values in date format (MM-DD-YYYY), the report will reflect full day values</li>
                        <li>If you want hourly engagement data, the <code>from</code> and <code>to</code> values must be given in epoch milliseconds values that fall within the hours you want to report on</li>
                    </ul>
                </div>
                    <h3>Account engagement</h3>
                    <p>To get average values for engagement on viewed videos, use the endpoint:</p>
<pre><code>https://analytics.api.brightcove.com/v1/engagement/accounts/<em>{account_id}</em></code></pre>
                    <h3>Player engagement</h3>
                    <p>To get average values for all videos viewed in a player, use the endpoint:</p>
<pre><code>https://analytics.api.brightcove.com/v1/engagement/accounts/<em>{account_id}</em>/players/<em>{player_id}</em></code></pre>
                    <h3>Video engagement</h3>
                    <p>To get engagement data for a specific video, use the endpoint:</p>
<pre><code>https://analytics.api.brightcove.com/v1/engagement/accounts/<em>{account_id}</em>/videos/<em>{video_id}</em></code></pre>
            </div>
        </div>
    </div>
    <!-- bcl scripts -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
    <script src="/en/scripts/docs-nav-data.min.js"></script>
    <script src="/en/scripts/bcls-doc-site-v1.js"></script>
    <script src="../assets/aapi-model-v1.js"></script>
    <script id="pageScript" type="text/javascript">
    var BCLS = ( function ($, window, document, aapi_model) {
        var filtersTemplate = "{{#filters}}<li>{{this}}</li>{{/filters}}",
            filterAllowableValues = document.getElementById("filterAllowableValues"),
            paramTable = document.getElementById("paramTable"),
            combination,
            proxyURL = 'https://solutions.brightcove.com/bcls/bcls-proxy/aapi-proxy.php',
            dimension,
            selectedDimensions      = [],
            fromDate,
            fieldsToReturn          = [],
            fieldsCheckboxes,
            dimensionCheckboxes,
            accountId,
            clientId,
            clientSecret,
            searchString,
            account_id              = document.getElementById('account_id'),
            returnFields            = document.getElementById('returnFields'),
            fieldsButton            = document.getElementById('fieldsButton'),
            deselectFieldsButton    = document.getElementById('deselectFieldsButton'),
            dimensionsCol1          = document.getElementById('dimensionsCol1'),
            dimensionsCol2          = document.getElementById('dimensionsCol2'),
            fieldsCol1              = document.getElementById('fieldsCol1'),
            fieldsCol2              = document.getElementById('fieldsCol2'),
            dateSelect              = document.getElementById('dateSelect'),
            count                   = document.getElementById('count'),
            allButtons              = document.getElementsByTagName('button'),
            getData                 = document.getElementById('getData'),
            apiRequest              = document.getElementById('apiRequest'),
            fieldsArrayDisplay,
            generatedContent        = document.getElementById('generatedContent'),
            responseData            = document.getElementById('responseData'),
            dimensionsParam,
            fromDisplay             = document.getElementById('fromDisplay'),
            logger                  = document.getElementById('logger'),
            i,
            iMax;

        /**
         * logging
         */
        function bclslog(context, message) {
            if (window["console"] && console["log"]) {
              console.log(context, message);
            }
        }
        /**
         * builds param summary table
         */
        function buildParamTable() {
            var thisParam,
                str = "",
                i,
                iMax = aapi_model.params.length;
                for (i = 0; i < iMax; i++) {
                    thisParam = aapi_model.params[i];
                    str += "<tr><td>" + thisParam.name + "</td><td>" + thisParam.required + "</td><td>" + thisParam.description + "</td><td>" + thisParam.values + "</td><td>" + thisParam.default + "</td></tr>";
                }
                paramTable.innerHTML = str;
        }
        /**
         * built filter values
         */
        function buildFilterValueTable() {
            var thisDimension,
                thisValues,
                i,
                iMax = aapi_model.dimensions.length,
                j,
                jMax,
                str = "";
            for (i = 0; i < iMax; i++) {
                thisDimension = aapi_model.dimensions[i];
                thisValues = thisDimension.filter_values;
                str += "<tr><td>" + thisDimension.name + "</td><td><ul>";
                jMax = thisValues.length;
                for (j = 0; j < jMax; j++) {
                    str += "<li>" + thisValues[j] + "</li>";
                }
                str += "</td></tr>";
            }
            filterAllowableValues.innerHTML = str;
        }
        /**
        * tests for all the ways a variable (string or number) might be undefined or not have a value
        * @param {String|Numbar} x the variable to test
        * @return {Boolean} true if variable is defined and has a value
        **/
        function isDefined(x) {
            if ( x === "" || x === null || x === undefined || x === NaN) {
               return false;
            }
            return true;
        }

        /**
         * get selected value for single select element
         * @param {htmlElement} e the select element
         * @return {Object} object containing the `value` and selected `index`
         */
        function getSelectedValue(e) {
            var val = e.options[e.selectedIndex].value,
                idx = e.selectedIndex;
            return {
                value: val,
                index: idx
            }
        }

        /**
         * determines whether specified item is in an array
         *
         * @param {array} array to check
         * @param {string} item to check for
         * @return {boolean} true if item is in the array, else false
         */
        function isItemInArray(arr, item) {
            var i,
                iMax = arr.length;
            for (i = 0; i < iMax; i++) {
                if (arr[i] === item) {
                    return true;
                }
            }
            return false;
        };

        /**
         * find index of an object in array of objects
         * based on some property value
         *
         * @param {array} targetArray array to search
         * @param {string} objProperty object property to search
         * @param {string} value of the property to search for
         * @return {integer} index of first instance if found, otherwise returns -1
        */
        function findObjectInArray(targetArray, objProperty, value) {
            var i, totalItems = targetArray.length, objFound = false;
            for (i = 0; i < totalItems; i++) {
                if (targetArray[i][objProperty] === value) {
                    objFound = true;
                    return i;
                }
            }
            if (objFound === false) {
                return -1;
            }
        }

        /**
         * dedupe a simple array of strings or numbers
         * @param {array} arr the array to be deduped
         * @return {array} the deduped array
         */
        function dedupe(arr) {
            var i,
                len = arr.length,
                out = [],
                obj = {};

            for (i = 0;i < len; i++) {
                obj[arr[i]] = 0;
            }
            for (i in obj) {
                out.push(i);
            }
            return out;
        }

        /**
         * getSelectedCheckboxes returns an array of the values
         * of checked checkboxes
         * @param {htmlElementCollection} checkboxCollection a collection of the checkbox elements, usually gotten by document.getElementsByName()
         * @param {Array} targetArray the array to store the values in
         */
        function getSelectedCheckboxes(checkboxCollection, targetArray) {
            var i,
                iMax = checkboxCollection.length;
            for (i = 0; i < iMax; i += 1) {
                if (checkboxCollection[i].checked) {
                    targetArray.push(checkboxCollection[i].value);
                }
            }
            return targetArray;
        }

        /**
         * disables all buttons so user can't submit new request until current one finishes
         */
        function disableButtons() {
            var i,
                iMax = allButtons.length;
            for (i = 0; i < iMax; i++) {
                allButtons[i].setAttribute('disabled', 'disabled');
            }
            return;
        }

        /**
         * re-enables all buttons
         */
        function enableButtons() {
            var i,
                iMax = allButtons.length;
            for (i = 0; i < iMax; i++) {
                allButtons[i].removeAttribute('disabled');
            }
            return;
        }

        /**
         * updateRequestDisplay - gets the selected checkboxes and update the fields list display
         */
        function updateRequestDisplay() {
            apiRequest.textContent = 'https://analytics.api.brightcove.com/v1/data?accounts=ACCOUNT_ID';
            if (selectedDimensions.length > 0) {
                apiRequest.textContent += '&dimensions=' + selectedDimensions.join(',');
            }
            if (fieldsToReturn.length > 0) {
                apiRequest.textContent += '&fields=' + fieldsToReturn.join(',');
            }
            if (isDefined(fromDate)) {

            }
        }

        /**
         * adds dimension options from the aapi_model
         */
        function addDimensionOptions() {
            var i,
                iMax,
                input,
                text,
                label,
                br,
                half;
            // clear existing dimension checkboxes
            dimensionsCol1.innerHTML = '';
            dimensionsCol2.innerHTML = '';
            // add the return field options
            iMax = aapi_model.dimensions.length;
            half = Math.ceil(iMax / 2);
            for (i = 0; i < half; i += 1) {
                input = document.createElement('input');
                label = document.createElement('label');
                input.setAttribute('name', 'dimensionsChk');
                input.setAttribute('id', 'dim' + aapi_model.dimensions[i].name);
                input.setAttribute('data-index', i);
                input.setAttribute('type', 'checkbox');
                input.setAttribute('value', aapi_model.dimensions[i].name);
                label.setAttribute('for', 'dim' + aapi_model.dimensions[i].name);
                text = document.createTextNode(' ' + aapi_model.dimensions[i].name);
                br = document.createElement('br');
                dimensionsCol1.appendChild(input);
                dimensionsCol1.appendChild(label);
                label.appendChild(text);
                dimensionsCol1.appendChild(br);
            }
            for (i = half; i < iMax; i += 1) {
                input = document.createElement('input');
                label = document.createElement('label');
                input.setAttribute('name', 'dimensionsChk');
                input.setAttribute('id', 'dim' + aapi_model.dimensions[i].name);
                input.setAttribute('data-index', 'i');
                input.setAttribute('type', 'checkbox');
                input.setAttribute('value', aapi_model.dimensions[i].name);
                label.setAttribute('for', 'dim' + aapi_model.dimensions[i].name);
                text = document.createTextNode(' ' + aapi_model.dimensions[i].name);
                br = document.createElement('br');
                dimensionsCol2.appendChild(input);
                dimensionsCol2.appendChild(label);
                label.appendChild(text);
                dimensionsCol2.appendChild(br);
            }
            // get a reference to the checkbox collection
            dimensionCheckboxes = document.getElementsByName('dimensionsChk');
        }

        /**
         * addFieldOptions generates checkboxes for each field
         * available for the selected dimensions
         */
        function addFieldOptions() {
            var fieldsArray = [],
                dimensionName,
                dimensionIndex,
                thisDimensionFields,
                i,
                iMax,
                j,
                jMax,
                input,
                label,
                text,
                br,
                half;
            // clear existing field checkboxes
            fieldsCol1.innerHTML = '';
            fieldsCol2.innerHTML = '';
            dimensionName = selectedDimensions.join('__');
            // dimensionIndex = findObjectInArray(aapi_model.dimensions, 'name', dimensionName);
            fieldsArray = aapi_model.combinations[dimensionName].fields;
            // add the return field options
            iMax = fieldsArray.length;
            half = Math.ceil(iMax / 2);
            for (i = 0; i < half; i += 1) {
                input = document.createElement('input');
                label = document.createElement('label');
                input.setAttribute('name', 'fieldsChk');
                input.setAttribute('id', 'field' + fieldsArray[i]);
                input.setAttribute('type', 'checkbox');
                input.setAttribute('value', fieldsArray[i]);
                label.setAttribute('for', 'field' + fieldsArray[i]);
                text = document.createTextNode(' ' + fieldsArray[i]);
                br = document.createElement('br');
                fieldsCol1.appendChild(input);
                fieldsCol1.appendChild(label);
                label.appendChild(text);
                fieldsCol1.appendChild(br);
            }
            for (i = half; i < iMax; i += 1) {
                input = document.createElement('input');
                label = document.createElement('label');
                input.setAttribute('name', 'fieldsChk');
                input.setAttribute('id', 'field' + fieldsArray[i]);
                input.setAttribute('type', 'checkbox');
                input.setAttribute('value', fieldsArray[i]);
                label.setAttribute('for', 'field' + fieldsArray[i]);
                text = document.createTextNode(' ' + fieldsArray[i]);
                br = document.createElement('br');
                fieldsCol2.appendChild(input);
                fieldsCol2.appendChild(label);
                label.appendChild(text);
                fieldsCol2.appendChild(br);
            }
            // get a reference to the checkbox collection
            fieldsCheckboxes = document.getElementsByName('fieldsChk');
            // set up event listeners
            iMax = fieldsCheckboxes.length;
            for (i = 0; i < iMax; i += 1) {
                fieldsCheckboxes[i].addEventListener('click', function() {
                    fieldsToReturn = getSelectedCheckboxes(fieldsCheckboxes, fieldsToReturn);
                    updateRequestDisplay();
                });
            }
        }

        /**
         * sets up the data for the API request
         * @param {String="getCount","getVideos","getData"} id the id for the call type
         */
        function setRequestData(id) {
            var requestData = {},
            baseURL = 'https://analytics.api.brightcove.com/v1/data';
            // disable buttons to prevent a new request before current one finishes
            disableButtons();
            endPoint = '?accounts=' + accountId + '&dimensions=' + selectedDimensions.join(',') + '&fields=' + fieldsToReturn.join(',');
            requestData.url = baseURL + endPoint;
            requestData.requestType = 'GET';
            apiRequest.textContent = requestData.url;
            getMediaData(requestData, id);
    }

        /**
         * send API request to the proxy
         * @param  {Object} requestData options for the request
         * @param  {String} requestID the type of request = id of the button
         */
        function getMediaData(options, requestID) {
            var httpRequest = new XMLHttpRequest(),
                responseRaw,
                parsedData,
                requestParams,
                dataString,
                i,
                iMax,
                // response handler
                getResponse = function() {
                    try {
                      if (httpRequest.readyState === 4) {
                        if (httpRequest.status === 200) {
                          // check for completion
                            responseRaw = httpRequest.responseText;
                            responseData.textContent = responseRaw;
                            parsedData = JSON.parse(responseRaw);
                            responseData.textContent = JSON.stringify(parsedData, null, '  ');
                            // re-enable buttons
                            enableButtons();
                        } else {
                          alert('There was a problem with the request. Request returned ' + httpRequest.status);
                        }
                      }
                    } catch (e) {
                      alert('Caught Exception: ' + e);
                    }
                };
            // set up request data
            requestParams = 'url=' + encodeURIComponent(options.url) + '&requestType=' + options.requestType;
            if (options.requestBody) {
                dataString = JSON.stringify(options.requestBody);
                requestParams += "&requestBody=" + encodeURIComponent(dataString);
            }

            // set response handler
            httpRequest.onreadystatechange = getResponse;
            // open the request
            httpRequest.open('POST', proxyURL);
            // set headers
            httpRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            // open and send request
            httpRequest.send(requestParams);
        }


        function init() {
            buildParamTable();
            buildFilterValueTable();
            // set up dimensions
            addDimensionOptions();
            // set up fields
            // selectedDimensions = ['video'];
            // addFieldOptions();
            // event listeners
            getData.addEventListener('click', function() {
                var i,
                    iMax,
                    selectedDateObj,
                    dimensionObj,
                    displayFields = '';
                // make sure arrays are emptied out
                selectedDimensions = [];
                fieldsToReturn = [];
                // get account values
                accountId = account_id.value;
                // get dimension in case it wasn't changed
                selectedDimensions = getSelectedCheckboxes(dimensionCheckboxes, selectedDimensions);
                // get the array of fields from the fieldsCheckboxes
                fieldsToReturn = getSelectedCheckboxes(fieldsCheckboxes, fieldsToReturn);
                // make the request
                setRequestData('getAnalytics');
            });

            // dimensions
            iMax = dimensionCheckboxes.length;
            for (i = 0; i < iMax; i += 1) {
                dimensionCheckboxes[i].addEventListener('click', function() {
                    var dateArray = [],
                    j,
                    jMax,
                    thisDimension,
                    idx;
                    // empty selected dimensions arrays
                    selectedDimensions = [];
                    selectedDimensions = getSelectedCheckboxes(dimensionCheckboxes, selectedDimensions);
                    if (aapi_model.combinations.hasOwnProperty(selectedDimensions.join('__'))) {
                        addFieldOptions();
                        // get earliest date === latest date for selected dimensions
                        jMax = selectedDimensions.length;
                        for (j = 0; j < jMax; j += 1) {
                            dateArray = dateArray.concat(aapi_model.combinations[selectedDimensions[j]].from)
                        }
                        dateArray.sort();
                        fromDate = dateArray[dateArray.length - 1];
                        // display earliest data
                        fromDisplay.textContent = fromDate;
                    } else {
                        fieldsCol1.innerHTML = '<strong>The dimension combination is not valid</strong>';
                        fieldsCol2.innerHTML = '';
                    }

                });
            }

            fieldsButton.addEventListener('click', function() {
                var i,
                    iMax = fieldsCheckboxes.length;
                for (i = 0; i < iMax; i += 1) {
                    fieldsCheckboxes[i].setAttribute('checked', 'checked');
                }
                fieldsToReturn = getSelectedCheckboxes(fieldsCheckboxes, fieldsToReturn);
                // update fields display
                updateRequestDisplay();
            });

            deselectFieldsButton.addEventListener('click', function() {
                var i,
                    iMax = fieldsCheckboxes.length;
                for (i = 0; i < iMax; i += 1) {
                    fieldsCheckboxes[i].removeAttribute('checked');
                }
                fieldsToReturn = [];
                // update fields display
                updateRequestDisplay();
            });
        };
        init();
        return {}
    })($, window, document, aapi_model);
    </script>



    <script>
        $(document).foundation();
    </script>
    <iframe id="CSAT" src="http://survey.clicktools.com/app/survey/go.jsp?iv=3poon3e7e9spn&q1=[articleURL]" style="margin-left:25%; padding-bottom:20px;width:550px;height:475px;border:none"></iframe>
<script>

    var cSat = document.getElementById('CSAT'),
        cSatSrc = cSat.getAttribute('src'),
        pageurl = window.location.href;
    cSat.setAttribute('src', cSatSrc.replace('[articleURL]', pageurl));

</script>
<br><br>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>

</html>
