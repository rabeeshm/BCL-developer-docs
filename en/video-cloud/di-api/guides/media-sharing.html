<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <!-- change title to match the h1 heading -->
    <title>Dynamic Ingest with Media Sharing</title>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/atelier-forest.light.min.css" />
    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/font-hack/2.015/css/hack-extended.min.css">

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>
</head>

<body>
    <!-- header navbar -->
    <div id="navWrapper" class="fixed"></div>
    <!-- breadcrumbs -->
    <nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
    <!-- search -->
    <div id="searchModal" class="reveal-modal" data-reveal></div>
    <!-- content -->
    <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
            <div id="top" class="section">
                <h1>Dynamic Ingest with Media Sharing</h1>
                <p>To share videos created with Dynamic Ingest, the Media API is used. The sharing account must have “share by reference” enabled - contact Brightcove Support to verify this. This means the share API request can be made before transcoding has completed.</p>
                <p>The Dynamic Ingest portion of this guide is no different from the process discussed in other documents and samples, and ingesting the video using the Upload module in Studio can be used as well. However, in the interest of completeness, <a href="../../concepts/curl/curl.html">curl</a> examples are given for all three steps here:</p>
                <ol>
                    <li><a href="#Create_video">Create video</a></li>
                    <li><a href="#Create_the_ingest_request">Create the ingest request</a></li>
                    <li><a href="#Share_video_with_Media_API">Share video with Media API</a></li>
                </ol>
                <p class="BCL-aside">Note: eventually management of media sharing will be added to the <a href="../../cms-api/getting-started/overview-cms.html">CMS API</a>. The solution offered here is a temporary workaround until that work is completed. Once media sharing management is added to the CMS API, you should update any apps using the Media API for this purpose to use the CMS API instead.</p>
            </div>
            <div class="section" id="Create_video">
                <h2>Create video</h2>
                <p>The video object in the Video Cloud system is created using the <a href="//docs.brightcove.com/en/video-cloud/cms-api/references/cms-api/versions/v1/index.html#api-videoGroup-Create_Video">CMS API</a>. Here is  a curl example:</p>
<pre><code>curl --request POST \
  --url https://ingest.api.brightcove.com/v1/accounts/ACCOUNT_ID/videos \
  --header 'authorization: Bearer OAUTH_TOKEN' \
  --header 'content-type: application/json' \
  --data '{"name": "Video to be shared"}'</code></pre>
                <p>The JSON returned will include the new video id:</p>
<pre><code>{
  "id": "VIDEO_ID",
  "account_id": "ACCOUNT_ID",
  ...
}</code></pre>
            </div>
            <div class="section" id="Create_the_ingest_request">
                <h2>Create the ingest request</h2>
                <p>The video can then be ingested using the <a href="//docs.brightcove.com/en/video-cloud/di-api/reference/versions/v1/index.html#api-Ingest-Ingest_Media_Asset">Dynamic Ingest API</a> with the video id returned from the CMS API request. Here is a curl example of the request:</p>
<pre><code>curl --request POST \
  --url https://ingest.api.brightcove.com/v1/accounts/ACCOUNT_ID/videos/VIDEO_ID/ingest-requests \
  --header 'authorization: Bearer OAUTH_TOKEN' \
  --header 'content-type: application/json' \
  --data '{"master": {"url": "http://example.com/video.mp4"}}'</code></pre>
            </div>
            <div class="section" id="Share_video_with_Media_API">
                <h2>Share video with Media API</h2>
                <p>Once the video has been ingested, you can share it to another account using the <a href="//docs.brightcove.com/en/video-cloud/media/samples/share_video.html">Media API</a>. Here is a curl example of the request:</p>
<pre><code>curl --request POST \
  --url https://api.brightcove.com/services/post \
  --header 'content-type: application/x-www-form-urlencoded' \
  --data 'json={"method":"share_video",
  "params":{"video_id": "VIDEO_ID_TO_BE_SHARED", "sharee_account_ids": [ACCOUNT_ID_TO_SHARE_TO], "auto_accept": true, "token": "MEDIA_API_WRITE_TOKEN" }}'</code></pre>
                <p>The response includes the id of the new video in the sharee account:</p>
<pre><code>{"result": [123456789001], "error": null, "id": null}</code></pre>
            </div>
        </div>
    </div>
    <!-- bcl scripts -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.2/gist-embed.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.3/handlebars.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
    <script src="/en/scripts/log.js"></script>
    <script src="/en/scripts/docs-nav-data.min.js"></script>
    <script src="/en/scripts/bcls-doc-site-v1.js"></script>
    <script src="/en/scripts/bc-mapi.js"></script>
    <script>
        $(document).foundation();
    </script>
    <script type="text/javascript">
        /******** Any scripts specific to page samples should go here *********/
    </script>


<iframe id="CSAT" src="http://survey.clicktools.com/app/survey/go.jsp?iv=3poon3e7e9spn&q1=[articleURL]" style="margin-left:25%; padding-bottom:20px;width:550px;height:475px;border:none"></iframe>
<script>
    
    var cSat = document.getElementById('CSAT'),
        cSatSrc = cSat.getAttribute('src'),
        pageurl = window.location.href;
    cSat.setAttribute('src', cSatSrc.replace('[articleURL]', pageurl));
    
</script>
<br><br>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>

</html>
